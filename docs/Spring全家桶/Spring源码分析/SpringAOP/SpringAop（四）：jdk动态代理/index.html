<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">SpringAop（四）：jdk动态代理 | Tommy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aiden-coding.github.io/code-note-blog/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://aiden-coding.github.io/code-note-blog/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SpringAop（四）：jdk动态代理 | Tommy"><meta data-rh="true" name="description" content="��һƪ���µ�������Ƿ����� spring ���ڴ����˴����������д�������ķ�ʽΪ jdk��̬������ cglib�������������ǽ����� spring �Ķ�̬������"><meta data-rh="true" property="og:description" content="��һƪ���µ�������Ƿ����� spring ���ڴ����˴����������д�������ķ�ʽΪ jdk��̬������ cglib�������������ǽ����� spring �Ķ�̬������"><link data-rh="true" rel="icon" href="/code-note-blog/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理"><link data-rh="true" rel="alternate" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理" hreflang="en"><link data-rh="true" rel="alternate" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/code-note-blog/blog/rss.xml" title="Tommy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/code-note-blog/blog/atom.xml" title="Tommy Atom Feed"><link rel="stylesheet" href="/code-note-blog/assets/css/styles.dd5372db.css">
<script src="/code-note-blog/assets/js/runtime~main.f999fb27.js" defer="defer"></script>
<script src="/code-note-blog/assets/js/main.a0bfbaed.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_XYiV" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/code-note-blog/"><b class="navbar__title text--truncate">Tommy</b></a><a class="navbar__item navbar__link" href="/code-note-blog/docs/Java/basic/抽象类和接口">java</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/JavaWeb/走进JavaWeb技术世界：JavaWeb的由来和基础知识">javaweb</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/cache/探索Redis设计与实现：连接底层与表面的数据结构robj">cache</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/backend/后端技术杂谈：白话虚拟化技术">backend</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/cs/algorithms/剑指offer">cs</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/database/重新学习MySQL数据库：『浅入浅出』MySQL和InnoDB">database</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/distributed/basic/分布式系统理论基础 ：CAP">distributed</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/interview/BATJ-Experience/面阿里,终获offer">interview</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/mq/kafka/消息队列kafka详解：如何实现死信队列">mq</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/code-note-blog/docs/Spring全家桶/Spring/第一个Spring应用">spring</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/mianshi/collection">面试</a><a href="https://aiden-coding.github.io/code-note-blog/SpringCloud%E7%AC%AC3%E5%AD%A32024.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_XbAW colorModeToggle_r5NY"><button class="clean-btn toggleButton_Jx0n toggleButtonDisabled_zYO7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_FjAw"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_qmEt"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_wJfS"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_LABv"><div class="docsWrapper_pdvB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Jioa" type="button"></button><div class="docRoot_qx_v"><aside class="theme-doc-sidebar-container docSidebarContainer_NHKT"><div class="sidebarViewport_uyYB"><div class="sidebar_SZG4"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VP_k"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/Spring/第一个Spring应用">Spring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：初探SpringIOC核心流程">Spring源码分析</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：初探SpringIOC核心流程">Spring源码剖析：初探SpringIOC核心流程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：懒加载的单例Bean获取过程分析">Spring源码剖析：懒加载的单例Bean获取过程分析</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：AOP实现原理详解">Spring源码剖析：AOP实现原理详解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：JDK和cglib动态代理原理详解">Spring源码剖析：JDK和cglib动态代理原理详解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：Spring事务概述">Spring源码剖析：Spring事务概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：Spring事务源码剖析">Spring源码剖析：Spring事务源码剖析</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：SpringAOP概述">Spring源码剖析：SpringAOP概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：SpringIOC容器的加载过程">Spring源码剖析：SpringIOC容器的加载过程</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring启动流程/Spring启动流程（八）：完成BeanFactory的初始化">Spring启动流程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring事务/Spring事务（二）：事务的执行流程">Spring事务</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring重要机制探秘/ConfigurationClassPostProcessor（二）：处理@Bean注解">Spring重要机制探秘</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring组件分析/Spring组件之ApplicationContext">Spring组件分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/AnnotationAwareAspectJAutoProxyCreator分析（上）">SpringAOP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/AnnotationAwareAspectJAutoProxyCreator分析（上）">AnnotationAwareAspectJAutoProxyCreator分析（上）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/AnnotationAwareAspectJAutoProxyCreator分析（下）">AnnotationAwareAspectJAutoProxyCreator分析（下）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/AOP示例demo及@EnableAspectJAutoProxy">AOP示例demo及@EnableAspectJAutoProxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（六）：aop总结">SpringAop（六）：aop总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理">SpringAop（四）：jdk动态代理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（五）：cglib代理">SpringAop（五）：cglib代理</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringBoot/给你一份SpringBoot知识清单">SpringBoot</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringBoot源码解析/SpringBoot启动流程（四）：启动IOC容器">SpringBoot源码解析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloud/SpringCloudConsul">SpringCloud</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloud源码分析/SpringCloudConfig源码分析">SpringCloud源码分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloudAlibaba/SpringCloudAlibaba概览">SpringCloudAlibaba</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloudAlibaba源码分析/SpringCloudAlibabaNacos源码分析：服务发现">SpringCloudAlibaba源码分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringMVC/SpringMVC常见注解">SpringMVC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringMVC源码分析/请求执行流程（二）之执行Handler方法">SpringMVC源码分析</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_SejT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_j3Yw"><div class="docItemContainer_XOSC"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_F6gm" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/code-note-blog/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YCxa"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Spring源码分析</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SpringAOP</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SpringAop（四）：jdk动态代理</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ToOY theme-doc-toc-mobile tocMobile_suYB"><button type="button" class="clean-btn tocCollapsibleButton_VzP_">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SpringAop（四）：jdk动态代理</h1></header><p>��һƪ���µ�������Ƿ����� spring ���ڴ����˴����������д�������ķ�ʽΪ <code>jdk��̬����</code>�� <code>cglib����</code>���������ǽ����� spring �Ķ�̬������</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="1-jdk-̬">1. jdk ��̬��������<a href="#1-jdk-̬" class="hash-link" aria-label="Direct link to 1. jdk ��̬��������" title="Direct link to 1. jdk ��̬��������">​</a></h3>
<p>������ spring �Ķ�̬����ǰ�����������˽��� jdk �Ķ�̬������jdk ��̬������Ҫ�ӿڣ�Ϊ��������׼�������ӿڣ�</p>
<blockquote>
<p>IJdkDynamicProxy01</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IJdkDynamicProxy01 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void hello01();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>IJdkDynamicProxy02</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IJdkDynamicProxy02 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void hello02();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>����׼������ʵ���ࣺ</p>
<blockquote>
<p>JdkDynamicProxyImpl01</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class JdkDynamicProxyImpl01 implements IJdkDynamicProxy01, IJdkDynamicProxy02{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void hello01() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;hello01&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void hello02() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;hello02&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>JdkDynamicProxyImpl02</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class JdkDynamicProxyImpl02 implements IJdkDynamicProxy01 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void hello01() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;hello01&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>������Ҫע����ǣ�<code>JdkDynamicProxyImpl01</code> ʵ���� <code>IJdkDynamicProxy01</code> �� <code>IJdkDynamicProxy02</code> �����ӿڣ�<code>JdkDynamicProxyImpl02</code> ֻʵ���� <code>IJdkDynamicProxy01</code> һ�� �ӿڡ�</p>
<p>����׼��һ�� <code>InvocationHandler</code>:</p>
<blockquote>
<p>MyInvocationHandler</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.lang.reflect.InvocationHandler;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.lang.reflect.Method;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyInvocationHandler implements InvocationHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /** Ŀ����� */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     private Object target;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MyInvocationHandler(Object target){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.target = target;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;ִ�з���Ϊ:&quot; + method.getName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ����������ִ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object rs = method.invoke(target,args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return rs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���������:</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">package org.springframework.learn.demo03;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.lang.reflect.Proxy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Demo03Main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;------------bean01------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JdkDynamicProxyImpl01 bean01 = new JdkDynamicProxyImpl01();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object obj1 = Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // JdkDynamicProxyImpl01ʵ���� IJdkDynamicProxy01, IJdkDynamicProxy02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // �����classΪ IJdkDynamicProxy01, IJdkDynamicProxy02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Class&lt;?&gt;[]{ IJdkDynamicProxy01.class, IJdkDynamicProxy02.class },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new MyInvocationHandler(bean01));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���Խ�������ǿ��ת��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((IJdkDynamicProxy01) obj1).hello01();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((IJdkDynamicProxy02) obj1).hello02();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;------------bean01------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object obj2 = Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 // JdkDynamicProxyImpl01ʵ���� IJdkDynamicProxy01, IJdkDynamicProxy02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 // �����classΪ IJdkDynamicProxy01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 new Class&lt;?&gt;[]{ IJdkDynamicProxy01.class },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 new MyInvocationHandler(bean01));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((IJdkDynamicProxy01) obj2).hello01();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���쳣��java.lang.ClassCastException: class com.sun.proxy.$Proxy1 cannot be cast to class xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //((IJdkDynamicProxy02) obj2).hello02();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;-----------bean02-------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JdkDynamicProxyImpl02 bean02 = new JdkDynamicProxyImpl02();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object obj3 = Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 // JdkDynamicProxyImpl01ʵ���� IJdkDynamicProxy01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 // �����classΪ IJdkDynamicProxy01, IJdkDynamicProxy02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 new Class&lt;?&gt;[]{ IJdkDynamicProxy01.class, IJdkDynamicProxy02.class },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 new MyInvocationHandler(bean02));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((IJdkDynamicProxy01) obj3).hello01();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IJdkDynamicProxy02 proxy02 = (IJdkDynamicProxy02) obj3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���쳣��java.lang.IllegalArgumentException: object is not an instance of declaring class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //proxy02.hello02();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���н����</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">ִ�з���Ϊ:hello01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ִ�з���Ϊ:hello02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------bean01------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ִ�з���Ϊ:hello01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------bean02-------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ִ�з���Ϊ:hello01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello01</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>�Խ���������£�</p>
<ol>
<li><code>Proxy#newProxyInstance(ClassLoader, Class&lt;?&gt;[], InvocationHandler)</code> �ĵڶ�����������Ľӿڣ��������Ǵ������������Ľӿ����ͣ�������������ִ����������������ִ��Ϊ�� <code>invoke()</code> ������</li>
<li><code>JdkDynamicProxyImpl01</code> ͬʱʵ���� <code>IJdkDynamicProxy01</code> �� <code>IJdkDynamicProxy02</code> �ӿڣ�������ӿ�����ʱ��ֻ������ <code>IJdkDynamicProxy01</code>������������ obj2 ǿתΪ <code>IJdkDynamicProxy02</code> ʱ���ͻᱨ <code>ClassCastException</code>��ǿתʧ�ܣ������ <code>Proxy#newProxyInstance(ClassLoader, Class&lt;?&gt;[], InvocationHandler)</code> �������Ǵ������������Ľӿ����ͣ�</li>
<li><code>JdkDynamicProxyImpl02</code> ֻʵ���� <code>IJdkDynamicProxy01</code> �ӿڣ�������ӿ�����ʱ�������� <code>IJdkDynamicProxy01</code> �� <code>IJdkDynamicProxy02</code>������������ <code>obj3</code> ǿתΪ <code>IJdkDynamicProxy02</code> ʱ����δ���쳣��������ִ�� <code>proxy02.hello02()</code> ʱ��ȴ���� <code>java.lang.IllegalArgumentException: object is not an instance of declaring class</code>��ͬ�������� <code>Proxy#newProxyInstance(ClassLoader, Class&lt;?&gt;[], InvocationHandler)</code> �������Ǵ������������Ľӿ����ͣ���Ŀ�����������޹ء�</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="2-ٴη-spring-jdk-̬ĵ">2. �ٴη��� spring jdk ��̬��������Ĵ���<a href="#2-ٴη-spring-jdk-̬ĵ" class="hash-link" aria-label="Direct link to 2. �ٴη��� spring jdk ��̬��������Ĵ���" title="Direct link to 2. �ٴη��� spring jdk ��̬��������Ĵ���">​</a></h3>
<p>��������ķ����������������� spring ����δ�����������ģ�</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object getProxy(@Nullable ClassLoader classLoader) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��ȡĿ�����ʵ�ֵĽӿ�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class&lt;?&gt;[] proxiedInterfaces = AopProxyUtils.completeProxiedInterfaces(this.advised, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // �Ƿ���equals()��hashCode()����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    findDefinedEqualsAndHashCodeMethods(proxiedInterfaces);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ���� jdk ���� ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Proxy.newProxyInstance(classLoader, proxiedInterfaces, this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li>����Ľӿ�Ϊ <code>proxiedInterfaces</code>�����ֵ������Ŀ����ʵ�ֵ����нӿڣ�ͬʱ spring Ҳ�����������Ľӿڣ��� <code>SpringProxy</code>��<code>Advised</code>����Щ����һƪ�����Ѿ���ϸ�������ˣ�</li>
<li>ָ�� <code>InvocationHandler</code> Ϊ <code>this</code>��Ҳ���� <code>JdkDynamicAopProxy</code> �Ķ���ʵ���� <code>JdkDynamicAopProxy</code> ʵ���� <code>InvocationHandler</code>.</li>
</ol>
<p>�ɵ�һ���ֵķ�����֪��jdk ��̬��������ķ����������� <code>java.lang.reflect.InvocationHandler#invoke</code> ��ִ�еģ�Ҳ���� <code>JdkDynamicAopProxy#invoke</code>�����������Ǿ������� <code>JdkDynamicAopProxy#invoke</code> ������������ spring �����ִ�д��������ġ�</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="3-jdk-ִ̬">3. jdk ��̬����������ִ��<a href="#3-jdk-ִ̬" class="hash-link" aria-label="Direct link to 3. jdk ��̬����������ִ��" title="Direct link to 3. jdk ��̬����������ִ��">​</a></h3>
<p>spring jdk ��̬����������ִ���� <code>JdkDynamicAopProxy#invoke</code>��</p>
<blockquote>
<p>JdkDynamicAopProxy#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object oldProxy = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    boolean setProxyContext = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TargetSource targetSource = this.advised.targetSource;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object target = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ��ִ�е� equals ����������Ҫ����ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!this.equalsDefined &amp;&amp; AopUtils.isEqualsMethod(method)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return equals(args[0]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ��ִ�е� hashCode ����������Ҫ����ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else if (!this.hashCodeDefined &amp;&amp; AopUtils.isHashCodeMethod(method)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return hashCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���ִ�е�class������DecoratingProxy��Ҳ����Ҫ����ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else if (method.getDeclaringClass() == DecoratingProxy.class) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return AopProxyUtils.ultimateTargetClass(this.advised);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else if (!this.advised.opaque &amp;&amp; method.getDeclaringClass().isInterface() &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                method.getDeclaringClass().isAssignableFrom(Advised.class)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return AopUtils.invokeJoinpointUsingReflection(this.advised, method, args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object retVal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �ж� advised��exposeProxy ֵ�Ƿ�Ϊ true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // advised��exposeProxy��Դ�� @EnableAspectJAutoProxy �� exposeProxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �� ������ָ��ʱ��@EnableAspectJAutoProxy(exposeProxy = true)�����´���ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (this.advised.exposeProxy) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ����ǰ�� proxy ����ŵ� threadLocal ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �������� (UserService (AopContext.currentProxy)).getUser() ��ʽ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            oldProxy = AopContext.setCurrentProxy(proxy);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            setProxyContext = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ��ȡĿ�����Ŀ������class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target = targetSource.getTarget();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Class&lt;?&gt; targetClass = (target != null ? target.getClass() : null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �� aop �� advisor ת��Ϊ���������������жϸ÷�������ʹ����Щ���淽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;Object&gt; chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                method, targetClass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (chain.isEmpty()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ����������������Ϊ�գ������÷���û�б����أ�ͨ������ֱ��ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Object[] argsToUse = AopProxyUtils.adaptArgumentsIfNecessary(method, args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retVal = AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ����һ���������ö���</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MethodInvocation invocation =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ����ִ�У��ص�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retVal = invocation.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Class&lt;?&gt; returnType = method.getReturnType();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (retVal != null &amp;&amp; retVal == target &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                returnType != Object.class &amp;&amp; returnType.isInstance(proxy) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                !RawTargetAccess.class.isAssignableFrom(method.getDeclaringClass())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retVal = proxy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else if (retVal == null &amp;&amp; returnType != Void.TYPE &amp;&amp; returnType.isPrimitive()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new AopInvocationException(...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return retVal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (target != null &amp;&amp; !targetSource.isStatic()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            targetSource.releaseTarget(target);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (setProxyContext) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AopContext.setCurrentProxy(oldProxy);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���Ϸ����������£�</p>
<ol>
<li>�ж�Ҫִ�еķ����Ƿ�Ϊ <code>equals</code>��<code>hashcode</code> �ȣ���Щ��������Ҫ������</li>
<li>��ȡ������Ҫִ�еķ������������淽�����õ�һ�����������ϣ�</li>
<li>�������淽�������뼰Ŀ�귽����</li>
</ol>
<p>���������ص��ע���淽����Ŀ�귽����ִ�У��ؼ��������£�</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">// �� aop �� advisor ת��Ϊ���������������жϸ÷�������ʹ����Щ���淽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;Object&gt; chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        method, targetClass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ����һ���������ö���</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MethodInvocation invocation =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ����ִ�У��ص�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">retVal = invocation.proceed();</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="ȡ-methodinterceptor">��ȡ <code>MethodInterceptor</code><a href="#ȡ-methodinterceptor" class="hash-link" aria-label="Direct link to ȡ-methodinterceptor" title="Direct link to ȡ-methodinterceptor">​</a></h4>
<p>�ڷ���������ִ��ǰ�������������� <code>getInterceptorsAndDynamicInterceptionAdvice(...)</code>�����������������ȡִ�е����淽���ģ�Ҳ���� <code>MethodInterceptor</code>��</p>
<blockquote>
<p>AdvisedSupport#getInterceptorsAndDynamicInterceptionAdvice</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">public List&lt;Object&gt; getInterceptorsAndDynamicInterceptionAdvice(Method method, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Nullable Class&lt;?&gt;targetClass) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MethodCacheKey cacheKey = new MethodCacheKey(method);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;Object&gt; cached = this.methodCache.get(cacheKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (cached == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ����������������ȡ��������ٷ���</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cached = this.advisorChainFactory.getInterceptorsAndDynamicInterceptionAdvice(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this, method, targetClass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.methodCache.put(cacheKey, cached);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return cached;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>������</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ��ȡ Interceptor���������£�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public List&lt;Object&gt; getInterceptorsAndDynamicInterceptionAdvice(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Advised config, Method method, @Nullable Class&lt;?&gt; targetClass) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AdvisorAdapterRegistry registry = GlobalAdvisorAdapterRegistry.getInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��ȡ advisors��aop��advisors���£�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advisor[] advisors = config.getAdvisors();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;Object&gt; interceptorList = new ArrayList&lt;&gt;(advisors.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class&lt;?&gt; actualClass = (targetClass != null ? targetClass : method.getDeclaringClass());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Boolean hasIntroductions = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Advisor advisor : advisors) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���advisor��PointcutAdvisor����ʹ��PointcutAdvisor���Pointcut����ƥ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (advisor instanceof PointcutAdvisor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PointcutAdvisor pointcutAdvisor = (PointcutAdvisor) advisor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �����ж������߼��ĵ������Ƿ���ǰ���й����ˣ�������й������ٽ���Ŀ�귽����ƥ�䣬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ���û�У����ٽ���һ��ƥ�䡣</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (config.isPreFiltered() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    || pointcutAdvisor.getPointcut().getClassFilter().matches(actualClass)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                MethodMatcher mm = pointcutAdvisor.getPointcut().getMethodMatcher();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                boolean match;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (mm instanceof IntroductionAwareMethodMatcher) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (hasIntroductions == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        hasIntroductions = hasMatchingIntroductions(advisors, actualClass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    match = ((IntroductionAwareMethodMatcher) mm)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            .matches(method, actualClass, hasIntroductions);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    match = mm.matches(method, actualClass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (match) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // ��Advisor����ת��ΪMethodInterceptor����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    MethodInterceptor[] interceptors = registry.getInterceptors(advisor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (mm.isRuntime()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        for (MethodInterceptor interceptor : interceptors) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            // �� interceptor��methodMatcher��װ��InterceptorAndDynamicMethodMatcher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            interceptorList.add(new InterceptorAndDynamicMethodMatcher(interceptor, mm));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        interceptorList.addAll(Arrays.asList(interceptors));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else if (advisor instanceof IntroductionAdvisor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �ж����ΪIntroductionAdvisor���͵�Advisor���򽫵�������װΪInterceptor����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IntroductionAdvisor ia = (IntroductionAdvisor) advisor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (config.isPreFiltered() || ia.getClassFilter().matches(actualClass)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Interceptor[] interceptors = registry.getInterceptors(advisor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                interceptorList.addAll(Arrays.asList(interceptors));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �������ṩ��ʹ���Զ����ת������Advisor����ת�����߼�����ΪgetInterceptors()������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ��ʹ����Ӧ��Adapter��Ŀ��Advisor����ƥ�䣬�����ƥ���ϣ�ͨ����getInterceptor()����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ���Զ����Adviceת��ΪMethodInterceptor����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interceptor[] interceptors = registry.getInterceptors(advisor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            interceptorList.addAll(Arrays.asList(interceptors));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return interceptorList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���Ǹ������Ϸ������ܽ��»�ȡ <code>MethodInterceptor</code> �Ĺ��̹������£�</p>
<ol>
<li>
<p>��ȡ��Ŀ�����е� <code>advisors</code></p>
</li>
<li>
<p>��������ÿ��</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">advisor</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>�������������̴�����</p>
<ol>
<li>��� <code>advisor</code> �� <code>PointcutAdvisor</code>����ʹ�����е� <code>Pointcut</code> ����ƥ�䣬ƥ��ɹ��󣬻�ȡ <code>MethodInterceptor</code> � ��أ�</li>
<li>��� <code>advisor</code> �� <code>IntroductionAdvisor</code>����ʹ�����е� <code>ClassFilter</code> ����ƥ�䣬ƥ��ɹ��󣬻�ȡ <code>MethodInterceptor</code> ���أ�</li>
<li>����������������㣬ֱ�ӻ�ȡ <code>MethodInterceptor</code> ���أ�</li>
</ol>
<p>��ô <code>MethodInterceptor</code> ����λ�ȡ���أ����Ǽ������¿���</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">// ��� AdvisorAdapter �ĵط�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private final List&lt;AdvisorAdapter&gt; adapters = new ArrayList&lt;&gt;(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ���� adapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public DefaultAdvisorAdapterRegistry() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // @Before</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registerAdvisorAdapter(new MethodBeforeAdviceAdapter());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // @AfterReturning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registerAdvisorAdapter(new AfterReturningAdviceAdapter());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // @AfterThrowing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registerAdvisorAdapter(new ThrowsAdviceAdapter());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ��ȡadvisor��Ӧ��MethodInterceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public MethodInterceptor[] getInterceptors(Advisor advisor) throws UnknownAdviceTypeException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;MethodInterceptor&gt; interceptors = new ArrayList&lt;&gt;(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��ȡ��ǰadvisor���MethodInterceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advice advice = advisor.getAdvice();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��� advice �� MethodInterceptor��ʵ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (advice instanceof MethodInterceptor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        interceptors.add((MethodInterceptor) advice);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ʹ�� AdvisorAdapter �� advice ת��Ϊ MethodInterceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ���advice����adapter������ adapter.getInterceptor ��ȡ MethodInterceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (AdvisorAdapter adapter : this.adapters) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (adapter.supportsAdvice(advice)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            interceptors.add(adapter.getInterceptor(advisor));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (interceptors.isEmpty()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new UnknownAdviceTypeException(advisor.getAdvice());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return interceptors.toArray(new MethodInterceptor[0]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>����������������ܽ����£�</p>
<ol>
<li>��� <code>advice</code> �� <code>MethodInterceptor</code>��ֱ�ӽ���ת���� <code>MethodInterceptor</code>��</li>
<li>������ϲ����㣬��ʹ�� <code>AdvisorAdapter</code> �� advice ת���� <code>MethodInterceptor</code>.</li>
</ol>
<p>���� <code>adapters</code>��spring Ϊ�ṩ������ <code>Adapter</code>��</p>
<ul>
<li>MethodBeforeAdviceAdapter������ <code>@Before</code></li>
<li>AfterReturningAdviceAdapter������ <code>@AfterReturning</code></li>
<li>ThrowsAdviceAdapter������ <code>@AfterThrowing</code></li>
</ul>
<p>������ <code>Adapter</code> ��ֻ��һ�����ܣ����� <code>advice</code> ��Ӧ�� <code>MethodInterceptor</code>������������ <code>MethodBeforeAdviceAdapter</code> �Ĵ���������ˣ�</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">class MethodBeforeAdviceAdapter implements AdvisorAdapter, Serializable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * �Ƿ��ܴ�����ǰadvice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean supportsAdvice(Advice advice) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (advice instanceof MethodBeforeAdvice);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ���ض�Ӧ��MethodInterceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MethodInterceptor getInterceptor(Advisor advisor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MethodBeforeAdvice advice = (MethodBeforeAdvice) advisor.getAdvice();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new MethodBeforeAdviceInterceptor(advice);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>�������� <code>Adapter</code> �Ĺ��ܼ������ƣ��Ͳ������ˣ������ܽ��¸�ע���Ӧ�� <code>advice</code>��<code>methodInterceptor</code>��</p>
<table><thead><tr><th>ע��</th><th>advice</th><th>methodInterceptor</th></tr></thead><tbody><tr><td>@Before</td><td>AspectJMethodBeforeAdvice</td><td>MethodBeforeAdviceInterceptor</td></tr><tr><td>@After</td><td>AspectJAfterAdvice</td><td>AspectJAfterAdvice</td></tr><tr><td>@Around</td><td>AspectJAroundAdvice</td><td>AspectJAroundAdvice</td></tr><tr><td>@AfterReturning</td><td>AspectJAfterReturningAdvice</td><td>AfterReturningAdviceInterceptor</td></tr><tr><td>@AfterThrowing</td><td>AspectJAfterThrowingAdvice</td><td>ThrowsAdviceInterceptor</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="reflectivemethodinvocationproceed">ReflectiveMethodInvocation#proceed<a href="#reflectivemethodinvocationproceed" class="hash-link" aria-label="Direct link to ReflectiveMethodInvocation#proceed" title="Direct link to ReflectiveMethodInvocation#proceed">​</a></h4>
<p>��ȡ�� <code>MethodInterceptor</code> �󣬾Ϳ�ʼ���з�����ִ���ˣ�����ֱ�ӽ��� <code>ReflectiveMethodInvocation#proceed</code> ������</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">public Object proceed() throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ִ�������е���ǿ��ִ��Ŀ�귽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ����ʹ����������ģʽ������������������е��ã�����������ʾ��ǰ�������Ѿ�ִ�е������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (this.currentInterceptorIndex == this.interceptorsAndDynamicMethodMatchers.size() - 1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return invokeJoinpoint();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��ȡ��һ��Ҫִ�е�������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object interceptorOrInterceptionAdvice =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           this.interceptorsAndDynamicMethodMatchers.get(++this.currentInterceptorIndex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (interceptorOrInterceptionAdvice instanceof InterceptorAndDynamicMethodMatcher) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InterceptorAndDynamicMethodMatcher dm =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                (InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Class&lt;?&gt; targetClass = (this.targetClass != null </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ? this.targetClass : this.method.getDeclaringClass());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (dm.methodMatcher.matches(this.method, targetClass, this.arguments)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ƥ�䣬�͵����������ķ�����Ҳ�������淽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �� MethodInterceptor#invoke����ٴ� ReflectiveMethodInvocation#proceed���ֵ����˵�ǰ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return dm.interceptor.invoke(this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ��ƥ�䣬��ݹ���õ�ǰ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ע�⣬�����������Ĳ����� this����ʾ��ǰ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �� MethodInterceptor#invoke����ٴ� ReflectiveMethodInvocation#proceed���ֵ����˵�ǰ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ����Ŀ�귽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protected Object invokeJoinpoint() throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ʹ�÷������Ŀ����󷽷���ע�����ﴫ���Ӧ����Ŀ����󣬶����Ǵ�������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AopUtils.invokeJoinpointUsingReflection(this.target, this.method, this.arguments);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���ϴ���ĵ���ʹ����������ģʽ��ִ���߼����£�</p>
<ol>
<li>�ж��Ƿ�ִ�������е����淽�������ǣ���ִ��Ŀ�귽��������ִ����һ����</li>
<li>��ȡ��һ�����������ж��ܷ�ִ�У����ܣ����������������������ִ�е� һ��������</li>
</ol>
<p>�����߼�����ͦ�򵥣�����������ôִ�е��أ��� spring �У�����֪ͨ���������ͣ�<code>@Before</code>��<code>@After</code>��<code>@AfterReturning</code>��<code>@AfterThrowing</code> �� <code>@Around</code>����������һһ������������֪ͨ����ε��õġ�</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="1-before">1. <code>@Before</code><a href="#1-before" class="hash-link" aria-label="Direct link to 1-before" title="Direct link to 1-before">​</a></h4>
<blockquote>
<p>MethodBeforeAdviceInterceptor#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(MethodInvocation mi) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ִ��ǰ��֪ͨ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.advice.before(mi.getMethod(), mi.getArguments(), mi.getThis());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ����ִ����һ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return mi.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���� <code>advice.before(xxx)</code> ������</p>
<blockquote>
<p>AspectJMethodBeforeAdvice#before</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void before(Method method, Object[] args, @Nullable Object target) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    invokeAdviceMethod(getJoinPointMatch(), null, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>��������ȥ��</p>
<blockquote>
<p>AbstractAspectJAdvice#invokeAdviceMethod(JoinPointMatch, Object, Throwable)</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">protected Object invokeAdviceMethod(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         @Nullable JoinPointMatch jpMatch, @Nullable Object returnValue, @Nullable Throwable ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     return invokeAdviceMethodWithGivenArgs(argBinding(getJoinPoint(), jpMatch, returnValue, ex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  *  ���÷���ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protected Object invokeAdviceMethodWithGivenArgs(Object[] args) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object[] actualArgs = args;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (this.aspectJAdviceMethod.getParameterCount() == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actualArgs = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ��Ϥ��jdk�������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReflectionUtils.makeAccessible(this.aspectJAdviceMethod);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return this.aspectJAdviceMethod.invoke(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.aspectInstanceFactory.getAspectInstance(), actualArgs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    catch (...) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>���Կ����������ǵ��� jdk ���������õġ�</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2-after">2. <code>@After</code><a href="#2-after" class="hash-link" aria-label="Direct link to 2-after" title="Direct link to 2-after">​</a></h4>
<blockquote>
<p>AspectJAfterAdvice#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(MethodInvocation mi) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ����ִ����һ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return mi.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �������淽�������� finally �飬��ʾһ����ִ�У�����Ҳ��ʹ�÷������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        invokeAdviceMethod(getJoinPointMatch(), null, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="3-afterreturning">3. <code>@AfterReturning</code><a href="#3-afterreturning" class="hash-link" aria-label="Direct link to 3-afterreturning" title="Direct link to 3-afterreturning">​</a></h4>
<blockquote>
<p>AfterReturningAdviceInterceptor#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(MethodInvocation mi) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ����ִ����һ��������</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object retVal = mi.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // �������淽�����������¿�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.advice.afterReturning(retVal, mi.getMethod(), mi.getArguments(), mi.getThis());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return retVal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>AspectJAfterReturningAdvice#afterReturning</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">public void afterReturning(@Nullable Object returnValue, Method method, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Object[] args, @Nullable Object target) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (shouldInvokeOnReturnValueOf(method, returnValue)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // �������淽������Ȼ�ǵ��÷���ִ��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        invokeAdviceMethod(getJoinPointMatch(), returnValue, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="4-afterthrowing">4. <code>@AfterThrowing</code><a href="#4-afterthrowing" class="hash-link" aria-label="Direct link to 4-afterthrowing" title="Direct link to 4-afterthrowing">​</a></h4>
<blockquote>
<p>AspectJAfterThrowingAdvice#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(MethodInvocation mi) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ���� ReflectiveMethodInvocation#proceed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return mi.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    catch (Throwable ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (shouldInvokeOnThrowing(ex)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // �������淽����ֻ�����׳��쳣ʱ�Żᱻ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            invokeAdviceMethod(getJoinPointMatch(), null, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw ex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="5-around">5. <code>@Around</code><a href="#5-around" class="hash-link" aria-label="Direct link to 5-around" title="Direct link to 5-around">​</a></h4>
<blockquote>
<p>AspectJAroundAdvice#invoke</p>
</blockquote>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object invoke(MethodInvocation mi) throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!(mi instanceof ProxyMethodInvocation)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new IllegalStateException(...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProxyMethodInvocation pmi = (ProxyMethodInvocation) mi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProceedingJoinPoint pjp = lazyGetProceedingJoinPoint(pmi);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JoinPointMatch jpm = getJoinPointMatch(pmi);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // �������淽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return invokeAdviceMethod(pjp, jpm, null, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>������ʵ�ֻ���֪ͨʱ��һ��������ʵ�֣�</p>
<div class="language-java codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-java codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Around(xxx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object around(ProceedingJoinPoint p){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ִ��Ŀ�귽��ǰ�Ĳ���</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ִ��Ŀ�귽������һ���ǹؼ�</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ʵ�����ﲢ��������ִ��Ŀ�귽�������յ��õ��� ReflectiveMethodInvocation#proceed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ��������������������ִ����һ��������������ִ��Ŀ�귽��</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object o = p.proceed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ִ��Ŀ�귽����Ĳ���</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>spring ����������֪ͨ��ִ�У���Ҫ��Ϊ��  �����֣�</p>
<ol>
<li>ʹ�÷��䷽ʽִ�����淽����Ҳ������ν�� ����ǿ����</li>
<li>���� <code>ReflectiveMethodInvocation#proceed</code> ����ִ����һ������������ִ��Ŀ�귽����</li>
</ol>
<p>�����������ֵĲ�������ִ�д���ִ�е�λ�ã���</p>
<ul>
<li><code>@Before</code> ֪ͨ��<code>1</code> ��ǰ��<code>2</code> �ں�</li>
<li><code>@AfterReturning</code> ֪ͨ��<code>2</code> ��ǰ��<code>1</code> �ں����ִ�� <code>2</code> ʱ�������쳣��<code>1</code> �Ͳ���ִ���ˣ�</li>
<li><code>@AfterThrowing</code> ֪ͨ��<code>2</code> ��ǰ��<code>1</code> �ں��� <code>1</code> �Ƿ��� <code>catch</code> ����ִ�У���ֻ�з������쳣��<code>1</code> �Ż�ִ�У�</li>
<li><code>@After</code> ֪ͨ��<code>2</code> ��ǰ��<code>1</code> �ں�<code>1</code> �Ƿ��� <code>finally</code> ����ִ�У����� <code>finally</code> �������ԣ���ʹ�������쳣��<code>1</code> ͬ����ִ�У�</li>
<li><code>@Around</code> ֪ͨ�������淽��������ָ���� <code>2</code> ��ִ��ʱ����</li>
</ul>
<p>ע������ <code>@AfterReturning</code>��<code>@AfterThrowing</code> �� <code>@After</code> ֪ͨ��ִ��ʱ����</p>
<p>����������������⼸��֪ͨ�����ִ�еġ�</p>
<p>ͨ�����Եķ�ʽ������ spring ִ��֪ͨ��˳�����£�</p>
<ol>
<li>����ִ�� <code>@AfterThrowing</code> ֪ͨ���ȵ��� <code>mi.proceed()</code> ִ����һ����������Ȼ���� <code>catch</code> ����ִ�����淽��������ֻ�г����쳣ʱ  �������淽���Ż�ִ�У�</li>
<li>��һ�������У����� <code>mi.proceed()</code> ʱ��ִ�� <code>@AfterReturning</code> ֪ͨ��ִ��ʱ�ȵ��� <code>mi.proceed()</code> ִ����һ����������Ȼ����ִ�����淽����</li>
<li>��һ�������У����� <code>mi.proceed()</code> ʱ��ִ�� <code>@After</code> ֪ͨ��ִ��ʱ�ȵ��� <code>mi.proceed()</code> ִ����һ����������Ȼ���� <code>finally</code> ����ִ�����淽����������ʹ�����쳣�����淽�����ǻ�ִ�У�</li>
<li>��һ�������У����� <code>mi.proceed()</code> ʱ��ִ�� <code>@Around</code> ֪ͨ��ִ��ʱֱ��ִ�����淽�������� <code>@Around</code> ֪ͨ�����淽�������� <code>ProceedingJoinPoint#proceed()</code>�����ջ��ǻ�ִ����һ����������</li>
<li>��һ�������У����� <code>mi.proceed()</code> ʱ��ִ�� <code>@Before</code> ֪ͨ��ִ��ʱ����ִ�����淽�����ٵ��� <code>mi.proceed()</code> ִ����һ����������</li>
<li>��������ִ�е���󣬷���û�п�ִ�е��������ˣ���ʱ�Ϳ�ʼִ��Ŀ�귽����</li>
</ol>
<p>��ͼʾ��֪ͨ��ִ�й������£�</p>
<p><img loading="lazy" src="https://java-tutorial.oss-cn-shanghai.aliyuncs.com/up-e88e0cec49c47648005e5d3160663425739.png" alt="img" class="img_kGBN"></p>
<p>���յ�ִ��˳��</p>
<p><img loading="lazy" src="https://java-tutorial.oss-cn-shanghai.aliyuncs.com/up-97026239d0b2dc02abbe87a9b76325c3cc0.png" alt="img" class="img_kGBN"></p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="4-ܽ">4. �ܽ�<a href="#4-ܽ" class="hash-link" aria-label="Direct link to 4. �ܽ�" title="Direct link to 4. �ܽ�">​</a></h3>
<p>������Ҫ������ jdk ��̬������ִ�й��̣������˸�������֪ͨ��ִ��˳�򡣱��ľ��ȵ������ˣ���һƪ���½����� cglib ��ִ�й��̡�</p>
<hr>
<p><em>����ԭ�����ӣ�<a href="https://my.oschina.net/funcy/blog/4696654" target="_blank" rel="noopener noreferrer">https://my.oschina.net/funcy/blog/4696654</a> ���������߸���ˮƽ�����������д���֮������ӭָ����ԭ�����ף���ҵת������ϵ���߻����Ȩ������ҵת����ע��������</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（四）：jdk动态代理.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_EYjg" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_eevz"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/SpringAOP/SpringAop（六）：aop总结"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SpringAop（六）：aop总结</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/code-note-blog/docs/Spring全家桶/Spring源码分 析/SpringAOP/SpringAop（五）：cglib代理"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SpringAop（五）：cglib代理</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_lc2k thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-jdk-̬" class="table-of-contents__link toc-highlight">1. jdk ��̬��������</a></li><li><a href="#2-ٴη-spring-jdk-̬ĵ" class="table-of-contents__link toc-highlight">2. �ٴη��� spring jdk ��̬��������Ĵ���</a></li><li><a href="#3-jdk-ִ̬" class="table-of-contents__link toc-highlight">3. jdk ��̬����������ִ��</a></li><li><a href="#4-ܽ" class="table-of-contents__link toc-highlight">4. �ܽ�</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/code-note-blog/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/code-note-blog/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>