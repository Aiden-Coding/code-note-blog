<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">生产就绪功能 | Tommy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aiden-coding.github.io/code-note-blog/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://aiden-coding.github.io/code-note-blog/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="生产就绪功能 | Tommy"><meta data-rh="true" name="description" content="Back to index"><meta data-rh="true" property="og:description" content="Back to index"><link data-rh="true" rel="icon" href="/code-note-blog/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator"><link data-rh="true" rel="alternate" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator" hreflang="en"><link data-rh="true" rel="alternate" href="https://aiden-coding.github.io/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/code-note-blog/blog/rss.xml" title="Tommy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/code-note-blog/blog/atom.xml" title="Tommy Atom Feed"><link rel="stylesheet" href="/code-note-blog/assets/css/styles.dd5372db.css">
<script src="/code-note-blog/assets/js/runtime~main.f999fb27.js" defer="defer"></script>
<script src="/code-note-blog/assets/js/main.a0bfbaed.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_XYiV" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/code-note-blog/"><b class="navbar__title text--truncate">Tommy</b></a><a class="navbar__item navbar__link" href="/code-note-blog/docs/Java/basic/抽象类和接口">java</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/JavaWeb/走进JavaWeb技术世界：JavaWeb的由来和基础知识">javaweb</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/cache/探索Redis设计与实现：连接底层与表面的数据结构robj">cache</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/backend/后端技术杂谈：白话虚拟化技术">backend</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/cs/algorithms/剑指offer">cs</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/database/重新学习MySQL数据库：『浅入浅出』MySQL和InnoDB">database</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/distributed/basic/分布式系统理论基础 ：CAP">distributed</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/interview/BATJ-Experience/面阿里,终获offer">interview</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/mq/kafka/消息队列kafka详解：如何实现死信队列">mq</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/code-note-blog/docs/Spring全家桶/Spring/第一个Spring应用">spring</a><a class="navbar__item navbar__link" href="/code-note-blog/docs/mianshi/collection">面试</a><a href="https://aiden-coding.github.io/code-note-blog/SpringCloud%E7%AC%AC3%E5%AD%A32024.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_XbAW colorModeToggle_r5NY"><button class="clean-btn toggleButton_Jx0n toggleButtonDisabled_zYO7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_FjAw"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_qmEt"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_wJfS"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_LABv"><div class="docsWrapper_pdvB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Jioa" type="button"></button><div class="docRoot_qx_v"><aside class="theme-doc-sidebar-container docSidebarContainer_NHKT"><div class="sidebarViewport_uyYB"><div class="sidebar_SZG4"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VP_k"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/Spring/第一个Spring应用">Spring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/Spring源码分析/Spring源码剖析：初探SpringIOC核心流程">Spring源码分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/code-note-blog/docs/Spring全家桶/SpringBoot/给你一份SpringBoot知识清单">SpringBoot</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/给你一份SpringBoot知识清单">给你一份SpringBoot知识清单</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/基于SpringBoot中的开源监控工具SpringBootAdmin">基于SpringBoot中的开源监控工具SpringBootAdmin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/Spring常见注解使用指南">Spring注解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot常见注解">SpringBoot常见注解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot打包与启动">SpringBoot打包与启动</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot的基本使用">快速构建SpringBoot应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot的配置文件管理">SpringBoot的配置文件管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot的前世今生">SpringBoot的前世今生</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot的Starter机制">SpringBoot的Starter机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot集成Swagger实现API文档自动生成">SpringBoot集成Swagger实现API文档自动生成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator">生产就绪功能</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot应用也可以部署到外部Tomcat">SpringBoot应用也可以部署到外部Tomcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot中的任务调度与@Async">SpringBoot中的任务调度与@Async</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot中的日志管理">SpringBoot中的日志管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot自带的热部署工具">SpringBoot入门 - 配置热部署devtools工具</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringBoot源码解析/SpringBoot启动流程（四）：启动IOC容器">SpringBoot源码解析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloud/SpringCloudConsul">SpringCloud</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloud源码分析/SpringCloudConfig源码分析">SpringCloud源码分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloudAlibaba/SpringCloudAlibaba概览">SpringCloudAlibaba</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringCloudAlibaba源码分析/SpringCloudAlibabaNacos源码分析：服务发现">SpringCloudAlibaba源  码分析</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringMVC/SpringMVC常见注解">SpringMVC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/code-note-blog/docs/Spring全家桶/SpringMVC源码分析/请求执行流程（二）之执行Handler方法">SpringMVC源码分析</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_SejT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_j3Yw"><div class="docItemContainer_XOSC"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_F6gm" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/code-note-blog/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YCxa"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SpringBoot</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">生产就绪功能</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ToOY theme-doc-toc-mobile tocMobile_suYB"><button type="button" class="clean-btn tocCollapsibleButton_VzP_">On this page</button></div><div class="theme-doc-markdown markdown"><h1>生产就绪功能</h1>
<p><a href="https://springdoc.cn/spring-boot/index.html" target="_blank" rel="noopener noreferrer">Back to index</a></p>
<ul>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.enabling" target="_blank" rel="noopener noreferrer">1. 启用生产就绪的功能</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints" target="_blank" rel="noopener noreferrer">2. 端点（Endpoint）</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring" target="_blank" rel="noopener noreferrer">3. 通过HTTP进行监控和管理</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.jmx" target="_blank" rel="noopener noreferrer">4. 通过JMX进行监控和管理</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.observability" target="_blank" rel="noopener noreferrer">5. 可观测性（Observability）</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.loggers" target="_blank" rel="noopener noreferrer">6. 日志记录器（Logger）</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics" target="_blank" rel="noopener noreferrer">7. 指标（Metrics）</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing" target="_blank" rel="noopener noreferrer">8. 追踪（Tracing）</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.auditing" target="_blank" rel="noopener noreferrer">9. 审计</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.http-exchanges" target="_blank" rel="noopener noreferrer">10. 记录 HTTP Exchange</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring" target="_blank" rel="noopener noreferrer">11. 进程监控</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.cloud-foundry" target="_blank" rel="noopener noreferrer">12. Cloud Foundry 的支持</a></li>
<li><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.whats-next" target="_blank" rel="noopener noreferrer">13. 接下来读什么</a></li>
</ul>
<table><thead><tr><th></th><th>本站(<a href="https://springdoc.cn/" target="_blank" rel="noopener noreferrer">springdoc.cn</a>)中的内容来源于 <a href="https://spring.io/" target="_blank" rel="noopener noreferrer">spring.io</a> ，原始版权归属于 <a href="https://spring.io/" target="_blank" rel="noopener noreferrer">spring.io</a>。由 <a href="https://springboot.io/" target="_blank" rel="noopener noreferrer">springboot.io - Spring Boot中文社区</a> 进行翻译，整理。可供个人学习、研究，未经许可，不得进行任何转载、商用或与之相关的行为。 商标声明：Spring 是 Pivotal Software, Inc. 在美国以及其他国家的商标。</th></tr></thead></table>
<p>Spring Boot包括一些额外的功能，以帮助你在将应用程序发布到生产时监控和管理你的应用程序。 你可以选择通过使用HTTP端点或使用JMX来管理和监控你的应用程序。 审计、健康和指标收集也可以自动应用于你的应用程序。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="1-启用生产就绪的功能"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.enabling" target="_blank" rel="noopener noreferrer"></a>1. 启用生产就绪的功能<a href="#1-启用生产就绪的功能" class="hash-link" aria-label="Direct link to 1-启用生产就绪的功能" title="Direct link to 1-启用生产就绪的功能">​</a></h2>
<p><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator" target="_blank" rel="noopener noreferrer"><code>spring-boot-actuator</code></a> 模块提供了所有Spring Boot的生产就绪功能。 启用这些功能的推荐方法是添加对 <code>spring-boot-starter-actuator</code> “Starter” 的依赖。</p>
<p>Actuator的定义</p>
<p>actuator（执行器） 是一个制造术语，指的是用于移动或控制某物的机械装置。actuator 可以从一个小的变化中产生大量的运动。</p>
<p>要在基于Maven的项目中添加actuator，请添加以下 “Starter” 依赖。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependencies&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spring-boot-starter-actuator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependencies&gt;</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对于Gradle，使用以下声明。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    implementation &#x27;org.springframework.boot:spring-boot-starter-actuator&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="2-端点endpoint"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints" target="_blank" rel="noopener noreferrer"></a>2. 端点（Endpoint）<a href="#2-端点endpoint" class="hash-link" aria-label="Direct link to 2-端点endpoint" title="Direct link to 2-端点endpoint">​</a></h2>
<p>Actuator 端点（endpoint）让你可以监控并与你的应用程序互动。 Spring Boot包括一些内置的端点，并允许你添加自己的端点。 例如，<code>health</code> 端点提供基本的应用程序健康信息。</p>
<p>你可以<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.enabling" target="_blank" rel="noopener noreferrer">启用或禁用</a>每个单独的端点，  并<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.exposing" target="_blank" rel="noopener noreferrer">通过HTTP或JMX公开它们（使它们可以远程访问）</a>。当一个端点被启用和暴露时，它被认为是可用的。内置的端点只有在它们可用时才会被自动配置。大多数应用程序选择通过HTTP暴露，其中端点的ID和 <code>/actuator</code> 的前缀被映射到一个URL。例如，默认情况下，<code>health</code> 端点被映射到 <code>/actuator/health</code>。</p>
<table><thead><tr><th></th><th>要了解更多关于actuator的端点以及它们的请求和响应格式，请看单独的API文档（ <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/htmlsingle" target="_blank" rel="noopener noreferrer">HTML</a> 或 <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/pdf/spring-boot-actuator-web-api.pdf" target="_blank" rel="noopener noreferrer">PDF</a>）。</th></tr></thead></table>
<p>以下是技术无关的终端。</p>
<table><thead><tr><th>ID</th><th>说明</th></tr></thead><tbody><tr><td><code>auditevents</code></td><td>公开当前应用程序的审计事件信息。 需要一个 <code>AuditEventRepository</code> bean。</td></tr><tr><td><code>beans</code></td><td>显示你的应用程序中所有Spring Bean的完整列表。</td></tr><tr><td><code>caches</code></td><td>显示可用的缓存。</td></tr><tr><td><code>conditions</code></td><td>显示对配置和自动配置类进行评估的条件，以及它们符合或不符合的原因。</td></tr><tr><td><code>configprops</code></td><td>显示所有 <code>@ConfigurationProperties</code> 的整理列表。</td></tr><tr><td><code>env</code></td><td>暴露Spring的 <code>ConfigurableEnvironment</code> 中的属性。</td></tr><tr><td><code>flyway</code></td><td>显示任何已经应用的Flyway数据库迁移。 需要一个或多个 <code>Flyway</code> bean。</td></tr><tr><td><code>health</code></td><td>显示应用程序 的健康信息。</td></tr><tr><td><code>httpexchanges</code></td><td>显示 HTTP exchange 信息（默认情况下，最后 100 个 HTTP request/response exchange）。 需要一个 <code>HttpExchangeRepository</code> bean。</td></tr><tr><td><code>info</code></td><td>显示任意的应用程序信息。</td></tr><tr><td><code>integrationgraph</code></td><td>显示Spring集成图。 需要依赖 <code>spring-integration-core</code>。</td></tr><tr><td><code>loggers</code></td><td>显示和修改应用程序中logger的配置。</td></tr><tr><td><code>liquibase</code></td><td>显示任何已经应用的Liquibase数据库迁移。 需要一个或多个 <code>Liquibase</code> Bean。</td></tr><tr><td><code>metrics</code></td><td>显示当前应用程序的 “metrics” 信息。</td></tr><tr><td><code>mappings</code></td><td>显示所有 <code>@RequestMapping</code> 路径的整理列表。</td></tr><tr><td><code>quartz</code></td><td>显示有关Quartz Scheduler Job的信息。</td></tr><tr><td><code>scheduledtasks</code></td><td>显示你的应用程序中的计划任务。</td></tr><tr><td><code>sessions</code></td><td>允许从Spring Session支持的会话存储中检索和删除用户会话。 需要一个使用Spring Session的基于Servlet的Web应用程序。</td></tr><tr><td><code>shutdown</code></td><td>让应用程序优雅地关闭。只在使用jar打包时有效。默认情况下是禁用的。</td></tr><tr><td><code>startup</code></td><td>显示由 <code>ApplicationStartup</code> 收集的<a href="https://springdoc.cn/spring-boot/features.html#features.spring-application.startup-tracking" target="_blank" rel="noopener noreferrer">启动步骤数据</a>。要求 <code>SpringApplication</code> 被配置为 <code>BufferingApplicationStartup</code>。</td></tr><tr><td><code>threaddump</code></td><td>Performs a thread dump.</td></tr></tbody></table>
<p>如果你的应用程序是一个Web应用程序（Spring MVC、Spring WebFlux或Jersey），你可以使用以下额外的端点。</p>
<table><thead><tr><th>ID</th><th>说明</th></tr></thead><tbody><tr><td><code>heapdump</code></td><td>返回一个堆dump文件。 在HotSpot JVM上，返回一个 <code>HPROF</code> 格式的文件。 在OpenJ9 JVM上，返回一个 <code>PHD</code> 格式的文件。</td></tr><tr><td><code>logfile</code></td><td>返回日志文件的内容（如果 <code>logging.file.name</code> 或 <code>logging.file.path</code> 属性已被设置）。 支持使用HTTP <code>Range</code> 头来检索日志文件的部分内容。</td></tr><tr><td><code>prometheus</code></td><td>以可被 Prometheus 服务器抓取的格式展示度量（metric）。 依赖于 <code>micrometer-registry-prometheus</code>。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="21-启用端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.enabling" target="_blank" rel="noopener noreferrer"></a>2.1. 启用端点<a href="#21-启用端点" class="hash-link" aria-label="Direct link to 21-启用端点" title="Direct link to 21-启用端点">​</a></h3>
<p>默认情况下，除 <code>shutdown</code> 外的所有端点都被启用。 要配置一个端点的启用，请使用其 <code>management.endpoint.&lt;id&gt;.enabled</code> 属性。 下面的例子启用了 <code>shutdown</code> 端点。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.shutdown.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果你希望端点启用是“选择启用”而不是“选择禁用”，请将 <code>management.endpoints.enabled-by-default</code> 属性设置为 <code>false</code>，并使用单个端点的 <code>enabled</code> 属性来选择重新启用。 下面的例子启用了 <code>info</code> 端点，并禁用了所有其他端点。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.enabled-by-default=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.info.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>被禁用的端点会从应用程序上下文中完全删除。如果你想只改变暴露端点的技术，请使用 <a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.exposing" target="_blank" rel="noopener noreferrer"><code>include</code> 和 <code>exclude</code> 属性</a>来代替。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="22-暴露端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.exposing" target="_blank" rel="noopener noreferrer"></a>2.2. 暴露端点<a href="#22-暴露端点" class="hash-link" aria-label="Direct link to 22-暴露端点" title="Direct link to 22-暴露端点">​</a></h3>
<p>默认情况下，只有health端点是通过HTTP和JMX暴露的。 由于端点可能包含敏感信息，你应该仔细考虑何时暴露它们。</p>
<p>要改变哪些端点被暴露，请使用以下特定技术的 <code>include</code> 和 <code>exclude</code> 属性。</p>
<table><thead><tr><th>属性</th><th>默认</th></tr></thead><tbody><tr><td><code>management.endpoints.jmx.exposure.exclude</code></td><td></td></tr><tr><td><code>management.endpoints.jmx.exposure.include</code></td><td><code>health</code></td></tr><tr><td><code>management.endpoints.web.exposure.exclude</code></td><td></td></tr><tr><td><code>management.endpoints.web.exposure.include</code></td><td><code>health</code></td></tr></tbody></table>
<p><code>include</code> 属性列出了被暴露的端点的ID。 <code>exclude</code> 属性列出了不应该被公开的端点的ID。 <code>exclude</code> 属性优先于 <code>include</code> 属性。 你可以用一个端点ID列表来配置 <code>include</code> 和 <code>exclude</code> 属性。</p>
<p>例如，要通过JMX只公开 <code>health</code> 和 <code>info</code> 端点，请使用以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.jmx.exposure.include=health,info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>*</code> 可以用来选择所有端点。 例如，要通过HTTP公开所有的东西，除了 <code>env</code> 和 <code>beans</code> 端点，使用以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.exposure.include=*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.exposure.exclude=env,beans</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th><code>*</code> 在YAML中具有特殊含义，所以如果你想包括（或排除）所有的端点，一定要加引号。</th></tr></thead></table>
<table><thead><tr><th></th><th>如果你的应用程序是公开暴露的，我们强烈建议你也<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.security" target="_blank" rel="noopener noreferrer">保护你的端点</a>。</th></tr></thead></table>
<table><thead><tr><th></th><th>如果你想在端点暴露时实施自己的策略，你可以注册一个 <code>EndpointFilter</code> bean。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="23-安全security"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.security" target="_blank" rel="noopener noreferrer"></a>2.3. 安全（Security）<a href="#23-安全security" class="hash-link" aria-label="Direct link to 23-安全security" title="Direct link to 23-安全security">​</a></h3>
<p>为了安全起见，默认情况下只有 <code>/health</code> 端点通过HTTP公开。 你可以使用 <code>management.endpoints.web.exposure.include</code> 属性来配置被暴露的端点。</p>
<table><thead><tr><th></th><th>在设置 <code>management.endpoints.web.exposure.include</code> 之前，请确保暴露的执行器不包含敏感信息，将其置于防火墙之后，或由Spring Security之类的东西来保 证安全。</th></tr></thead></table>
<p>如果Spring Security在classpath上，并且没有其他 <code>SecurityFilterChain</code> bean，那么除了 <code>/health</code> 之外的所有执行器（actuator）都由Spring Boot自动配置来保证安全。 如果你定义了一个自定义的 <code>SecurityFilterChain</code> bean，Spring Boot自动配置就会退缩，让你完全控制执行器的访问规则。</p>
<p>如果你想为HTTP端点配置自定义安全（例如，只允许具有某种角色的用户访问），Spring Boot提供了一些方便的 <code>RequestMatcher</code> 对象，你可以与Spring Security结合使用。</p>
<p>一个典型的Spring Security配置可能看起来像下面的例子。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MySecurityConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http.securityMatcher(EndpointRequest.toAnyEndpoint());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http.authorizeHttpRequests((requests) -&gt; requests.anyRequest().hasRole(&quot;ENDPOINT_ADMIN&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http.httpBasic(withDefaults());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return http.build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>前面的例子使用 <code>EndpointRequest.toAnyEndpoint()</code> 来匹配一个请求到任何端点，然后确保所有的端点都有 <code>ENDPOINT_ADMIN</code> 的角色。 <code>EndpointRequest</code> 上还有其他几个匹配器方法。 详情见API文档（ <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/htmlsingle" target="_blank" rel="noopener noreferrer">HTML</a> 或 <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/pdf/spring-boot-actuator-web-api.pdf" target="_blank" rel="noopener noreferrer">PDF</a>）。</p>
<p>如果你在防火墙后面部署应用程序，你可能希望你的所有执行器端点都能被访问，而不需要  认证。 你可以通过改变 <code>management.endpoints.web.exposure.include</code> 属性来做到这一点，如下所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.exposure.include=*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此外，如果存在Spring Security，你需要添加自定义安全配置，允许未经认证的访问端点，如下例所示。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MySecurityConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http.securityMatcher(EndpointRequest.toAnyEndpoint());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http.authorizeHttpRequests((requests) -&gt; requests.anyRequest().permitAll());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return http.build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>在前面的两个例子中，配置只适用于actuator端点。 由于Spring Boot的安全配置在有任何 <code>SecurityFilterChain</code> bean的情况下都会完全退出，所以你需要配置一个额外的 <code>SecurityFilterChain</code> bean，其规则适用于应用程序的其他部分。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="231-跨网站请求伪造保护csrf"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.security.csrf" target="_blank" rel="noopener noreferrer"></a>2.3.1. 跨网站请求伪造保护（CSRF）<a href="#231-跨网站请求伪造保护csrf" class="hash-link" aria-label="Direct link to 231-跨网站请求伪造保护csrf" title="Direct link to 231-跨网站请求伪造保护csrf">​</a></h4>
<p>由于Spring Boot依赖Spring Security的默认值，CSRF保护在默认情况下被打开。 这意味着在使用默认安全配置时，需要 <code>POST</code>（shutdown和loggers端点）、<code>PUT</code> 或 <code>DELETE</code> 的actuator端点会出现403（禁止）的错误。</p>
<table><thead><tr><th></th><th>我们建议只有在你创建的服务被非浏览器客户端使用时才完全禁用CSRF保护。</th></tr></thead></table>
<p>你可以在 <a href="https://docs.spring.io/spring-security/reference/6.1.0-M1/features/exploits/csrf.html" target="_blank" rel="noopener noreferrer">Spring安全参考指南</a> 中找到关于CSRF保护的其他信息。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="24-配置端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.caching" target="_blank" rel="noopener noreferrer"></a>2.4. 配置端点<a href="#24-配置端点" class="hash-link" aria-label="Direct link to 24-配置端点" title="Direct link to 24-配置端点">​</a></h3>
<p>端点会自动缓存不需要任何参数的读取操作的响应。 要配置端点缓存响应的时间，请使用其 <code>cache.time-to-live</code> 属性。 下面的例子将 <code>beans</code> 端点的缓存生存时间设置为10秒。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.beans.cache.time-to-live=10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th><code>management.endpoint.&lt;name&gt;</code> 前缀唯一地标识了正在配置的端点。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="25-用于-actuator-web-端点的超媒体hypermedia"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.hypermedia" target="_blank" rel="noopener noreferrer"></a>2.5. 用于 Actuator Web 端点的超媒体（Hypermedia）<a href="#25-用于-actuator-web-端点的超媒体hypermedia" class="hash-link" aria-label="Direct link to 25-用于-actuator-web-端点的超媒体hypermedia" title="Direct link to 25-用于-actuator-web-端点的超媒体hypermedia">​</a></h3>
<p>一个 “discovery page” 被添加到所有端点的链接中。 默认情况下，“discovery page” 在 <code>/actuator</code> 上是可用的。</p>
<p>要禁用 “discovery page”，请 在你的应用程序属性中添加以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.discovery.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当配置了一个自定义的管理上下文路径时，“discovery page” 会自动从 <code>/actuator</code> 移到管理上下文的根部。 例如，如果管理上下文路径是 <code>/management</code>，discovery page可以从 <code>/management</code> 获得。 当管理上下文路径被设置为 <code>/</code> 时，发现页被禁用，以防止与其他mapping发生冲突的可能性。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="26-cors的支持"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.cors" target="_blank" rel="noopener noreferrer"></a>2.6. CORS的支持<a href="#26-cors的支持" class="hash-link" aria-label="Direct link to 26-cors的支持" title="Direct link to 26-cors的支持">​</a></h3>
<p><a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener noreferrer">跨源资源共享</a>（CORS）是 <a href="https://www.w3.org/TR/cors/" target="_blank" rel="noopener noreferrer">W3C的一个规范</a>，可以让你以灵活的方式指定哪种跨域请求被授权。如果你使用Spring MVC或Spring WebFlux，你可以配置Actuator的Web端点来支持这种情况。</p>
<p>CORS支持在默认情况下是禁用的，只有在你设置了 <code>management.endpoints.web.cors.allowed-origins</code> 属性后才会启用。 下面的配置允许从 <code>example.com</code> 域名中调用 <code>GET</code> 和 <code>POST</code>。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.cors.allowed-origins=https://example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.cors.allowed-methods=GET,POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>参见 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/endpoint/web/CorsEndpointProperties.java" target="_blank" rel="noopener noreferrer"><code>CorsEndpointProperties</code></a> 以获得完整的选项列表。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="27-实现自定义端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom" target="_blank" rel="noopener noreferrer"></a>2.7. 实现自定义端点<a href="#27-实现自定义端点" class="hash-link" aria-label="Direct link to 27-实现自定义端点" title="Direct link to 27-实现自定义端点">​</a></h3>
<p>如果你添加了一个带有 <code>@Endpoint</code> 注解的 <code>@Bean</code>，任何带有 <code>@ReadOperation</code>、<code>@WriteOperation</code> 或 <code>@DeleteOperation</code> 注释的方法都会自动通过JMX公开，在Web应用程序中也会通过HTTP公开。 通过使用Jersey、Spring MVC或Spring WebFlux，端点可以通过HTTP暴露。 如果Jersey和Spring MVC都可用，则使用Spring MVC。</p>
<p>下面的例子暴露了一个读操作，它返回一个自定义对象。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@ReadOperation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public CustomData getData() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new CustomData(&quot;test&quot;, 5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你也可以通过使用 <code>@JmxEndpoint</code> 或 <code>@WebEndpoint</code> 来编写特定技术的端点。 这些端点被限制在它们各自的技术上。 例如，<code>@WebEndpoint</code> 只通过HTTP暴露，而不是通过JMX。</p>
<p>你可以通过使用 <code>@EndpointWebExtension</code> 和 <code>@EndpointJmxExtension</code> 来编写特定的技术扩展。 这些注解让你提供特定技术的操作，以增强现有的端点。</p>
<p>最后，如果你需要访问Web框架的特定功能，你可以实现servlet或Spring的 <code>@Controller</code> 和 <code>@RestController</code> 端点，代价是它们不能通过JMX或使用不同的Web框架时可用。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="271-接收输入"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.input" target="_blank" rel="noopener noreferrer"></a>2.7.1. 接收输入<a href="#271-接收输入" class="hash-link" aria-label="Direct link to 271-接收输入" title="Direct link to 271-接收输入">​</a></h4>
<p>端点上的操作通过其参数接收输入。 当通过web公开时，这些参数的值来自URL的查询参数和JSON请求体。 当通过JMX公开时，参数被映射到MBean操作的参数中。 默认情况下，参数是必需的。 它们可以通过使用 <code>@javax.annotation.Nullable</code> 或 <code>@org.springframework.lang.Nullable</code> 进行注解而成为可选项。</p>
<p>你可以将JSON请求体中的每个根属性映射到端点的一个参数。 考虑一下下面的JSON请求体。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;test&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;counter&quot;: 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以用它来调用一个写操作，该操作需要 <code>String name</code> 和 <code>int counter</code> 参数，如下面的例子所示。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@WriteOperation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void updateData(String name, int counter) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // injects &quot;test&quot; and 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>因为端点是技术不可知的，在方法签名中只能指定简单的类型。 特别是，不支持用 <code>CustomData</code> 类型声明一个定义了 <code>name</code> 和 <code>counter</code> 属性的单一参数。</th></tr></thead></table>
<table><thead><tr><th></th><th>为了让输入映射到操作方法的参数，实现端点的Java代码应该用 <code>-parameters</code> 编译，而实现端点的Kotlin代码应该用 <code>-java-parameters</code> 编译。 如果你使用Spring Boot的Gradle插件或使用Maven和 <code>spring-boot-starter-parent</code>，这将自动发生。</th></tr></thead></table>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="输入类型转换"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.input.conversion" target="_blank" rel="noopener noreferrer"></a>输入类型转换<a href="#输入类型转换" class="hash-link" aria-label="Direct link to 输入类型转换" title="Direct link to 输入类型转换">​</a></h5>
<p>如果有必要，传递给端点操作方法的参数会自动转换为所需类型。 在调用操作方法之前，通过JMX或HTTP收到的输入被转换为所需的类型，方法是使用 <code>ApplicationConversionService</code> 的实例以及任何 <code>Converter</code> 或 <code>GenericConverter</code> Bean，并以 <code>@EndpointConverter</code> 限定。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="272-自定义web端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web" target="_blank" rel="noopener noreferrer"></a>2.7.2. 自定义WEB端点<a href="#272-自定义web端点" class="hash-link" aria-label="Direct link to 272-自定义web端点" title="Direct link to 272-自定义web端点">​</a></h4>
<p>对 <code>@Endpoint</code>、<code>@WebEndpoint</code> 或 <code>@EndpointWebExtension</code> 操作会自动使用Jersey、Spring MVC或Spring WebFlux通过HTTP公开。 如果Jersey和Spring MVC都可用，则使用Spring MVC。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="web端点请求谓词predicates"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.request-predicates" target="_blank" rel="noopener noreferrer"></a>WEB端点请求谓词（Predicates）<a href="#web端点请求谓词predicates" class="hash-link" aria-label="Direct link to web端点请求谓词predicates" title="Direct link to web端点请求谓词predicates">​</a></h5>
<p>一个请求谓词会为web暴露的端点上的每个操作（operation）自动生成。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="path"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.path-predicates" target="_blank" rel="noopener noreferrer"></a>Path<a href="#path" class="hash-link" aria-label="Direct link to path" title="Direct link to path">​</a></h5>
<p>path谓词由端点的ID和网络暴露的端点的基本路径决定。 默认的基本路径是 <code>/actuator</code>。 例如，一个ID为 <code>sessions</code> 的端点在谓词中使用 <code>/actuator/sessions</code> 作为其路径。</p>
<p>你可以通过用 <code>@Selector</code> 注解操作方法的一个或多个参数来进一步定制路径。 这样的参数会作为一个路径变量添加到路径谓词中。 在调用端点操作时，该变量的值会被传入操作方法。 如果你想捕获所有剩余的路径元素，你可以在最后一个参数上添加 <code>@Selector(Match=ALL_REMAINING)</code>，并使其成为一个与 <code>String[]</code> 转换兼容的类型。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="http-method方法"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.method-predicates" target="_blank" rel="noopener noreferrer"></a>HTTP method（方法）<a href="#http-method方法" class="hash-link" aria-label="Direct link to http-method方法" title="Direct link to http-method方法">​</a></h5>
<p>HTTP method谓词是由操作类型决定的，如下表所示。</p>
<table><thead><tr><th>Operation</th><th>HTTP method</th></tr></thead><tbody><tr><td><code>@ReadOperation</code></td><td><code>GET</code></td></tr><tr><td><code>@WriteOperation</code></td><td><code>POST</code></td></tr><tr><td><code>@DeleteOperation</code></td><td><code>DELETE</code></td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="consumes"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.consumes-predicates" target="_blank" rel="noopener noreferrer"></a>Consumes<a href="#consumes" class="hash-link" aria-label="Direct link to consumes" title="Direct link to consumes">​</a></h5>
<p>对于使用request body的 <code>@WriteOperation</code>（HTTP <code>POST</code>），谓词的 <code>consumes</code> 子句是 <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>。 对于所有其他操作，<code>consumes</code> 子句是空的。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="produces"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.produces-predicates" target="_blank" rel="noopener noreferrer"></a>Produces<a href="#produces" class="hash-link" aria-label="Direct link to produces" title="Direct link to produces">​</a></h5>
<p>谓词的 <code>produces</code> 子句可以由 <code>@DeleteOperation</code>、<code>@ReadOperation</code> 和 <code>@WriteOperation</code> 注释的 <code>produces</code> 属性决定。 该属性是可选的。 如果不使用它，<code>produces</code> 子句会自动确定。</p>
<p>如果操作方法返回 <code>void</code> 或 <code>Void</code>，则 <code>produces</code> 子句为空。 如果操作方法返回 <code>org.springframework.core.io.Resource</code>，<code>produces</code> 子句是 <code>application/octet-stream</code>。 对于所有其他操作，<code>produces</code> 子句是 <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="web端点响应状态"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.response-status" target="_blank" rel="noopener noreferrer"></a>WEB端点响应状态<a href="#web端点响应状态" class="hash-link" aria-label="Direct link to web端点响应状态" title="Direct link to web端点响应状态">​</a></h5>
<p>端点操作的默认响应状态取决于操作类型（读、写或删除）和操作返回的内容（如果有的话）。</p>
<p>如果 <code>@ReadOperation</code> 返回一个值，响应状态将是200(Ok)。 如果它没有返回一个值，响应状态将是404(Not Found)。</p>
<p>如果 <code>@WriteOperation</code> 或 <code>@DeleteOperation</code> 返回一个值，响应状态将是200（OK）。 如果它没有返回一个值，响应状态将是204（No Content）。</p>
<p>如果一个操作在调用时没有所需的参数，或者参数不能被转换为所需的类型，操作方法就不会被调用，响应状态将是400（Bad Request）。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="web端点-range-请求"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.range-requests" target="_blank" rel="noopener noreferrer"></a>WEB端点 Range 请求<a href="#web端点-range-请求" class="hash-link" aria-label="Direct link to web端点-range-请求" title="Direct link to web端点-range-请求">​</a></h5>
<p>你可以使用HTTP range请求来请求一个HTTP资源的一部分。 当使用Spring MVC或Spring Web Flux时，返回 <code>org.springframework.core.io.Resource</code> 的操作自动支持范围请求。</p>
<table><thead><tr><th></th><th>使用Jersey时不支持 Range 请求。</th></tr></thead></table>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="web端点的安全"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.web.security" target="_blank" rel="noopener noreferrer"></a>Web端点的安全<a href="#web端点的安全" class="hash-link" aria-label="Direct link to web端点的安全" title="Direct link to web端点的安全">​</a></h5>
<p>在web端点或web特定端点扩展上的操作可以接收当前的 <code>java.security.Principal</code> 或 <code>org.springframework.boot.actuate.endpoint.SecurityContext</code> 作为方法参数。 前者通常与 <code>@Nullable</code> 一起使用，为已认证和未认证的用户提供不同的行为。 后者通常用于通过使用其 <code>isUserInRole(String)</code> 方法来执行授权检查。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="273-servlet-端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.servlet" target="_blank" rel="noopener noreferrer"></a>2.7.3. Servlet 端点<a href="#273-servlet-端点" class="hash-link" aria-label="Direct link to 273-servlet-端点" title="Direct link to 273-servlet-端点">​</a></h4>
<p>一个Servlet可以作为一个端点暴露出来，方法是实现一个用 <code>@ServletEndpoint</code> 注解的类，同时实现 <code>Supplier&lt;EndpointServlet&gt;</code>。 Servlet端点提供了与servlet容器的更深层次的整合，但却牺牲了可移植性。 它们的目的是用来将现有的Servlet作为一个端点来公开。 对于新的端点，应尽可能选择 <code>@Endpoint</code> 和 <code>@WebEndpoint</code> 注解。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="274-controller-端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.implementing-custom.controller" target="_blank" rel="noopener noreferrer"></a>2.7.4. Controller 端点<a href="#274-controller-端点" class="hash-link" aria-label="Direct link to 274-controller-端点" title="Direct link to 274-controller-端点">​</a></h4>
<p>你可以使用 <code>@ControllerEndpoint</code> 和 <code>@RestControllerEndpoint</code> 来实现一个仅由Spring MVC或Spring WebFlux公开的端点。 方法通过使用Spring MVC和Spring WebFlux的标准注解进行映射，如 <code>@RequestMapping</code> 和 <code>@GetMapping</code>，端点的ID被用作路径的前缀。 控制器端点提供了与Spring的Web框架更深入的集成，但却牺牲了可移植性。 应尽可能选择 <code>@Endpoint</code> 和 <code>@WebEndpoint</code> 注解。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="28-健康信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health" target="_blank" rel="noopener noreferrer"></a>2.8. 健康信息<a href="#28-健康信息" class="hash-link" aria-label="Direct link to 28-健康信息" title="Direct link to 28-健康信息">​</a></h3>
<p>你可以使用健康信息来检查你运行的应用程序的状态。 它经常被监控软件用来在生产系统发生故障时提醒别人。 <code>health</code> 端点暴露的信息取决于 <code>management.endpoint.health.show-details</code> 和 <code>management.endpoint.health.show-components</code> 属性，它们可以配置为以下值之一。</p>
<table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td><code>never</code></td><td>细节从不显示。</td></tr><tr><td><code>when-authorized</code></td><td>细节只显示给授权用户。 授权的角色可以通过使用 <code>management.endpoint.health.roles</code> 进行配置。</td></tr><tr><td><code>always</code></td><td>详情显示给所有用户。</td></tr></tbody></table>
<p>默认值是 <code>never</code>。 当用户处于端点的一个或多个角色中时，他们被认为是被授权的。 如果端点没有配置角色（默认值），所有认证的用户都被认为是授权的。 你可以通过使用 <code>management.endpoint.health.roles</code> 属性来配置角色。</p>
<table><thead><tr><th></th><th>如果你已经保护了你的应用程序并希望使用 <code>always</code>，你的安全配置（security configuration）必须允许认证和非认证用户访问health端点。</th></tr></thead></table>
<p>健康信息是从 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributorRegistry.java" target="_blank" rel="noopener noreferrer"><code>HealthContributorRegistry</code></a> 的内容中收集的（默认情况下，所有 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java" target="_blank" rel="noopener noreferrer"><code>HealthContributor</code></a> 实例都定义在你的 <code>ApplicationContext</code> 中）。 Spring Boot包括一些自动配置的 <code>HealthContributor</code>，你也可以编写自己的。</p>
<p>一个 <code>HealthContributor</code> 可以是一个 <code>HealthIndicator</code> 或一个 <code>CompositeHealthContributor</code>。 一个 <code>HealthIndicator</code> 提供实际的健康信息，包括 <code>Status</code>。 一个 <code>CompositeHealthContributor</code> 提供其他 <code>HealthContributors</code> 的组合。 综合起来，contributor形成一个树状结构来表示整个系统的健康状况。</p>
<p>默认情况下，最终的系统健康状况是由一个 <code>StatusAggregator</code> 得出的，它根据一个有序的状态列表对每个 <code>HealthIndicator</code> 的状态进行排序。 排序列表中的第一个状态被用作整体健康状态。 如果没有 <code>HealthIndicator</code> 返回的状态是 <code>StatusAggregator</code> 所知道的，就会使用 <code>UNKNOWN</code> 状态。</p>
<table><thead><tr><th></th><th>你可以使用 <code>HealthContributorRegistry</code> 来在运行时注册和取消注册健康指标。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="281-自动配置的healthindicators"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.auto-configured-health-indicators" target="_blank" rel="noopener noreferrer"></a>2.8.1. 自动配置的HealthIndicators<a href="#281-自动配置的healthindicators" class="hash-link" aria-label="Direct link to 281-自动配置的healthindicators" title="Direct link to 281-自动配置的healthindicators">​</a></h4>
<p>在适当的时候，Spring Boot会自动配置下表中列出的 <code>HealthIndicators</code>。 你也可以通过配置 <code>management.health.key.enabled</code> 来启用或停用所选指标。 和下表中列出的 <code>key</code>。</p>
<table><thead><tr><th>Key</th><th>Name</th><th>说明</th></tr></thead><tbody><tr><td><code>cassandra</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraDriverHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>CassandraDriverHealthIndicator</code></a></td><td>检查Cassandra数据库是否已经启动。</td></tr><tr><td><code>couchbase</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>CouchbaseHealthIndicator</code></a></td><td>检查Couchbase集群是否已经启动。</td></tr><tr><td><code>db</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jdbc/DataSourceHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>DataSourceHealthIndicator</code></a></td><td>检查是否可以获得与<code>DataSource</code>的连接。</td></tr><tr><td><code>diskspace</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/system/DiskSpaceHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>DiskSpaceHealthIndicator</code></a></td><td>检查磁盘空间是否不足。</td></tr><tr><td><code>elasticsearch</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/elasticsearch/ElasticsearchRestHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>ElasticsearchRestHealthIndicator</code></a></td><td>检查Elasticsearch集群是否已经启动。</td></tr><tr><td><code>hazelcast</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/hazelcast/HazelcastHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>HazelcastHealthIndicator</code></a></td><td>检查Hazelcast服务器是否已经启动。</td></tr><tr><td><code>influxdb</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/influx/InfluxDbHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>InfluxDbHealthIndicator</code></a></td><td>检查InfluxDB服务器是否已经启动。</td></tr><tr><td><code>jms</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jms/JmsHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>JmsHealthIndicator</code></a></td><td>检查一个JMS代理是否已经启动。</td></tr><tr><td><code>ldap</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/ldap/LdapHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>LdapHealthIndicator</code></a></td><td>检查一个LDAP服务器是否正常。</td></tr><tr><td><code>mail</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mail/MailHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>MailHealthIndicator</code></a></td><td>检查一个邮件服务器是否正常。</td></tr><tr><td><code>mongo</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/mongo/MongoHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>MongoHealthIndicator</code></a></td><td>检查Mongo数据库是否已经启动。</td></tr><tr><td><code>neo4j</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>Neo4jHealthIndicator</code></a></td><td>检查Neo4j数据库是否已经启动。</td></tr><tr><td><code>ping</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/PingHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>PingHealthIndicator</code></a></td><td>总是响应 <code>UP</code> 。</td></tr><tr><td><code>rabbit</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/amqp/RabbitHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>RabbitHealthIndicator</code></a></td><td>检查一个Rabbit服务器是否已经启动。</td></tr><tr><td><code>redis</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/redis/RedisHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>RedisHealthIndicator</code></a></td><td>检查Redis服务器是否已经启动。</td></tr></tbody></table>
<table><thead><tr><th></th><th>你可以通过设置 <code>management.health.defaults.enabled</code> 属性来禁用它们。</th></tr></thead></table>
<p>额外的 <code>HealthIndicators</code> 是可用的，但在默认情况下不启用。</p>
<table><thead><tr><th>Key</th><th>Name</th><th>说明</th></tr></thead><tbody><tr><td><code>livenessstate</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/availability/LivenessStateHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>LivenessStateHealthIndicator</code></a></td><td>显示 “Liveness” 应用程序的可用性状态。</td></tr><tr><td><code>readinessstate</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/availability/ReadinessStateHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>ReadinessStateHealthIndicator</code></a></td><td>暴露 “Readiness” 应用程序的可用性状态。</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="282-编写自定义healthindicators"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.writing-custom-health-indicators" target="_blank" rel="noopener noreferrer"></a>2.8.2. 编写自定义HealthIndicators<a href="#282-编写自定义healthindicators" class="hash-link" aria-label="Direct link to 282-编写自定义healthindicators" title="Direct link to 282-编写自定义healthindicators">​</a></h4>
<p>为了提供自定义的健康信息，你可以注册实现 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>HealthIndicator</code></a> 接口的Spring Bean。 你需要提供一个 <code>health()</code> 方法的实现，并返回一个 <code>Health</code> 响应。 <code>Health</code> 响应应该包括一个status，并可以选择包括要显示的其他细节。 下面的代码显示了一个 <code>HealthIndicator</code> 的实现样本。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyHealthIndicator implements HealthIndicator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Health health() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int errorCode = check();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (errorCode != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Health.down().withDetail(&quot;Error Code&quot;, errorCode).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Health.up().build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int check() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // perform some specific health check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>一个给定的 <code>HealthIndicator</code> 的标识符（ID）是没有 <code>HealthIndicator</code> 后缀的Bean的名字，如果它存在的话。 在前面的例子中，健康信息可以在一个名为 <code>my</code> 的条目中找到。</th></tr></thead></table>
<table><thead><tr><th></th><th>健康指标通常是通过HTTP调用的，需要在任何连接超时之前做出响应。 如果任何健康指标的响应时间超过10秒，Spring Boot将记录一条警告信息。 如果你想配置这个阈值，你可以使用 <code>management.endpoint.health.logging.slow-indicator-threshold</code> 属性。</th></tr></thead></table>
<p>除了Spring Boot预定义的 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/Status.java" target="_blank" rel="noopener noreferrer"><code>Status</code></a> 类型外，<code>Health</code> 可以返回代表新系统状态的自定义 <code>Status</code>。 在这种情况下，你还需要提供 <code>StatusAggregator</code> 接口的自定义实现，或者你必须通过使用 <code>management.endpoint.health.status.order</code> 配置属性来配置默认实现。</p>
<p>例如，假设在你的一个 <code>HealthIndicator</code> 实现中使用了一个代码为 <code>FATAL</code> 的新 <code>Status</code>。 为了配置严重性顺序，在你的应用程序属性中添加以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.status.order=fatal,down,out-of-service,unknown,up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>响应中的HTTP状态代码反映了整体健康状态。 默认情况下，<code>OUT_OF_SERVICE</code> 和 <code>DOWN</code> 映射到503。 任何未映射的健康状态，包括 <code>UP</code>，都映射为200。 如果你通过HTTP访问健康端点，你可能还想注册自定义状态映射。 配置自定义映射会禁用 <code>DOWN</code> 和 <code>OUT_OF_SERVICE</code> 的默认映射。 如果你想保留默认映射，你必须明确地配置它们，以及任何自定义映射。 例如，下面的属性将 <code>FATAL</code> 映射为503（服务不可用），并保留了 <code>DOWN</code> 和 <code>OUT_OF_SERVICE</code> 的默认映射。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.status.http-mapping.down=503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.status.http-mapping.fatal=503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.status.http-mapping.out-of-service=503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>如果你需要更多的控制，你可以定义你自己的 <code>HttpCodeStatusMapper</code> bean。</th></tr></thead></table>
<p>下表显示了内置状态的默认状态映射。</p>
<table><thead><tr><th>Status</th><th>Mapping</th></tr></thead><tbody><tr><td><code>DOWN</code></td><td><code>SERVICE_UNAVAILABLE</code> (<code>503</code>)</td></tr><tr><td><code>OUT_OF_SERVICE</code></td><td><code>SERVICE_UNAVAILABLE</code> (<code>503</code>)</td></tr><tr><td><code>UP</code></td><td>默认情况下没有映射，所以HTTP状态为 <code>200</code>。</td></tr><tr><td><code>UNKNOWN</code></td><td>默认情况下没有映射，所以HTTP状态为 <code>200</code>。</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="283-响应式健康指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.reactive-health-indicators" target="_blank" rel="noopener noreferrer"></a>2.8.3. 响应式健康指标<a href="#283-响应式健康指标" class="hash-link" aria-label="Direct link to 283-响应式健康指标" title="Direct link to 283-响应式健康指标">​</a></h4>
<p>对于响应式应用程序，例如那些使用Spring WebFlux的应用程序，<code>ReactiveHealthContributor</code> 提供了一个非阻塞的契约来获取应用程序的健康状况。 与传统的 <code>HealthContributor</code> 类似，健康信息从 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributorRegistry.java" target="_blank" rel="noopener noreferrer"><code>ReactiveHealthContributorRegistry</code></a> 的内容中收集（默认情况下，所有 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java" target="_blank" rel="noopener noreferrer"><code>HealthContributor</code></a> 和 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributor.java" target="_blank" rel="noopener noreferrer"><code>ReactiveHealthContributor</code></a> 的实例定义在你的 <code>ApplicationContext</code> 里）。</p>
<p>不对响应式API进行检查的常规 <code>HealthContributors</code> 在弹性调度器上执行。</p>
<table><thead><tr><th></th><th>在一 个响应式应用程序中，你应该使用 <code>ReactiveHealthContributorRegistry</code> 来在运行时注册和取消注册健康指标。 如果你需要注册一个普通的 <code>HealthContributor</code>，你应该用 <code>ReactiveHealthContributor#adapt</code> 来包装它。</th></tr></thead></table>
<p>为了从响应式API中提供自定义的健康信息，你可以注册实现 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>ReactiveHealthIndicator</code></a> 接口的Spring Bean。 下面的代码显示了一个 <code>ReactiveHealthIndicator</code> 的示例实现。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyReactiveHealthIndicator implements ReactiveHealthIndicator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Mono&lt;Health&gt; health() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return doHealthCheck().onErrorResume((exception) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Mono.just(new Health.Builder().down(exception).build()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Mono&lt;Health&gt; doHealthCheck() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // perform some specific health check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>为了自动处理错误，可以考虑从 <code>AbstractReactiveHealthIndicator</code> 中扩展。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="284-自动配置的-reactivehealthindicators"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.auto-configured-reactive-health-indicators" target="_blank" rel="noopener noreferrer"></a>2.8.4. 自动配置的 ReactiveHealthIndicators<a href="#284-自动配置的-reactivehealthindicators" class="hash-link" aria-label="Direct link to 284-自动配置的-reactivehealthindicators" title="Direct link to 284-自动配置的-reactivehealthindicators">​</a></h4>
<p>在适当的时候，Spring Boot会自动配置以下的 <code>ReactiveHealthIndicators</code>。</p>
<table><thead><tr><th>Key</th><th>Name</th><th>说明</th></tr></thead><tbody><tr><td><code>cassandra</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraDriverReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>CassandraDriverReactiveHealthIndicator</code></a></td><td>检查Cassandra数据库是否已经启动。</td></tr><tr><td><code>couchbase</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>CouchbaseReactiveHealthIndicator</code></a></td><td>检查Couchbase集群是否已经启动。</td></tr><tr><td><code>elasticsearch</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/elasticsearch/ElasticsearchReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>ElasticsearchReactiveHealthIndicator</code></a></td><td>检查Elasticsearch集群是否已经启动。</td></tr><tr><td><code>mongo</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/mongo/MongoReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>MongoReactiveHealthIndicator</code></a></td><td>  检查Mongo数据库是否已经启动。</td></tr><tr><td><code>neo4j</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>Neo4jReactiveHealthIndicator</code></a></td><td>检查Neo4j数据库是否已经启动。</td></tr><tr><td><code>redis</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/redis/RedisReactiveHealthIndicator.java" target="_blank" rel="noopener noreferrer"><code>RedisReactiveHealthIndicator</code></a></td><td>检查Redis服务器是否已经启动。</td></tr></tbody></table>
<table><thead><tr><th></th><th>如果有必要，响应式指标会取代常规指标。 另外，任何没有被明确处理的 <code>HealthIndicator</code> 都会被自动包装起来。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="285-health分组health-groups"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.groups" target="_blank" rel="noopener noreferrer"></a>2.8.5. Health分组（Health Groups）<a href="#285-health分组health-groups" class="hash-link" aria-label="Direct link to 285-health分组health-groups" title="Direct link to 285-health分组health-groups">​</a></h4>
<p>有时，将健康指标组织成可以用于不同目的的组是很有用的。</p>
<p>要创建一个健康指标组，你可以使用 <code>management.endpoint.health.group.&lt;name&gt;</code> 属性，并指定一个健康指标ID列表来 <code>include</code> 或 <code>exclude</code>。 例如，要创建一个只包括数据库指标的组，你可以定义如下。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.include=db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后你可以通过点击 <code>[localhost:8080/actuator/health/custom](http://localhost:8080/actuator/health/custom)</code> 来检查结果。</p>
<p>同样，要创建一个组，将数据库指标排除在该组之外，并包括所有其他指标，你可以定义如下。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.exclude=db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认情况下，组继承了与系统健康相同的 <code>StatusAggregator</code> 和 <code>HttpCodeStatusMapper</code> 设置。 然而，你也可以在每个组的基础上定义这些。 如果需要，你也可以覆盖 <code>show-details</code> 和 <code>roles</code> 属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.show-details=when-authorized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.roles=admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.status.order=fatal,up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.status.http-mapping.fatal=500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.status.http-mapping.out-of-service=500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>如果你需要注册自定义的 <code>StatusAggregator</code> 或 <code>HttpCodeStatusMapper</code> Bean以用于组，你可以使用 <code>@Qualifier(&quot;groupname&quot;)</code>。</th></tr></thead></table>
<p>一个健康组也可以包括/排除一个 <code>CompositeHealthContributor</code>。 您也可以只包括/排除一个 <code>CompositeHealthContributor</code> 的某个组件。 这可以使用组件的完全名称来完成，如下所示。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.include=&quot;test/primary&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.custom.exclude=&quot;test/primary/b&quot;</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在上面的例子中，<code>custom</code> 组将包括名称为 <code>primary</code> 的 <code>HealthContributor</code>，它是复合 <code>test</code> 的一个组成部分。 在这里，<code>primary</code> 本身就是一个复合体，名字为 <code>b</code> 的 <code>HealthContributor</code> 将被排除在 <code>custom</code> 组之外。</p>
<p>健康组可以在主端口或管理端口的额外路径上提供。 这在Kubernetes等云环境中很有用，在这些环境中，出于安全考虑，为执行器端点使用一个单独的管理端口是很常见的。 有一个单独的端口可能导致不可靠的健康检查，因为即使健康检查成功，主应用程序也可能无法正常工作。 健康组可以用一个额外的路径进行配置，如下所示。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.live.additional-path=&quot;server:/healthz&quot;</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这将使 <code>live</code> 健康组在主服务器端口 <code>/healthz</code> 上可用。 前缀是强制性的，必须是 <code>server:</code>（代表主服务器端口）或 <code>management:</code>（代表管理端口，如果已配置）。 路径必须是一个单一的路径段。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="286-数据源健康"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.datasource" target="_blank" rel="noopener noreferrer"></a>2.8.6. 数据源健康<a href="#286-数据源健康" class="hash-link" aria-label="Direct link to 286-数据源健康" title="Direct link to 286-数据源健康">​</a></h4>
<p><code>DataSource</code> 健康指标显示标准数据源和路由数据源Bean的健康状况。 路由数据源的健康状况包括其每个目标数据源的健康状况。 在健康端点的响应中，路由数据源的每个目标都是通过使用其路由键来命名的。 如果你不希望在指标的输出中包括路由数据源，请将 <code>management.health.db.ignore-routing-data-sources</code> 设置为 <code>true</code>。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="29-kubernetes-探针"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.kubernetes-probes" target="_blank" rel="noopener noreferrer"></a>2.9. Kubernetes 探针<a href="#29-kubernetes-探针" class="hash-link" aria-label="Direct link to 29-kubernetes-探针" title="Direct link to 29-kubernetes-探针">​</a></h3>
<p>部署在Kubernetes上的应用程序可以通过 <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes" target="_blank" rel="noopener noreferrer">容器探针</a> 提供有关其内部状态的信息。根据 <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/" target="_blank" rel="noopener noreferrer">你的Kubernetes配置</a>，kubelet会调用这些探针并对结果做出反应。</p>
<p>默认情况下，Spring Boot会管理你的<a href="https://springdoc.cn/spring-boot/features.html#features.spring-application.application-availability" target="_blank" rel="noopener noreferrer">应用可用性状态</a>。 如果部署在Kubernetes环境中，actuator从 <code>ApplicationAvailability</code> 接口中收集 “Liveness” 和 “Readiness” 信息，并在专用<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.auto-configured-health-indicators" target="_blank" rel="noopener noreferrer">健康指标</a>中使用这些信息。<code>LivenessStateHealthIndicator</code> 和 <code>ReadinessStateHealthIndicator</code>。 这些指标显示在全局健康端点（<code>&quot;/actuator/health&quot;</code>）。 它们也可以通过使用<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.groups" target="_blank" rel="noopener noreferrer">健康组</a>作为单独的HTTP探针：<code>&quot;/actuator/health/liveness&quot;</code> 和 <code>&quot;/actuator/health/readiness&quot;</code>。</p>
<p>然后，你可以用以下端点信息配置你的Kubernetes基础设施。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path: &quot;/actuator/health/liveness&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  failureThreshold: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  periodSeconds: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readinessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path: &quot;/actuator/health/readiness&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  failureThreshold: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  periodSeconds: ...</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>`` 应该被设置为执行器端点可用的端口。 它可以是主Web服务器的端口，也可以是一个单独的管理端口，如果 <code>&quot;management.server.port&quot;</code> 属性已经被设置。</th></tr></thead></table>
<p>只有当应用程序<a href="https://springdoc.cn/spring-boot/deployment.html#deployment.cloud.kubernetes" target="_blank" rel="noopener noreferrer">在Kubernetes环境中运行时</a>，这 些健康组才会自动启用。 你可以通过使用 <code>management.endpoint.health.probes.enabled</code> 配置属性在任何环境中启用它们。</p>
<table><thead><tr><th></th><th>如果一个应用程序的启动时间超过了配置的有效期，Kubernetes 会提到 <code>&quot;startupProbe&quot;</code> 作为一个可能的解决方案。一般来说，这里不一定需要 <code>&quot;startupProbe&quot;</code>，因为 <code>&quot;readinessProbe&quot;</code> 会在所有启动任务完成之前失效。这意味着你的应用程序在准备好之前不会收到流量。然而，如果你的应用程序需要很长时间才能启动，可以考虑使用 <code>&quot;startupProbe&quot;</code> 来确保Kubernetes不会在你的应用程序启动过程中杀死它。请参阅描述<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.kubernetes-probes.lifecycle" target="_blank" rel="noopener noreferrer">探针在应用程序生命周期中的行为</a>的部分。</th></tr></thead></table>
<p>如果你的Actuator端点被部署在一个单独的管理上下文中，那么这些端点就不会像主程序那样使用相同的网络基础设施（端口、连接池、框架组件）。 在这种情况下，即使主程序不能正常工作（例如，它不能接受新的连接），探测检查也可能成功。 由于这个原因，在主服务器端口上设置 <code>liveness</code> 和 <code>readiness</code> 健康组是个好主意。 这可以通过设置以下属性来实现。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.probes.add-additional-paths=true</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这将使 <code>liveness</code> 在 <code>/livez</code> 可用，<code>readiness</code> 在 <code>readyz</code> 的主服务器端口可用。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="291-用kubernetes探针检查外部状态"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.kubernetes-probes.external-state" target="_blank" rel="noopener noreferrer"></a>2.9.1. 用Kubernetes探针检查外部状态<a href="#291-用kubernetes探针检查外部状态" class="hash-link" aria-label="Direct link to 291-用kubernetes探针检查外部状态" title="Direct link to 291-用kubernetes探针检查外部状态">​</a></h4>
<p>执行器将 “liveness” 和 “readiness” 探针配置为健康组。这意味着所有的<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.health.groups" target="_blank" rel="noopener noreferrer">健康组的功能</a>对它们都是可用的。例如，你可以配置额外的健康指标。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoint.health.group.readiness.include=readinessState,customCheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认情况下，Spring Boot不会向这些组添加其他健康指标。</p>
<p>“liveness” 探针不应该依赖于外部系统的健康检查。如果<a href="https://springdoc.cn/spring-boot/features.html#features.spring-application.application-availability.liveness" target="_blank" rel="noopener noreferrer">应用程序的有效性状态</a>被破坏，Kubernetes会尝试通过重新启动应用程序实例来解决这个问题。这意味着，如果一个外部系统（如数据库、Web API或外部缓存）出现故障，Kubernetes可能会重新启动所有应用程序实例，并产生级联故障。</p>
<p>至于 “readiness” 探测，检查外部系统的选择必须由应用程序开发人员谨慎作出。出于这个原因，Spring Boot在准备状态探测中不包括任何额外的健康检查。如果<a href="https://springdoc.cn/spring-boot/features.html#features.spring-application.application-availability.readiness" target="_blank" rel="noopener noreferrer">应用程序实例的readiness state是unready</a>，Kubernetes就不会将流量路由到该实例。一些外部系统可能不被应用实例所共享，在这种情况下，它们可以被包括在准备状态探测中。其他外部系统可能不是应用程序的关键（应用程序可能有断路器和回退），在这种情况下，它们绝对不应该被包括在内。不幸的是，一个被所有应用实例共享的外部系统很常见，你必须做出判断。把它包括在准备就绪探针中，并期望当外部服务发生故障时，应用程序会被停止服务，或者不包括它，并处理堆栈中更高层次的故障，也许通过在调用者中使用断路器。</p>
<table><thead><tr><th></th><th>如果一个应用程序的所有实例都没有准备好，<code>type=ClusterIP</code> 或 <code>NodePort</code> 的Kubernetes服务不接受任何传入连接。没有HTTP错误响应（503等），因为没有连接。<code>type=LoadBalancer</code> 的服务可能接受也可能不接受连接，这取决于提供者。一个有明确 <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener noreferrer">ingress</a> 的服务也会以一种取决于实现的方式进行响应—?入口服务本身必须决定如何处理来自下游的 “connection refused”。在负载均衡器和入口的情况下，HTTP 503是很有可能的。</th></tr></thead></table>
<p>另外，如果一个应用程序使用 Kubernetes <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" target="_blank" rel="noopener noreferrer">autoscaling</a>，它可能会对应用程序被从负载平衡器中取出做出不同的反应，这取决于其autoscaler的配置。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="292-应用程序生命周期和探针状态"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.kubernetes-probes.lifecycle" target="_blank" rel="noopener noreferrer"></a>2.9.2. 应用程序生命周期和探针状态<a href="#292-应用程序生命周期和探针状态" class="hash-link" aria-label="Direct link to 292-应用程序生命周期和探针状态" title="Direct link to 292-应用程序生命周期和探针状态">​</a></h4>
<p>Kubernetes Probes支持的一个重要方面是它  与应用程序生命周期的一致性。 <code>AvailabilityState</code>（即应用程序的内存内部状态）和实际的探针（暴露该状态）之间存在着显著的区别。 和实际的探针（暴露了该状态）之间有很大的区别。 根据应用程序生命周期的不同阶段，探针可能无法使用。</p>
<p>Spring Boot在<a href="https://springdoc.cn/spring-boot/features.html#features.spring-application.application-events-and-listeners" target="_blank" rel="noopener noreferrer">启动和关闭期间发布application event</a>，探针可以监听这些事件并暴露出 <code>AvailabilityState</code> 信息。</p>
<p>下表显示了不同阶段的 <code>AvailabilityState</code> 和HTTP connector的状态。</p>
<p>当一个Spring Boot应用程序启动时。</p>
<table><thead><tr><th>启动阶段</th><th>LivenessState</th><th>ReadinessState</th><th>HTTP server</th><th>备注</th></tr></thead><tbody><tr><td>Starting</td><td><code>BROKEN</code></td><td><code>REFUSING_TRAFFIC</code></td><td>未启动</td><td>Kubernetes检查 &quot;liveness&quot; 探针，如果时间过长，就重新启动应用程序。</td></tr><tr><td>Started</td><td><code>CORRECT</code></td><td><code>REFUSING_TRAFFIC</code></td><td>拒绝请求</td><td>应用程序上下文被刷新。应用程序执行启动任务，还没有收到流量。</td></tr><tr><td>Ready</td><td><code>CORRECT</code></td><td><code>ACCEPTING_TRAFFIC</code></td><td>接受请求</td><td>启动任务已经完成。该应用程序正在接收流量。</td></tr></tbody></table>
<p>当一个Spring Boot应用程序关闭时。</p>
<table><thead><tr><th>停机阶段</th><th>Liveness State</th><th>Readiness State</th><th>HTTP server</th><th>备注</th></tr></thead><tbody><tr><td>Running</td><td><code>CORRECT</code></td><td><code>ACCEPTING_TRAFFIC</code></td><td>接受请求</td><td>已要求关闭。</td></tr><tr><td>Graceful shutdown</td><td><code>CORRECT</code></td><td><code>REFUSING_TRAFFIC</code></td><td>新的请求被拒绝</td><td>如果启用， <a href="https://springdoc.cn/spring-boot/web.html#web.graceful-shutdown" target="_blank" rel="noopener noreferrer">优雅关机会处理“处理中”的请求</a>。</td></tr><tr><td>Shutdown complete</td><td>N/A</td><td>N/A</td><td>服务器被关闭</td><td>应用程序上下文被关闭，应用程序被关闭。</td></tr></tbody></table>
<table><thead><tr><th></th><th>关于Kubernetes部署的更多信息，请参见<a href="https://springdoc.cn/spring-boot/deployment.html#deployment.cloud.kubernetes.container-lifecycle" target="_blank" rel="noopener noreferrer">Kubernetes容器生命周期</a>部分。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="210-应用信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info" target="_blank" rel="noopener noreferrer"></a>2.10. 应用信息<a href="#210-应用信息" class="hash-link" aria-label="Direct link to 210-应用信息" title="Direct link to 210-应用信息">​</a></h3>
<p>应用程序信息公开了从你的 <code>ApplicationContext</code> 中定义的所有 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java" target="_blank" rel="noopener noreferrer"><code>InfoContributor</code></a> Bean收集的各种信息。 Spring Boot包括一些自动配置的 <code>InfoContributor</code> Bean，你也可以编写自己的。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2101-自动配置的-infocontributor"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.auto-configured-info-contributors" target="_blank" rel="noopener noreferrer"></a>2.10.1. 自动配置的 InfoContributor<a href="#2101-自动配置的-infocontributor" class="hash-link" aria-label="Direct link to 2101-自动配置的-infocontributor" title="Direct link to 2101-自动配置的-infocontributor">​</a></h4>
<p>在适当的时候，Spring会自动配置以下 <code>InfoContributor</code> Bean。</p>
<table><thead><tr><th>ID</th><th>Name</th><th>说明</th><th>前提条件</th></tr></thead><tbody><tr><td><code>build</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/BuildInfoContributor.java" target="_blank" rel="noopener noreferrer"><code>BuildInfoContributor</code></a></td><td>暴露了构建信息。</td><td>一个 <code>META-INF/build-info.properties</code> 资源。</td></tr><tr><td><code>env</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java" target="_blank" rel="noopener noreferrer"><code>EnvironmentInfoContributor</code></a></td><td>暴露 <code>Environment</code> 中名称以 <code>info.</code> 开头的任何属性。</td><td>None.</td></tr><tr><td><code>git</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java" target="_blank" rel="noopener noreferrer"><code>GitInfoContributor</code></a></td><td>暴露了git信息。</td><td>一个 <code>git.properties</code> 资源。</td></tr><tr><td><code>java</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/JavaInfoContributor.java" target="_blank" rel="noopener noreferrer"><code>JavaInfoContributor</code></a></td><td>暴露Java运行时（Runtime）信息。</td><td>None.</td></tr><tr><td><code>os</code></td><td><a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/OsInfoContributor.java" target="_blank" rel="noopener noreferrer"><code>OsInfoContributor</code></a></td><td>暴露操作系 统信息。</td><td>None.</td></tr></tbody></table>
<p>个人贡献者（contributor）是否被启用是由其 <code>management.info.&lt;id&gt;.enabled</code> 属性控制。 不同的contributor对这个属性有不同的默认值，这取决于他们的先决条件和他们所暴露的信息的性质。</p>
<p>由于没有先决条件表明它们应该被启用，<code>env</code>、<code>java</code> 和 <code>os</code> contributor 默认是禁用的。 可以通过设置 <code>management.info.&lt;id&gt;.enabled</code> 属性为 <code>true</code> 来启用它们。</p>
<p><code>build</code> 和 <code>git</code> 信息contributor默认是启用的。 可以通过将其 <code>management.info.&lt;id&gt;.enabled</code> 属性设置为 <code>false</code> 来禁用。 另外，要禁用每一个默认启用的contributor，请将 <code>management.info.defaults.enabled</code> 属性设为 <code>false</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2102-自定义应用信息application-information"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.custom-application-information" target="_blank" rel="noopener noreferrer"></a>2.10.2. 自定义应用信息（Application Information）<a href="#2102-自定义应用信息application-information" class="hash-link" aria-label="Direct link to 2102-自定义应用信息application-information" title="Direct link to 2102-自定义应用信息application-information">​</a></h4>
<p>当 <code>env</code> contributor 被启用时，你可以通过设置 <code>info.*</code> Spring属性来定制 <code>info</code> 端点所暴露的数据。 <code>info</code> key下的所有 <code>Environment</code> 属性都会自动暴露。 例如，你可以在你的 <code>application.properties</code> 文件中添加以下设置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">info.app.encoding=UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info.app.java.source=17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info.app.java.target=17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>与其硬编码这些值，你还可以 <a href="https://springdoc.cn/spring-boot/howto.html#howto.properties-and-configuration.expand-properties" target="_blank" rel="noopener noreferrer">在构建时扩展信息属性</a>。假设你使用Maven，你可以将前面的例子改写如下。PropertiesYaml<code>info.app.encoding=@project.build.sourceEncoding@info.app.java.source=@java.version@info.app.java.target=@java.version@</code></th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2103-git-commit-信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.git-commit-information" target="_blank" rel="noopener noreferrer"></a>2.10.3. Git Commit 信息<a href="#2103-git-commit-信息" class="hash-link" aria-label="Direct link to 2103-git-commit-信息" title="Direct link to 2103-git-commit-信息">​</a></h4>
<p><code>info</code> 端点的另一个有用的功能是它能够发布关于你的 <code>git</code> 源代码库在项目建立时的状态的信息。 如果有一个 <code>GitProperties</code> bean，你可以使用 <code>info</code> 端点来公布这些属性。</p>
<table><thead><tr><th></th><th>如果classpath的根部有 <code>git.properties</code> 文件，<code>GitProperties</code> Bean就会被自动配置。更多细节见 &quot;<a href="https://springdoc.cn/spring-boot/howto.html#howto.build.generate-git-info" target="_blank" rel="noopener noreferrer">如何生成git信息</a>&quot;。</th></tr></thead></table>
<p>默认情况下，端点会暴露 <code>git.branch</code>、<code>git.commit.id</code> 和 <code>git.commit.time</code> 属性（如果存在）。 如果你不想让这些属性出现在端点响应中，需要从 <code>git.properties</code> 文件中排除它们。 如果你想显示完整的git信息（即 <code>git.properties</code> 的全部内容），使用 <code>management.info.git.mode</code> 属性，如下所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.info.git.mode=full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要从 <code>info</code> 端点完全禁用git提交信息，请 <code>management.info.git.enabled</code> 属性设为 <code>false</code>，如下所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.info.git.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2104-构建信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.build-information" target="_blank" rel="noopener noreferrer"></a>2.10.4. 构建信息<a href="#2104-构建信息" class="hash-link" aria-label="Direct link to 2104-构建信息" title="Direct link to 2104-构建信息">​</a></h4>
<p>如果 <code>BuildProperties</code> Bean是可用的 ，<code>info</code> 端点也可以发布关于你的构建信息。如果classpath中的 <code>META-INF/build-info.properties</code> 文件可用，就会发生这种情况。</p>
<table><thead><tr><th></th><th>Maven和Gradle插件都可以生成该文件。详见 &quot;<a href="https://springdoc.cn/spring-boot/howto.html#howto.build.generate-info" target="_blank" rel="noopener noreferrer">如何生成构建信息</a>&quot;。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2105-java信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.java-information" target="_blank" rel="noopener noreferrer"></a>2.10.5. Java信息<a href="#2105-java信息" class="hash-link" aria-label="Direct link to 2105-java信息" title="Direct link to 2105-java信息">​</a></h4>
<p><code>info</code> 端点发布了关于你的Java运行环境的信息，更多细节见 <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/api/org/springframework/boot/info/JavaInfo.html" target="_blank" rel="noopener noreferrer"><code>JavaInfo</code></a>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2106-操作系统os信息"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.os-information" target="_blank" rel="noopener noreferrer"></a>2.10.6. 操作系统（OS）信息<a href="#2106-操作系统os信息" class="hash-link" aria-label="Direct link to 2106-操作系统os信息" title="Direct link to 2106-操作系统os信息">​</a></h4>
<p><code>info</code> 端点发布关于你的操作系统的信息，更多细节见 <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/api/org/springframework/boot/info/OsInfo.html" target="_blank" rel="noopener noreferrer"><code>OsInfo</code></a>`。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="2107-编写自定义-infocontributor"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.info.writing-custom-info-contributors" target="_blank" rel="noopener noreferrer"></a>2.10.7. 编写自定义 InfoContributor<a href="#2107-编写自定义-infocontributor" class="hash-link" aria-label="Direct link to 2107-编写自定义-infocontributor" title="Direct link to 2107-编写自定义-infocontributor">​</a></h4>
<p>为了提供自定义的应用程序信息，你可以注册实现 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java" target="_blank" rel="noopener noreferrer"><code>InfoContributor</code></a> 接口的Spring Bean。</p>
<p>下面的例子贡献了一个只有一个值的 <code>example</code> 条目。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyInfoContributor implements InfoContributor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void contribute(Info.Builder builder) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.withDetail(&quot;example&quot;, Collections.singletonMap(&quot;key&quot;, &quot;value&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果你请求 <code>info</code> 端点，你应该看到一个包含以下额外条目的响应。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;example&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;key&quot; : &quot;value&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="3-通过http进行监控和管理"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring" target="_blank" rel="noopener noreferrer"></a>3. 通过HTTP进行监控和管理<a href="#3-通过http进行监控和管理" class="hash-link" aria-label="Direct link to 3-通过http进行监控和管理" title="Direct link to 3-通过http进行监控和管理">​</a></h2>
<p>如果你正在开发一个Web应用程序，Spring Boot Actuator会自动配置所有启用的端点，使其通过HTTP公开。 默认的惯例是使用端点的 <code>id</code> 和 <code>/actuator</code> 的前缀作为URL路径。 例如，<code>health</code> 以 <code>/actuator/health</code> 的形式公开。</p>
<table><thead><tr><th></th><th>Actuator 支持 Spring MVC、Spring WebFlux和Jersey。 如果Jersey和Spring MVC都可用，则会使用Spring MVC。</th></tr></thead></table>
<table><thead><tr><th></th><th>为了获得API文档（ <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/htmlsingle" target="_blank" rel="noopener noreferrer">HTML</a> 或 <a href="https://docs.spring.io/spring-boot/docs/3.1.0-SNAPSHOT/actuator-api/pdf/spring-boot-actuator-web-api.pdf" target="_blank" rel="noopener noreferrer">PDF</a> ）中记载的正确的JSON响应，Jackson是一个必要的依赖。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="31-定制管理端点路径"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.customizing-management-server-context-path" target="_blank" rel="noopener noreferrer"></a>3.1. 定制管理端点路径<a href="#31-定制管理  端点路径" class="hash-link" aria-label="Direct link to 31-定制管理端点路径" title="Direct link to 31-定制管理端点路径">​</a></h3>
<p>有时，为管理端点定制前缀是很有用的。 例如，你的应用程序可能已经将 <code>/actuator</code> 用于其他目的。 你可以使用 <code>management.endpoints.web.base-path</code> 属性来改变管理端点的前缀，如下面的例子所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.base-path=/manage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>前面的 <code>application.properties</code> 例子将端点从 <code>/actuator/{id}</code> 改为 <code>/manage/{id}</code> （例如，<code>/manage/info</code>）。</p>
<table><thead><tr><th></th><th>除非管理端口被配置为<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.customizing-management-server-port" target="_blank" rel="noopener noreferrer">使用不同的HTTP端口</a>来暴露端点，否则 <code>management.endpoints.web.base-path</code> 是相对于 <code>server.servlet.context-path</code> （用于Servlet Web应用）或 <code>spring.webflux.base-path</code> （用于reactive Web应用）。如果配置了 <code>management.server.port</code>， <code>management.endpoints.web.base-path</code> 是相对于 <code>management.server.base-path</code> 的。</th></tr></thead></table>
<p>如果你想把端点映射到不同的路径，你可以使用 <code>management.endpoints.web.path-mapping</code> 属性。</p>
<p>下面的例子将 <code>/actuator/health</code> 重新映射为 <code>/healthcheck</code>。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.base-path=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.path-mapping.health=healthcheck</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="32-定制管理服务器端口"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.customizing-management-server-port" target="_blank" rel="noopener noreferrer"></a>3.2. 定制管理服务器端口<a href="#32-定制管理服务器端口" class="hash-link" aria-label="Direct link to 32-定制管理服务器端口" title="Direct link to 32-定制管理服务器端口">​</a></h3>
<p>对于基于云的部署来说，通过使用默认的HTTP端口来暴露管理端点是一个明智的选择。 然而，如果你的应用程序在你自己的数据中心内运行，你可能更喜欢使用不同的HTTP端口来暴露端点。</p>
<p>你可以设置 <code>management.server.port</code> 属性来改变HTTP端口，如下面的例子所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.server.port=8081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>在 Cloud Foundry 上，默认情况下，应用程序  仅在端口 8080 上接收 HTTP 和 TCP 路由的请求。 如果您想在 Cloud Foundry 上使用自定义管理端口，您需要明确设置应用程序的路由以将流量转发到自定义端口。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="33-配置针对management管理层的ssl"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.management-specific-ssl" target="_blank" rel="noopener noreferrer"></a>3.3. 配置针对Management（管理）层的SSL<a href="#33-配置针对management管理层的ssl" class="hash-link" aria-label="Direct link to 33-配置针对management管理层的ssl" title="Direct link to 33-配置针对management管理层的ssl">​</a></h3>
<p>当配置为使用自定义端口时，你也可以通过使用各种 <code>management.server.ssl.*</code> 属性来配置管理服务器的SSL。 例如，这样做可以让管理服务器通过HTTP提供服务，而主应用程序使用HTTPS，如以下属性设置所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">server.port=8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.key-store=classpath:store.jks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.key-password=secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.port=8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.ssl.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者，主服务器和管理服务器都可以使用SSL，但使用不同的密钥存储，如下所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">server.port=8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.key-store=classpath:main.jks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.ssl.key-password=secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.port=8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.ssl.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.ssl.key-store=classpath:management.jks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.ssl.key-password=secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="34-定制management管理服务器地址"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.customizing-management-server-address" target="_blank" rel="noopener noreferrer"></a>3.4. 定制Management（管理）服务器地址<a href="#34-定制management管理服务器地址" class="hash-link" aria-label="Direct link to 34-定制management管理服务器地址" title="Direct link to 34-定制management管理服务器地址">​</a></h3>
<p>你可以通过设置 <code>management.server.address</code> 性来定制管理端点的可用地址。 如果你想只在内部或面向运维的网络上监听，或者只监听来自 <code>localhost</code> 的连接，这样做会很有用。</p>
<table><thead><tr><th></th><th>只有当端口与主服务器端口不同时，你才能在不同的地址上进行监听。</th></tr></thead></table>
<p>下面的例子 <code>application.properties</code> 不允许远程管理连接。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.server.port=8081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.server.address=127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="35-禁用http端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.monitoring.disabling-http-endpoints" target="_blank" rel="noopener noreferrer"></a>3.5. 禁用HTTP端点<a href="#35-禁用http端点" class="hash-link" aria-label="Direct link to 35-禁用http端点" title="Direct link to 35-禁用http端点">​</a></h3>
<p>如果你不想通过HTTP暴露端点，你可以把管理端口设置为 <code>-1</code>，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.server.port=-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你也可以通过使用 <code>management.endpoints.web.exposure.exclude</code> 属性来实现，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.web.exposure.exclude=*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="4-通过jmx进行监控和管理"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.jmx" target="_blank" rel="noopener noreferrer"></a>4. 通过JMX进行监控和管理<a href="#4-通过jmx进行监控和管理" class="hash-link" aria-label="Direct link to 4-通过jmx进行监控和管理" title="Direct link to 4-通过jmx进行监控和管理">​</a></h2>
<p>Java管理扩展（JMX）提供了一个标准的机制来监控和管理应用程序。 默认情况下，该功能未被启用。 你可以通过设置 <code>spring.jmx.enabled</code> 配置属性为 <code>true</code> 来打开它。 Spring Boot将最合适的 <code>MBeanServer</code> 作为ID为 <code>mbeanServer</code> 的Bean公开。 你的任何带有Spring JMX注解的Bean（<code>@ManagedResource</code>、<code>@ManagedAttribute</code> 或 <code>@ManagedOperation</code>）都会暴露给它。</p>
<p>如果你的平台提供了一个标准的 <code>MBeanServer</code> ，Spring Boot会使用它，并在必要时默认为VM <code>MBeanServer</code>。 如果所有这些都失败了，就会创建一个新的 <code>MBeanServer</code>。</p>
<p>更多细节见 <a href="https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jmx/JmxAutoConfiguration.java" target="_blank" rel="noopener noreferrer"><code>JmxAutoConfiguration</code></a> 类。</p>
<p>默认情况下，Spring Boot也将管理端点作为JMX MBeans在 <code>org.springframework.boot</code> 域下公开。 要完全控制JMX域中的端点注册，可以考虑注册你自己的 <code>EndpointObjectNameFactory</code> 实现。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="41-自定义mbean名称"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.jmx.custom-mbean-names" target="_blank" rel="noopener noreferrer"></a>4.1. 自 定义MBean名称<a href="#41-自定义mbean名称" class="hash-link" aria-label="Direct link to 41-自定义mbean名称" title="Direct link to 41-自定义mbean名称">​</a></h3>
<p>MBean的名字通常由端点的 <code>id</code> 生成。 例如， <code>health</code> 端点被暴露为 <code>org.springframework.boot:type=Endpoint,name=Health</code>。</p>
<p>如果你的应用程序包含一个以上的Spring <code>ApplicationContext</code>，你可能会发现名字发生冲突。 为了解决这个问题，你可以将 <code>spring.jmx.unique-names</code> 属性设置为 <code>true</code>，这样MBean的名字就总是唯一的。</p>
<p>你还可以自定义暴露端点的JMX域。 下面的设置显示了在 <code>application.properties</code> 中这样做的一个例子。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">spring.jmx.unique-names=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.jmx.domain=com.example.myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="42-禁用jmx端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.jmx.disable-jmx-endpoints" target="_blank" rel="noopener noreferrer"></a>4.2. 禁用JMX端点<a href="#42-禁用jmx端点" class="hash-link" aria-label="Direct link to 42-禁用jmx端点" title="Direct link to 42-禁用jmx端点">​</a></h3>
<p>如果你不想通过JMX暴露端点，你可以把 <code>management.endpoints.jmx.exposure.exclude</code> 属性设置为 <code>*</code>，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.endpoints.jmx.exposure.exclude=*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="5-可观测性observability"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.observability" target="_blank" rel="noopener noreferrer"></a>5. 可观测性（Observability）<a href="#5-可观测性observability" class="hash-link" aria-label="Direct link to 5-可观测性observability" title="Direct link to 5-可观测性observability">​</a></h2>
<p>可观察性是指从外部观察一个运行中的系统的内部状态的能力。它由三个支柱组成：日志、度量和跟踪。</p>
<p>对于度量和跟踪，Spring Boot使用 <a href="https://micrometer.io/docs/observation" target="_blank" rel="noopener noreferrer">Micrometer Observation</a>。要创建你自己的观察（这将导致度量和跟踪），你可以注入一个 <code>ObservationRegistry</code>。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyCustomObservation {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final ObservationRegistry observationRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MyCustomObservation(ObservationRegistry observationRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.observationRegistry = observationRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void doSomething() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Observation.createNotStarted(&quot;doSomething&quot;, this.observationRegistry)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .lowCardinalityKeyValue(&quot;locale&quot;, &quot;en-US&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .highCardinalityKeyValue(&quot;userId&quot;, &quot;42&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .observe(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Execute business logic here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>低卡度的标签将被添加到指标和追踪中，而高卡度的标签将只被添加到追踪中。</th></tr></thead></table>
<p><code>ObservationPredicate</code>、<code>GlobalObservationConvention</code> 和 <code>ObservationHandler</code> 类型的 Bean 将被自动注册到 <code>ObservationRegistry</code> 上。你可以另外注册任意数量的 <code>ObservationRegistryCustomizer</code> Bean来进一步配置注册表。</p>
<p>更多细节请见 <a href="https://micrometer.io/docs/observation" target="_blank" rel="noopener noreferrer">Micrometer Observation 文档</a>。</p>
<table><thead><tr><th></th><th>JDBC和R2DBC的可观察性（Observability）可以使用单独的项目进行配置。对于 JDBC， <a href="https://github.com/jdbc-observations/datasource-micrometer" target="_blank" rel="noopener noreferrer">Datasource Micrometer 项目</a> 提供了一个 Spring Boot Starter，在调用JDBC操作时自动创建观察。在 <a href="https://jdbc-observations.github.io/datasource-micrometer/docs/current/docs/html/" target="_blank" rel="noopener noreferrer">参考文档</a>中阅读更多关于它的信息。对于R2DBC， <a href="https://github.com/spring-projects-experimental/r2dbc-micrometer-spring-boot" target="_blank" rel="noopener noreferrer">R2DBC观察的Spring Boot自动配置</a> 可以为R2DBC查询调用创建观察。</th></tr></thead></table>
<p>接下来的章节将提供关于日志、指标和追踪的更多细节。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="6-日志记录器logger"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.loggers" target="_blank" rel="noopener noreferrer"></a>6. 日志记录器（Logger）<a href="#6-日志记录器logger" class="hash-link" aria-label="Direct link to 6-日志记录器logger" title="Direct link to 6-日志记录器logger">​</a></h2>
<p>Spring Boot Actuator包括在运行时查看和配置应用程序的日志级别的功能。   你可以查看整个列表或单个日志记录器的配置，它由明确配置的日志级别以及日志框架赋予它的有效日志级别组成。 这些级别可以是以下之一。</p>
<ul>
<li>
<p><code>TRACE</code></p>
</li>
<li>
<p><code>DEBUG</code></p>
</li>
<li>
<p><code>INFO</code></p>
</li>
<li>
<p><code>WARN</code></p>
</li>
<li>
<p><code>ERROR</code></p>
</li>
<li>
<p><code>FATAL</code></p>
</li>
<li>
<p><code>OFF</code></p>
</li>
<li>
<p><code>null</code></p>
</li>
</ul>
<p><code>null</code> 表示没有明确的配置。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="61-配置一个-logger"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.loggers.configure" target="_blank" rel="noopener noreferrer"></a>6.1. 配置一个 Logger<a href="#61-配置一个-logger" class="hash-link" aria-label="Direct link to 61-配置一个-logger" title="Direct link to 61-配置一个-logger">​</a></h3>
<p>要配置一个给定的记录器，<code>POST</code> 一个部分实体到资源的URI，如下面的例子所示。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;configuredLevel&quot;: &quot;DEBUG&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>要 “reset” （重置）记录器的特定级别（并使用默认配置），你可以传递一个 <code>null</code> 的值作为 <code>configuredLevel</code>。</th></tr></thead></table>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="7-指标metrics"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics" target="_blank" rel="noopener noreferrer"></a>7. 指标（Metrics）<a href="#7-指标metrics" class="hash-link" aria-label="Direct link to 7-指标metrics" title="Direct link to 7-指标metrics">​</a></h2>
<p>Spring Boot Actuator为 <a href="https://micrometer.io/" target="_blank" rel="noopener noreferrer">Micrometer</a> 提供了依赖管理和自动配置，Micrometer是一个支持 <a href="https://micrometer.io/docs" target="_blank" rel="noopener noreferrer">众多监控系统</a> 的应用程序指标接口，包括。</p>
<ul>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.appoptics" target="_blank" rel="noopener noreferrer">AppOptics</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.atlas" target="_blank" rel="noopener noreferrer">Atlas</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.datadog" target="_blank" rel="noopener noreferrer">Datadog</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace" target="_blank" rel="noopener noreferrer">Dynatrace</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.elastic" target="_blank" rel="noopener noreferrer">Elastic</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.ganglia" target="_blank" rel="noopener noreferrer">Ganglia</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.graphite" target="_blank" rel="noopener noreferrer">Graphite</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.humio" target="_blank" rel="noopener noreferrer">Humio</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.influx" target="_blank" rel="noopener noreferrer">Influx</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.jmx" target="_blank" rel="noopener noreferrer">JMX</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.kairos" target="_blank" rel="noopener noreferrer">KairosDB</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.newrelic" target="_blank" rel="noopener noreferrer">New Relic</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.otlp" target="_blank" rel="noopener noreferrer">OpenTelemetry</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.prometheus" target="_blank" rel="noopener noreferrer">Prometheus</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.signalfx" target="_blank" rel="noopener noreferrer">SignalFx</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.simple" target="_blank" rel="noopener noreferrer">Simple (in-memory)</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.stackdriver" target="_blank" rel="noopener noreferrer">Stackdriver</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.statsd" target="_blank" rel="noopener noreferrer">StatsD</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.wavefront" target="_blank" rel="noopener noreferrer">Wavefront</a></p>
</li>
</ul>
<table><thead><tr><th></th><th>要了解更多关于Micrometer的功能，请参见其 <a href="https://micrometer.io/docs" target="_blank" rel="noopener noreferrer">参考文档</a>，特别是 <a href="https://micrometer.io/docs/concepts" target="_blank" rel="noopener noreferrer">概念部分</a>。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="71-入门"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.getting-started" target="_blank" rel="noopener noreferrer"></a>7.1. 入门<a href="#71-入门" class="hash-link" aria-label="Direct link to 71-入门" title="Direct link to 71-入门">​</a></h3>
<p>Spring Boot会自动配置一个复合的 <code>MeterRegistry</code>，并为它在classpath上发现的每个支持的实现添加一个注册表。 在你的运行时classpath中有对 <code>micrometer-registry-{system}</code> 的依赖就足以让Spring Boot配置注册表了。</p>
<p>大多数注册表有共同的特点。 例如，即使 Micrometer 注册表的实现在classpath上，你也可以禁用一个特定的注册表。 下面的例子禁用了Datadog。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你也可以禁用所有的注册表，除非注册表特定属性另有说明，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.defaults.metrics.export.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spring Boot还将任何自动配置的注册表添加到 <code>Metrics</code> 类上的全局静态复合注册表，除非你明确告诉它不要这样做。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.use-global-registry=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以注册任意数量的 <code>MeterRegistryCustomizer</code> Bean来进一步配置注册表，比如在任何表被注册之前应用普通标签。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyMeterRegistryConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MeterRegistryCustomizer&lt;MeterRegistry&gt; metricsCommonTags() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (registry) -&gt; registry.config().commonTags(&quot;region&quot;, &quot;us-east-1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以通过更具体的泛型将定制应用于特定的注册表实现。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyMeterRegistryConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MeterRegistryCustomizer&lt;GraphiteMeterRegistry&gt; graphiteMetricsNamingConvention() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (registry) -&gt; registry.config().namingConvention(this::name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String name(String name, Meter.Type type, String baseUnit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spring Boot还 <a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported" target="_blank" rel="noopener noreferrer">配置了内置 instrumentation</a>，你可以通过配置或专用注解标记来控制。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="72-支持的监控系统"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export" target="_blank" rel="noopener noreferrer"></a>7.2. 支持的监控系统<a href="#72-支持的监控系统" class="hash-link" aria-label="Direct link to 72-支持的监控系统" title="Direct link to 72-支持的监控系统">​</a></h3>
<p>本节简要介绍每个支持的监控系统。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="721-appoptics"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.appoptics" target="_blank" rel="noopener noreferrer"></a>7.2.1. AppOptics<a href="#721-appoptics" class="hash-link" aria-label="Direct link to 721-appoptics" title="Direct link to 721-appoptics">​</a></h4>
<p>默认情况下，AppOptics注册中心会定期将指标推送到 <code>[api.appoptics.com/v1/measurements](https://api.appoptics.com/v1/measurements)</code>。要将指标导出到 SaaS <a href="https://micrometer.io/docs/registry/appOptics" target="_blank" rel="noopener noreferrer">AppOptics</a>，必须提供你的API令牌。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.appoptics.metrics.export.api-token=YOUR_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="722-atlas"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.atlas" target="_blank" rel="noopener noreferrer"></a>7.2.2. Atlas<a href="#722-atlas" class="hash-link" aria-label="Direct link to 722-atlas" title="Direct link to 722-atlas">​</a></h4>
<p>默认情况下，指标会被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/atlas" target="_blank" rel="noopener noreferrer">Atlas</a>。你可以提供 <a href="https://github.com/Netflix/atlas" target="_blank" rel="noopener noreferrer">Atlas server</a> 的位置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.atlas.metrics.export.uri=https://atlas.example.com:7101/api/v1/publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="723-datadog"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.datadog" target="_blank" rel="noopener noreferrer"></a>7.2.3. Datadog<a href="#723-datadog" class="hash-link" aria-label="Direct link to 723-datadog" title="Direct link to 723-datadog">​</a></h4>
<p>一个Datadog注册中心会定期将指标推送到 <a href="https://www.datadoghq.com/" target="_blank" rel="noopener noreferrer">datadoghq</a>。 要导出指标到 <a href="https://micrometer.io/docs/registry/datadog" target="_blank" rel="noopener noreferrer">Datadog</a>，你必须提供你的API密钥。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.api-key=YOUR_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果你另外提供一个应用密钥（可选），那么元数据，如仪表描述、类型和基本单位也将被导出。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.api-key=YOUR_API_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.application-key=YOUR_APPLICATION_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认情况下，指标被发送到Datadog美国 <a href="https://docs.datadoghq.com/getting_started/site" target="_blank" rel="noopener noreferrer">site</a> （<code>[api.datadoghq.com](https://api.datadoghq.com/)</code>）。 如果你的Datadog项目托管在其他网站上，或者你需要通过代理发送指标，请相应配置URI。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.uri=https://api.datadoghq.eu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你还可以改变向Datadog发送指标的时间间隔。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.datadog.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="724-dynatrace"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace" target="_blank" rel="noopener noreferrer"></a>7.2.4. Dynatrace<a href="#724-dynatrace" class="hash-link" aria-label="Direct link to 724-dynatrace" title="Direct link to 724-dynatrace">​</a></h4>
<p>Dynatrace提供了两个指标摄取API，都是为 <a href="https://micrometer.io/docs/registry/dynatrace" target="_blank" rel="noopener noreferrer">Micrometer</a> 实现的。你可以在 <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer" target="_blank" rel="noopener noreferrer">这里</a> 找到Dynatrace关于Micrometer指标摄入的文档。<code>v1</code> 命名空间中的配置属性只适用于导出到 <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v1/" target="_blank" rel="noopener noreferrer">Timeseries v1 API</a> 时。<code>v2</code> 命名空间中的配置属性只适用于导出到 <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v2/post-ingest-metrics/" target="_blank" rel="noopener noreferrer">Metrics v2 API</a> 时。请注意，该集成每次只能导出到API的 <code>v1</code> 或 <code>v2</code> 版本，<code>v2</code> 版本是首选。如果 <code>device-id</code>（v1版需要，但在v2版中不使用）在 <code>v1</code> 版命名空间中被设置，那么metric将被导出到 <code>v1</code> 版端点。否则，就假定是 <code>v2</code> 版本。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="v2-api"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace.v2-api" target="_blank" rel="noopener noreferrer"></a>v2 API<a href="#v2-api" class="hash-link" aria-label="Direct link to v2-api" title="Direct link to v2-api">​</a></h5>
<p>你可以通过两种方式使用v2 API。</p>
<h6 class="anchor anchorWithStickyNavbar_HWLp" id="自动配置"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace.v2-api.auto-config" target="_blank" rel="noopener noreferrer"></a>自动配置<a href="#自动配置" class="hash-link" aria-label="Direct link to 自动配置" title="Direct link to 自动配置">​</a></h6>
<p>Dynatrace自动配置适用于由OneAgent或Dynatrace Operator for Kubernetes监控的主机。</p>
<p>**本地OneAgent：**如果主机上运行OneAgent，指标会自动输出到 <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/local-api/" target="_blank" rel="noopener noreferrer">local OneAgent ingest endpoint</a> 。 摄取端点将指标转发到Dynatrace后端。</p>
<p>**Dynatrace Kubernetes Operator：**在安装了Dynatrace Operator的Kubernetes中运行时，注册表将自动从操作员那里获取你的端点URI和API令牌。</p>
<p>这是默认行为，除了依赖 <code>io.micrometer:micrometer-registry-dynatrace</code> 之外，不需要特别的设置。</p>
<h6 class="anchor anchorWithStickyNavbar_HWLp" id="手动配置"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace.v2-api.manual-config" target="_blank" rel="noopener noreferrer"></a>手动配置<a href="#手动配置" class="hash-link" aria-label="Direct link to 手动配置" title="Direct link to 手动配置">​</a></h6>
<p>如果没有自动配置，则需要 <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v2/post-ingest-metrics/" target="_blank" rel="noopener noreferrer">Metrics v2 API</a> 的端点和一个 API 令牌。API令牌必须有 “Ingest metrics” （<code>metrics.ingest</code>）的权限设置。我们建议将令牌的范围限制在这一个权限上。你必须确保端点URI包含路径（例如，<code>/api/v2/metrics/ingest</code>）。</p>
<p>Metrics API v2摄取端点的URL根据你的部署选项而不同。</p>
<ul>
<li>
<p>SaaS: <code>https://{your-environment-id}.live.dynatrace.com/api/v2/metrics/ingest</code></p>
</li>
<li>
<p>Managed deployments: <code>https://{your-domain}/e/{your-environment-id}/api/v2/metrics/ingest</code></p>
</li>
</ul>
<p>下面的例子是用 <code>example</code> environment id 配置度量值导出。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.uri=https://example.live.dynatrace.com/api/v2/metrics/ingest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.api-token=YOUR_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在使用Dynatrace v2 API时，可以使用以下可选功能（更多细节可在 <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer#dt-configuration-properties" target="_blank" rel="noopener noreferrer">Dynatrace文档</a> 中找到）。</p>
<ul>
<li>
<p>Metric key 的前缀。设置一个前缀，该前缀将被添加到所有导出的metric key中。</p>
</li>
<li>
<p>用Dynatrace元数据来充实。如果OneAgent或Dynatrace操作员正在运行，用额外的元数据（例如，关于主机、进程或Pod）来丰富指标。</p>
</li>
<li>
<p>默认维度。指定添加到所有导出度量的键值对。 如果用Micrometer指定了具有相同键的标签，它们将覆盖默认dimension。</p>
</li>
<li>
<p>使用Dynatrace Summary instrument。在某些情况下，Micrometer Dynatrace注册表创建的指标被拒绝。 在Micrometer 1.9.x中，通过引入Dynatrace特定的摘要工具来解决这个问题。 把这个开关设置为 <code>false</code> 会迫使Micrometer回到1.9.x之前的默认行为。 只有在从Micrometer 1.8.x迁移到1.9.x时遇到问题时才可以使用。</p>
</li>
</ul>
<p>可以不指定URI和API令牌，如以下例子所示。 在这种情况下，会使用自动配置的端点。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v2.metric-key-prefix=your.key.prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v2.enrich-with-dynatrace-metadata=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v2.default-dimensions.key1=value1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v2.default-dimensions.key2=value2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v2.use-dynatrace-summary-instruments=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="v1-api-legacy"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace.v1-api" target="_blank" rel="noopener noreferrer"></a>v1 API (Legacy)<a href="#v1-api-legacy" class="hash-link" aria-label="Direct link to v1-api-legacy" title="Direct link to v1-api-legacy">​</a></h5>
<p>Dynatrace v1 API指标注册表通过使用 <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v1/" target="_blank" rel="noopener noreferrer">Timeseries v1 API</a> 定期将指标推送到配置的URI。 为了向后兼容现有的设置，当 <code>device-id</code> 被设置时（v1需要，但在v2中不使用），指标被导出到Timeseries v1端点。 要向 <a href="https://micrometer.io/docs/registry/dynatrace" target="_blank" rel="noopener noreferrer">Dynatrace</a> 导出指标，必须提供你的API令牌、设备ID和URI。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.uri=https://{your-environment-id}.live.dynatrace.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.api-token=YOUR_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.v1.device-id=YOUR_DEVICE_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对于v1版API，你必须指定基本环境URI，而不指定路径，因为v1版的端点路径会自动添加。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="与版本无关的设置"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.dynatrace.version-independent-settings" target="_blank" rel="noopener noreferrer"></a>与版本无关的设置<a href="#与版本无关的设置" class="hash-link" aria-label="Direct link to 与版本无关的设置" title="Direct link to 与版本无关的设置">​</a></h5>
<p>除了API端点和令牌外，你还可以改变向Dynatrace发送指标的间隔时间。 默认的导出时间间隔是 <code>60s</code>。 下面的例子将导出时间间隔设置为30秒。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.dynatrace.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以在 <a href="https://micrometer.io/docs/registry/dynatrace" target="_blank" rel="noopener noreferrer">Micrometer文档</a> 和 <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer" target="_blank" rel="noopener noreferrer">Dynatrace文档</a>  中找到关于如何为Micrometer设置Dynatrace exporter（导出器）的更多信息。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="725-elastic"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.elastic" target="_blank" rel="noopener noreferrer"></a>7.2.5. Elastic<a href="#725-elastic" class="hash-link" aria-label="Direct link to 725-elastic" title="Direct link to 725-elastic">​</a></h4>
<p>默认情况下，指标被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/elastic" target="_blank" rel="noopener noreferrer">Elastic</a> 。 你可以通过使用以下属性提供要使用的Elastic服务器的位置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.elastic.metrics.export.host=https://elastic.example.com:8086</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="726-ganglia"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.ganglia" target="_blank" rel="noopener noreferrer"></a>7.2.6. Ganglia<a href="#726-ganglia" class="hash-link" aria-label="Direct link to 726-ganglia" title="Direct link to 726-ganglia">​</a></h4>
<p>默认情况下，指标被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/ganglia" target="_blank" rel="noopener noreferrer">Ganglia</a> 。你可以提供 <a href="http://ganglia.sourceforge.net/" target="_blank" rel="noopener noreferrer">Ganglia server</a> 的主机和端口，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.ganglia.metrics.export.host=ganglia.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.ganglia.metrics.export.port=9649</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="727-graphite"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.graphite" target="_blank" rel="noopener noreferrer"></a>7.2.7. Graphite<a href="#727-graphite" class="hash-link" aria-label="Direct link to 727-graphite" title="Direct link to 727-graphite">​</a></h4>
<p>默认情况下，指标会被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/graphite" target="_blank" rel="noopener noreferrer">Graphite</a> 。你可以提供 <a href="https://graphiteapp.org/" target="_blank" rel="noopener noreferrer">Graphite server</a> 的主机和端口，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.graphite.metrics.export.host=graphite.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.graphite.metrics.export.port=9004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Micrometer提供了一个默认的 <code>HierarchicalNameMapper</code>，管理dimensional meter ID如何<a href="https://micrometer.io/docs/registry/graphite#_hierarchical_name_mapping%5B%E6%98%A0%E5%B0%84%E5%88%B0" target="_blank" rel="noopener noreferrer">https://micrometer.io/docs/registry/graphite#_hierarchical_name_mapping[映射到</a> flat hierarchical name]。</p>
<table><thead><tr><th></th><th>要控制这种行为，请定义你的 <code>GraphiteMeterRegistry</code> 并提供你自己的 <code>HierarchicalNameMapper</code>。 除非你自己定义，否则会提供一个自动配置的 <code>GraphiteConfig</code> 和 <code>Clock</code> Bean。JavaKotlin<code>@Configuration(proxyBeanMethods = false)public class MyGraphiteConfiguration {    @Bean    public GraphiteMeterRegistry graphiteMeterRegistry(GraphiteConfig config, Clock clock) {        return new GraphiteMeterRegistry(config, clock, this::toHierarchicalName);    }    private String toHierarchicalName(Meter.Id id, NamingConvention convention) {        return ...    }}</code></th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="728-humio"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.humio" target="_blank" rel="noopener noreferrer"></a>7.2.8. Humio<a href="#728-humio" class="hash-link" aria-label="Direct link to 728-humio" title="Direct link to 728-humio">​</a></h4>
<p>默认情况下，Humio注册中心会定期将指标推送到 <a href="https://cloud.humio.com/" target="_blank" rel="noopener noreferrer">cloud.humio.com</a> 。 要将指标导出到SaaS <a href="https://micrometer.io/docs/registry/humio" target="_blank" rel="noopener noreferrer">Humio</a>，你必须提供你的API令牌。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.humio.metrics.export.api-token=YOUR_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你还应该配置一个或多个标签，以确定推送指标的数据源。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.humio.metrics.export.tags.alpha=a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.humio.metrics.export.tags.bravo=b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="729-influx"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.influx" target="_blank" rel="noopener noreferrer"></a>7.2.9. Influx<a href="#729-influx" class="hash-link" aria-label="Direct link to 729-influx" title="Direct link to 729-influx">​</a></h4>
<p>默认情况下，指标会被导出到运行在本地机器上的 <a href="https://micrometer.io/docs/registry/influx" target="_blank" rel="noopener noreferrer">Influx</a> v1实例，并采用默认配置。要导出指标到InfluxDB v2，请配置 <code>org</code>、<code>bucket</code> 和用于写入指标的authentication <code>token</code>。你可以通过以下方式提供要使用的 <a href="https://www.influxdata.com/" target="_blank" rel="noopener noreferrer">Influx server</a> 的位置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.influx.metrics.export.uri=https://influx.example.com:8086</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7210-jmx"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.jmx" target="_blank" rel="noopener noreferrer"></a>7.2.10. JMX<a href="#7210-jmx" class="hash-link" aria-label="Direct link to 7210-jmx" title="Direct link to 7210-jmx">​</a></h4>
<p>Micrometer提供了对 <a href="https://micrometer.io/docs/registry/jmx" target="_blank" rel="noopener noreferrer">JMX</a> 的分层映射，主要是作为一种廉价和可移植的方式来查看本地的度量。 默认情况下，指标被导出到 <code>metrics</code> JMX域。 你可以通过以下方式提供要使用的域。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.jmx.metrics.export.domain=com.example.app.metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Micrometer提供了一个默认的 <code>HierarchicalNameMapper</code>，管理dimensional meter ID 如何 <a href="https://micrometer.io/docs/registry/jmx#_hierarchical_name_mapping" target="_blank" rel="noopener noreferrer">映射到 flat hierarchical name</a>。</p>
<table><thead><tr><th></th><th>要控制这种行为，请定义你的 <code>JmxMeterRegistry</code> 并提供你自己的 <code>HierarchicalNameMapper</code>。 除非你自己定义，否则会提供一个自动配置的 <code>JmxConfig</code> 和 <code>Clock</code> Bean。JavaKotlin<code>@Configuration(proxyBeanMethods = false)public class MyJmxConfiguration {    @Bean    public JmxMeterRegistry jmxMeterRegistry(JmxConfig config, Clock clock) {        return new JmxMeterRegistry(config, clock, this::toHierarchicalName);    }    private String toHierarchicalName(Meter.Id id, NamingConvention convention) {        return ...    }}</code></th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7211-kairosdb"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.kairos" target="_blank" rel="noopener noreferrer"></a>7.2.11. KairosDB<a href="#7211-kairosdb" class="hash-link" aria-label="Direct link to 7211-kairosdb" title="Direct link to 7211-kairosdb">​</a></h4>
<p>默认情况下，指标被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/kairos" target="_blank" rel="noopener noreferrer">KairosDB</a> 。你可以通过以下方式提供要使用的 <a href="https://kairosdb.github.io/" target="_blank" rel="noopener noreferrer">KairosDB server</a> 的位置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.kairos.metrics.export.uri=https://kairosdb.example.com:8080/api/v1/datapoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7212-new-relic"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.newrelic" target="_blank" rel="noopener noreferrer"></a>7.2.12. New Relic<a href="#7212-new-relic" class="hash-link" aria-label="Direct link to 7212-new-relic" title="Direct link to 7212-new-relic">​</a></h4>
<p>New Relic注册中心会定期将指标推送到 <a href="https://micrometer.io/docs/registry/new-relic" target="_blank" rel="noopener noreferrer">New Relic</a>。要导出指标到 <a href="https://newrelic.com/" target="_blank" rel="noopener noreferrer">New Relic</a>，你必须提供你的API密钥和账户ID。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.newrelic.metrics.export.api-key=YOUR_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.newrelic.metrics.export.account-id=YOUR_ACCOUNT_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你还可以改变向New Relic发送指标的时间间隔。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.newrelic.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认情况下，指标是通过REST调用发布的，但如果你在classpath上有Java Agent API，你也可以使用它。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.newrelic.metrics.export.client-provider-type=insights-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最后，你可以通过定义你自己的 <code>NewRelicClientProvider</code> 豆来完全控制。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7213-opentelemetry"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.otlp" target="_blank" rel="noopener noreferrer"></a>7.2.13. OpenTelemetry<a href="#7213-opentelemetry" class="hash-link" aria-label="Direct link to 7213-opentelemetry" title="Direct link to 7213-opentelemetry">​</a></h4>
<p>默认情况下，指标被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/otlp" target="_blank" rel="noopener noreferrer">OpenTelemetry</a> 。你可以通过以下方式提供要使用的 <a href="https://opentelemetry.io/" target="_blank" rel="noopener noreferrer">OpenTelemtry metric endpoint</a> 的位置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.otlp.metrics.export.url=https://otlp.example.com:4318/v1/metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7214-prometheus"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.prometheus" target="_blank" rel="noopener noreferrer"></a>7.2.14. Prometheus<a href="#7214-prometheus" class="hash-link" aria-label="Direct link to 7214-prometheus" title="Direct link to 7214-prometheus">​</a></h4>
<p><a href="https://micrometer.io/docs/registry/prometheus" target="_blank" rel="noopener noreferrer">Prometheus</a> 希望scrape或轮询单个应用程序实例的指标。Spring Boot在 <code>/actuator/prometheus</code> 提供了一个actuator端点，以便以适当的格式呈现 <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus scrape</a>。</p>
<table><thead><tr><th></th><th>默认情况下，该端点是不可用的，必须被暴露。更多细节请参见<a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.exposing" target="_blank" rel="noopener noreferrer">暴露端点</a>。</th></tr></thead></table>
<p>下面的例子 <code>scrape_config</code> 添加到 <code>prometheus.yml</code>。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">scrape_configs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - job_name: &quot;spring&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics_path: &quot;/actuator/prometheus&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static_configs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - targets: [&quot;HOST:PORT&quot;]</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>也支持 <a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#exemplars-storage" target="_blank" rel="noopener noreferrer">Prometheus Exemplars</a>。要启用这个功能，应该有一个 <code>SpanContextSupplier</code> Bean。如果你使用 <a href="https://micrometer.io/docs/tracing" target="_blank" rel="noopener noreferrer">Micrometer Tracing</a>，这将为你自动配置，但如果你想，你总是可以创建自己的。请查看 <a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#exemplars-storage" target="_blank" rel="noopener noreferrer">Prometheus 文档</a> ，因为这个功能需要在Prometheus这边明确启用，而且只支持使用 <a href="https://github.com/OpenObservability/OpenMetrics/blob/v1.0.0/specification/OpenMetrics.md#exemplars" target="_blank" rel="noopener noreferrer">OpenMetrics</a> 格式。</p>
<p>对于短暂的或批处理的作业，可能存在的时间不够长，无法被刮取，你可以使用 <a href="https://github.com/prometheus/pushgateway" target="_blank" rel="noopener noreferrer">Prometheus Pushgateway</a> 支持，将指标暴露给Prometheus。要启用Prometheus Pushgateway支持，请在你的项目中添加以下依赖。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    simpleclient_pushgateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当Prometheus Pushgateway的依赖出现在classpath上，并且 <code>management.prometheus.metrics.export.pushgateway.enabled</code> 属性被设置为 <code>true</code> 时，一个 <code>PrometheusPushGatewayManager</code> bean就被自动配置了。 它负责管理向Prometheus Pushgateway推送指标的工作。</p>
<p>你可以通过使用 <code>management.prometheus.metrics.export.pushgateway</code> 下的属性来调整 <code>PrometheusPushGatewayManager</code>。 对于高级配置，你也可以提供你自己的 <code>PrometheusPushGatewayManager</code> bean。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7215-signalfx"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.signalfx" target="_blank" rel="noopener noreferrer"></a>7.2.15. SignalFx<a href="#7215-signalfx" class="hash-link" aria-label="Direct link to 7215-signalfx" title="Direct link to 7215-signalfx">​</a></h4>
<p>SignalFx注册中心会定期将指标推送到 <a href="https://micrometer.io/docs/registry/signalFx" target="_blank" rel="noopener noreferrer">SignalFx</a>。要导出指标到 <a href="https://www.signalfx.com/" target="_blank" rel="noopener noreferrer">SignalFx</a>，你必须提供你的access token。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.signalfx.metrics.export.access-token=YOUR_ACCESS_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你也可以改变向SignalFx发送指标的时间间隔。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.signalfx.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7216-simple"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.simple" target="_blank" rel="noopener noreferrer"></a>7.2.16. Simple<a href="#7216-simple" class="hash-link" aria-label="Direct link to 7216-simple" title="Direct link to 7216-simple">​</a></h4>
<p>Micrometer提供了一个简单的、内存中的后端，如果没有配置其他注册表，该后端会自动作为备用。这可以让你看到在 <a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.endpoint" target="_blank" rel="noopener noreferrer">metrics endpoint</a> 中收集了哪些度量。</p>
<p>一旦你使用任何其他可用的后端，内存中的后端就会自动关闭。你也可以明确地禁用它。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.simple.metrics.export.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7217-stackdriver"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.stackdriver" target="_blank" rel="noopener noreferrer"></a>7.2.17. Stackdriver<a href="#7217-stackdriver" class="hash-link" aria-label="Direct link to 7217-stackdriver" title="Direct link to 7217-stackdriver">​</a></h4>
<p>Stackdriver注册中心会定期向 <a href="https://cloud.google.com/stackdriver/" target="_blank" rel="noopener noreferrer">Stackdriver</a> 推送指标。要导出指标到SaaS <a href="https://micrometer.io/docs/registry/stackdriver" target="_blank" rel="noopener noreferrer">Stackdriver</a>，你必须提供你的Google Cloud project ID。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.stackdriver.metrics.export.project-id=my-project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你还可以改变向Stackdriver发送指标的时间间隔。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.stackdriver.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7218-statsd"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.statsd" target="_blank" rel="noopener noreferrer"></a>7.2.18. StatsD<a href="#7218-statsd" class="hash-link" aria-label="Direct link to 7218-statsd" title="Direct link to 7218-statsd">​</a></h4>
<p>StatsD注册表急切地将指标通过UDP推送给StatsD agent。默认情况下，指标被导出到运行在你本地机器上的 <a href="https://micrometer.io/docs/registry/statsD" target="_blank" rel="noopener noreferrer">StatsD</a> agent。你可以通过以下方式提供StatsD代理的主机、端口和协议，以便使用。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.statsd.metrics.export.host=statsd.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.statsd.metrics.export.port=9125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.statsd.metrics.export.protocol=udp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你还可以改变要使用的StatsD线路协议（默认为Datadog）。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.statsd.metrics.export.flavor=etsy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7219-wavefront"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.export.wavefront" target="_blank" rel="noopener noreferrer"></a>7.2.19. Wavefront<a href="#7219-wavefront" class="hash-link" aria-label="Direct link to 7219-wavefront" title="Direct link to 7219-wavefront">​</a></h4>
<p>Wavefront注册表定期将指标推送到 <a href="https://micrometer.io/docs/registry/wavefront" target="_blank" rel="noopener noreferrer">Wavefront</a>。如果你直接将指标导出到 <a href="https://www.wavefront.com/" target="_blank" rel="noopener noreferrer">Wavefront</a>，你必须提供你的API token。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.wavefront.api-token=YOUR_API_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>另外，您可以在您的环境中使用Wavefront sidecar或内部代理来转发指标数据到Wavefront API主机。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.wavefront.uri=proxy://localhost:2878</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果您将指标发布到Wavefront代理（如 <a href="https://docs.wavefront.com/proxies_installing.html" target="_blank" rel="noopener noreferrer">Wavefront文档</a> 中所述），主机必须是 <code>proxy://HOST:PORT</code> 格式。</p>
<p>你也可以改变向Wavefront发送指标的时间间隔。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.wavefront.metrics.export.step=30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="73-支持的指标-metric和度量meter"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported" target="_blank" rel="noopener noreferrer"></a>7.3. 支持的指标 （Metric）和度量（Meter）<a href="#73-支持的指标-metric和度量meter" class="hash-link" aria-label="Direct link to 73-支持的指标-metric和度量meter" title="Direct link to 73-支持的指标-metric和度量meter">​</a></h3>
<p>Spring Boot为各种各样的技术提供了自动计量器注册。 在大多数情况下，默认值提供了合理的指标，可以发布到任何支持的监控系统中。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="731-jvm指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.jvm" target="_blank" rel="noopener noreferrer"></a>7.3.1. JVM指标<a href="#731-jvm指标" class="hash-link" aria-label="Direct link to 731-jvm指标" title="Direct link to 731-jvm指标">​</a></h4>
<p>自动配置通过使用核心 Micrometer 类启用JVM度量。 JVM指标在 <code>jvm.</code> meter name 下发布。</p>
<p>提供以下JVM指标。</p>
<ul>
<li>
<p>各种内存和缓冲池细节</p>
</li>
<li>
<p>与垃圾收集有关的统计数据</p>
</li>
<li>
<p>线程利用率</p>
</li>
<li>
<p>加载和卸载的类的数量</p>
</li>
<li>
<p>JVM的版本信息</p>
</li>
<li>
<p>JIT 编译时间</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="732-系统指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.system" target="_blank" rel="noopener noreferrer"></a>7.3.2. 系统指标<a href="#732-系统指标" class="hash-link" aria-label="Direct link to 732-系统指标" title="Direct link to 732-系统指标">​</a></h4>
<p>自动配置通过使用核心Micrometer类来实现系统度量。 系统指标在 <code>system.</code>、<code>process.</code> 和 <code>disk.</code> meter 名下发布。</p>
<p>提供以下系统指标。</p>
<ul>
<li>
<p>CPU指标</p>
</li>
<li>
<p>文件描述符指标</p>
</li>
<li>
<p>正常运行时间指标（包括应用程序已经运行的时间和绝对启动时间的固定测量）。</p>
</li>
<li>
<p>可用的磁盘空间</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="733-应用程序启动指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.application-startup" target="_blank" rel="noopener noreferrer"></a>7.3.3. 应用程序启动指标<a href="#733-应用程序启动指标" class="hash-link" aria-label="Direct link to 733-应用程序启动指标" title="Direct link to 733-应用程序启动指标">​</a></h4>
<p>自动配置暴露了应用程序的启动时间指标。</p>
<ul>
<li>
<p><code>application.started.time</code>: 启动应用程序的时间。</p>
</li>
<li>
<p><code>application.ready.time</code>：应用程序准备好为请求提供服务所需的时间。</p>
</li>
</ul>
<p>指标是由应用类的完全名称来标记的。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="734-日志记录器指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.logger" target="_blank" rel="noopener noreferrer"></a>7.3.4. 日志记录器指标<a href="#734-日志记录器指标" class="hash-link" aria-label="Direct link to 734-日志记录器指标" title="Direct link to 734-日志记录器指标">​</a></h4>
<p>自动配置启用了Logback和Log4J2的事件度量。 细节在 <code>log4j2.events.</code> 或 <code>logback.events.</code> meter名下公布。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="735-任务执行和调度指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.tasks" target="_blank" rel="noopener noreferrer"></a>7.3.5. 任务执行和调度指标<a href="#735-任务执行和调度指标" class="hash-link" aria-label="Direct link to 735-任务执行和调度指标" title="Direct link to 735-任务执行和调度指标">​</a></h4>
<p>自动配置使所有可用的 <code>ThreadPoolTaskExecutor</code> 和 <code>ThreadPoolTaskScheduler</code> Bean都能被测量，只要底层的 <code>ThreadPoolExecutor</code> 可用。 指标由executor的名称来标记，executor的名称来自于Bean的名称。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="736-spring-mvc-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.spring-mvc" target="_blank" rel="noopener noreferrer"></a>7.3.6. Spring MVC 指标<a href="#736-spring-mvc-指标" class="hash-link" aria-label="Direct link to 736-spring-mvc-指标" title="Direct link to 736-spring-mvc-指标">​</a></h4>
<p>自动配置能够对 Spring MVC Controller和编程式handler处理的所有请求进行度量。 默认情况下，指标是以 <code>http.server.requests</code> 为名称生成的。 你可以通过设置 <code>management.observations.http.server.requests.name</code> 属性来定制该名称。</p>
<p>关于产生的观察结果（observation）的更多信息，请参见 <a href="https://docs.spring.io/spring-framework/docs/6.0.5/reference/html/integration.html#integration.observability.http-server.servlet" target="_blank" rel="noopener noreferrer">Spring Framework 参考文档</a>。</p>
<p>要添加到默认标签中，请提供一个继承了 <code>org.springframework.http.server.observation</code> 包中的 <code>DefaultServerRequestObservationConvention</code> 的 <code>@Bean</code>。要替换默认标签，请提供一个实现 <code>ServerRequestObservationConvention</code> 的 <code>@Bean</code>。</p>
<table><thead><tr><th></th><th>在某些情况下，Web控制器中处理的异常不会被记录为请求度量标签。应用程序可以选择加入并通过将<a href="https://springdoc.cn/spring-boot/web.html#web.servlet.spring-mvc.error-handling" target="_blank" rel="noopener noreferrer">handled exception 设置为 request attribute</a>来记录异常。</th></tr></thead></table>
<p>默认情况下，所有请求都被处理。 要自定义过滤器，请提供一个实现 <code>FilterRegistrationBean&lt;WebMvcMetricsFilter&gt;</code> 的 <code>@Bean</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="737-spring-webflux-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.spring-webflux" target="_blank" rel="noopener noreferrer"></a>7.3.7. Spring WebFlux 指标<a href="#737-spring-webflux-指标" class="hash-link" aria-label="Direct link to 737-spring-webflux-指标" title="Direct link to 737-spring-webflux-指标">​</a></h4>
<p>自动配置能够对Spring WebFlux controller和编程式handler的所有请求进行度量。 默认情况下，指标是以 <code>http.server.requests</code> 为名生成的。 你可以通过设置 <code>management.observations.http.server.requests.name</code> 属性来定制该名称。</p>
<p>关于产生的观察结果（observation）的更多信息，请参见 <a href="https://docs.spring.io/spring-framework/docs/6.0.5/reference/html/integration.html#integration.observability.http-server.reactive" target="_blank" rel="noopener noreferrer">Spring Framework 参考文档</a>。</p>
<p>要添加到默认标签中，请提供继承了 <code>org.springframework.http.server.reactive.observation</code> 包中的 <code>DefaultServerRequestObservationConvention</code> 的 <code>@Bean</code>。要替换默认标签，请提供一个实现 <code>ServerRequestObservationConvention</code> 的 <code>@Bean</code>。</p>
<table><thead><tr><th></th><th>在某些情况下，控制器和处理函数中处理的异常不会被记录为请求度量标签。应用程序可以选择加入并通过<a href="https://springdoc.cn/spring-boot/web.html#web.reactive.webflux.error-handling" target="_blank" rel="noopener noreferrer">将handled exception设置为request attribute</a>来记录异常。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="738-jersey-server-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.jersey" target="_blank" rel="noopener noreferrer"></a>7.3.8. Jersey Server 指标<a href="#738-jersey-server-指标" class="hash-link" aria-label="Direct link to 738-jersey-server-指标" title="Direct link to 738-jersey-server-指标">​</a></h4>
<p>自动配置使Jersey JAX-RS实现所处理的所有请求都能被测量。 默认情况下，指标是以 <code>http.server.requests</code> 为名称生成的。 你可以通过设置 <code>management.observations.http.server.requests.name</code> 属性来定制名称。</p>
<p>默认情况下，Jersey服务器指标被标记为以下信息。</p>
<table><thead><tr><th>Tag</th><th>说明</th></tr></thead><tbody><tr><td><code>exception</code></td><td>处理 请求时抛出的任何异常的简单类名。</td></tr><tr><td><code>method</code></td><td>请求的方法（例如，<code>GET</code> 或 <code>POST</code>）。</td></tr><tr><td><code>outcome</code></td><td>请求的结果，基于响应的状态代码。 1xx是 <code>INFORMATIONAL</code>，2xx是 <code>SUCCESS</code>，3xx是 <code>REDIRECTION</code>，4xx是 <code>CLIENT_ERROR</code>，5xx是 <code>SERVER_ERROR</code>。</td></tr><tr><td><code>status</code></td><td>响应的HTTP状态代码（例如，<code>200</code> 或 <code>500</code>）。</td></tr><tr><td><code>uri</code></td><td>如果可能的话，在进行变量替换之前，请求的URI模板（例如：<code>/api/person/{id}</code>）。</td></tr></tbody></table>
<p>要定制标签，请提供一个实现 <code>JerseyTagsProvider</code> 的 <code>@Bean</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="739-http-client-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.http-clients" target="_blank" rel="noopener noreferrer"></a>7.3.9. HTTP Client 指标<a href="#739-http-client-指标" class="hash-link" aria-label="Direct link to 739-http-client-指标" title="Direct link to 739-http-client-指标">​</a></h4>
<p>Spring Boot Actuator负责管理 <code>RestTemplate</code> 和 <code>WebClient</code> 的工具。为此，你必须注入自动配置的构建器并使用它来创建实例。</p>
<ul>
<li>
<p><code>RestTemplateBuilder</code> 用于 <code>RestTemplate</code></p>
</li>
<li>
<p><code>WebClient.Builder</code> 用于 <code>WebClient</code></p>
</li>
</ul>
<p>你也可以手动应用负责这个工具的customizer，即 <code>ObservationRestTemplateCustomizer</code> 和 <code>ObservationWebClientCustomizer</code>。</p>
<p>默认情况下，指标是以 <code>http.client.requests</code> 这个名字生成的。</p>
<p>你可以通过设置 <code>management.observations.http.client.requests.name</code> 属性来定制这个名字。</p>
<p>关于产生的观察结果（observation）的更多信息，请参见 <a href="https://docs.spring.io/spring-framework/docs/6.0.5/reference/html/integration.html#integration.observability.http-client" target="_blank" rel="noopener noreferrer">Spring Framework 参考文档</a>。</p>
<p>要在使用 <code>RestTemplate</code> 时定制标签，请提供一个实现了 <code>org.springframework.http.client.observation</code> 包中 <code>ClientRequestObservationConvention</code> 的 <code>@Bean</code>。要在使用 <code>WebClient</code> 时自定义标签，请提供一个实现了 <code>org.springframework.web.reactive.function.client</code> 包中 <code>ClientRequestObservationConvention</code> 的 <code>@Bean</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7310-tomcat-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.tomcat" target="_blank" rel="noopener noreferrer"></a>7.3.10. Tomcat 指标<a href="#7310-tomcat-指标" class="hash-link" aria-label="Direct link to 7310-tomcat-指标" title="Direct link to 7310-tomcat-指标">​</a></h4>
<p>自动配置仅在 <code>MBeanRegistry</code> 被启用时才会启用Tomcat的仪器。 默认情况下，<code>MBeanRegistry</code> 是禁用的，但你可以通过设置 <code>server.tomcat.mbeanregistry.enabled</code> 为 <code>true</code> 来启用它。</p>
<p>Tomcat的指标在 <code>tomcat.</code> meter 名下发布。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7311-cache-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.cache" target="_blank" rel="noopener noreferrer"></a>7.3.11. Cache 指标<a href="#7311-cache-指标" class="hash-link" aria-label="Direct link to 7311-cache-指标" title="Direct link to 7311-cache-指标">​</a></h4>
<p>自动配置可以在启动时对所有可用的 <code>Cache</code> 实例进行检测，其指标以 <code>cache</code> 为前缀。</p>
<p>缓存仪表是标准化的基本指标集。</p>
<p>也可以使用额外的、针对缓存的指标。</p>
<p>支持以下 缓存库。</p>
<ul>
<li>
<p>Cache2k</p>
</li>
<li>
<p>Caffeine</p>
</li>
<li>
<p>Hazelcast</p>
</li>
<li>
<p>任何兼容的JCache（JSR-107）实现</p>
</li>
<li>
<p>Redis</p>
</li>
</ul>
<p>指标由缓存的名称和 <code>CacheManager</code> 的名称来标记，<code>CacheManager</code> 的名称是由Bean名称派生的。</p>
<table><thead><tr><th></th><th>只有在启动时配置的缓存被绑定到注册表。 对于没有在缓存配置中定义的缓存，例如在启动阶段后临时创建的缓存或以编程方式创建的缓存，需要明确注册。 一个 <code>CacheMetricsRegistrar</code> Bean可以使这个过程更容易。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7312-spring-graphql-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.spring-graphql" target="_blank" rel="noopener noreferrer"></a>7.3.12. Spring GraphQL 指标<a href="#7312-spring-graphql-指标" class="hash-link" aria-label="Direct link to 7312-spring-graphql-指标" title="Direct link to 7312-spring-graphql-指标">​</a></h4>
<p>参见 <a href="https://docs.spring.io/spring-graphql/docs/1.1.2/reference/html/" target="_blank" rel="noopener noreferrer">Spring GraphQL 参考文档</a>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7313-datasource-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.jdbc" target="_blank" rel="noopener noreferrer"></a>7.3.13. DataSource 指标<a href="#7313-datasource-指标" class="hash-link" aria-label="Direct link to 7313-datasource-指标" title="Direct link to 7313-datasource-指标">​</a></h4>
<p>自动配置使所有可用的 <code>DataSource</code> 对象的仪器化，指标前缀为 <code>jdbc.connections</code>。 数据源检测的结果是表示池中当前活动的、空闲的、最大允许的和最小允许的连接数的仪表。</p>
<p>衡量标准也由基于bean名称计算的 <code>DataSource</code> 的名称来标记。</p>
<table><thead><tr><th></th><th>默认情况下，Spring Boot为所有支持的数据源提供元数据。 如果你喜欢的数据源不被支持，你可以添加额外的 <code>DataSourcePoolMetadataProvider</code> Bean。 请参阅 <code>DataSourcePoolMetadataProvidersConfiguration</code> 以了解实例。</th></tr></thead></table>
<p>此外，Hikari特定的指标以 <code>hikaricp</code> 前缀暴露。 每个指标都被pool的名字所标记（你可以用 <code>spring.datasource.name</code> 来控制）。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7314-hibernate-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.hibernate" target="_blank" rel="noopener noreferrer"></a>7.3.14. Hibernate 指标<a href="#7314-hibernate-指标" class="hash-link" aria-label="Direct link to 7314-hibernate-指标" title="Direct link to 7314-hibernate-指标">​</a></h4>
<p>如果 <code>org.hibernate.orm:hibernate-micrometer</code> 在classpath上，所有启用了统计功能的Hibernate <code>EntityManagerFactory</code> 实例都会被一个名为 <code>hibernate</code> 的指标所检测。</p>
<p>衡量标准也由 <code>EntityManagerFactory</code> 的名称来标记，该名称是由Bean名称派生的。</p>
<p>要启用统计，标准JPA属性 <code>hibernate.generate_statistics</code> 必须设置为 <code>true</code>。 你可以在自动配置的 <code>EntityManagerFactory</code> 上启用。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">spring.jpa.properties[hibernate.generate_statistics]=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7315-spring-data-repository-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.spring-data-repository" target="_blank" rel="noopener noreferrer"></a>7.3.15. Spring Data Repository 指标<a href="#7315-spring-data-repository-指标" class="hash-link" aria-label="Direct link to 7315-spring-data-repository-指标" title="Direct link to 7315-spring-data-repository-指标">​</a></h4>
<p>自动配置能够对所有Spring Data <code>Repository</code> 方法的调用进行度量。 默认情况下，指标以 <code>spring.data.repository.invocations</code> 为名生成。 你可以通过设置 <code>management.metrics.data.repository.metric-name</code> 属性来自定义名称。</p>
<p><code>io.micrometer.core.annotation</code> 包中的 <code>@Timed</code> 注解支持 <code>Repository</code> 接口和方法。如果你不想记录所有 <code>Repository</code> 调用的度量（metric），你可以将 <code>management.metrics.data.repository.autotime.enabled</code> 设置为 <code>false</code>，而专门使用 <code>@Timed</code> 注解。</p>
<table><thead><tr><th></th><th>一个带有 <code>longTask = true</code> 的 <code>@Timed</code> 注解可以为该方法启用一个长任务计时器。长任务定时器需要一个单独的 metric name，并且可以与短任务定时器（task timer）叠加。</th></tr></thead></table>
<p>默认情况下，repository调用相关的度量标准被标记为以下信息。</p>
<table><thead><tr><th>Tag</th><th>说明</th></tr></thead><tbody><tr><td><code>repository</code></td><td>源 <code>Repository</code> 的简单类名。</td></tr><tr><td><code>method</code></td><td>被调用的 <code>Repository</code> 方法的名称。</td></tr><tr><td><code>state</code></td><td>结果状态（<code>SUCCESS</code>, <code>ERROR</code>, <code>CANCELED</code>, <code>RUNNING</code>）。</td></tr><tr><td><code>exception</code></td><td>调用中抛出的任何异常的简单类名。</td></tr></tbody></table>
<p>要替换默认标签，需要提供一个实现了 <code>RepositoryTagsProvider</code> 的 <code>@Bean</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7316-rabbitmq-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.rabbitmq" target="_blank" rel="noopener noreferrer"></a>7.3.16. RabbitMQ 指标<a href="#7316-rabbitmq-指标" class="hash-link" aria-label="Direct link to 7316-rabbitmq-指标" title="Direct link to 7316-rabbitmq-指标">​</a></h4>
<p>自动配置使所有可用的 RabbitMQ 连接工厂的仪器化，其指标名为 <code>rabbitmq</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7317-spring-integration-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.spring-integration" target="_blank" rel="noopener noreferrer"></a>7.3.17. Spring Integration 指标<a href="#7317-spring-integration-指标" class="hash-link" aria-label="Direct link to 7317-spring-integration-指标" title="Direct link to 7317-spring-integration-指标">​</a></h4>
<p>只要有 <code>MeterRegistry</code> bean，Spring Integration就会自动提供 <a href="https://docs.spring.io/spring-integration/docs/6.1.0-M1/reference/html/system-management.html#micrometer-integration" target="_blank" rel="noopener noreferrer">Micrometer support</a>。 度量标准在 <code>spring.integration.</code> meter 名称下发布。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7318-kafka-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.kafka" target="_blank" rel="noopener noreferrer"></a>7.3.18. Kafka 指标<a href="#7318-kafka-指标" class="hash-link" aria-label="Direct link to 7318-kafka-指标" title="Direct link to 7318-kafka-指标">​</a></h4>
<p>自动配置为自动配置的消费者工厂和生产者工厂分别注册了一个 <code>MicrometerConsumerListener</code> 和 <code>MicrometerProducerListener</code>。 它还为 <code>StreamsBuilderFactoryBean</code> 注册了一个 <code>KafkaStreamsMicrometerListener</code>。 更多细节，请参阅Spring Kafka文档中的 <a href="https://docs.spring.io/spring-kafka/docs/3.0.3/reference/html/#micrometer-native" target="_blank" rel="noopener noreferrer">Micrometer Native Metrics</a> 部分。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7319-mongodb-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.mongodb" target="_blank" rel="noopener noreferrer"></a>7.3.19. MongoDB 指标<a href="#7319-mongodb-指标" class="hash-link" aria-label="Direct link to 7319-mongodb-指标" title="Direct link to 7319-mongodb-指标">​</a></h4>
<p>本节简要介绍MongoDB的可用度量。</p>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="mongodb命令指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.mongodb.command" target="_blank" rel="noopener noreferrer"></a>MongoDB命令指标<a href="#mongodb命令指标" class="hash-link" aria-label="Direct link to mongodb命令指标" title="Direct link to mongodb命令指标">​</a></h5>
<p>自动配置将 <code>MongoMetricsCommandListener</code> 与自动配置的 <code>MongoClient</code> 注册。</p>
<p>一个名为 <code>mongodb.driver.commands</code> 的timer指标被创建，用于向底层MongoDB driver发出的每条命令。 默认情况下，每个指标都被标记为以下信息。</p>
<table><thead><tr><th>Tag</th><th>说明</th></tr></thead><tbody><tr><td><code>command</code></td><td>发出的命令的名称。</td></tr><tr><td><code>cluster.id</code></td><td>发送该命令的集群的标识符。</td></tr><tr><td><code>server.address</code></td><td>发送命令的服务器的地址。</td></tr><tr><td><code>status</code></td><td>命令的结果（<code>SUCCESS</code> 或 `FAILED）。</td></tr></tbody></table>
<p>为了替换默认的度量衡标签，定义一个 <code>MongoCommandTagsProvider</code> bean，如下例所示。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyCommandTagsProviderConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MongoCommandTagsProvider customCommandTagsProvider() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CustomCommandTagsProvider();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要禁用自动配置的命令度量，请设置以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.mongo.command.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_HWLp" id="mongodb-连接池指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.mongodb.connection-pool" target="_blank" rel="noopener noreferrer"></a>MongoDB 连接池指标<a href="#mongodb-连接池指标" class="hash-link" aria-label="Direct link to mongodb-连接池指标" title="Direct link to mongodb-连接池指标">​</a></h5>
<p>自动配置将 <code>MongoMetricsConnectionPoolListener</code> 与自动配置的 <code>MongoClient</code> 注册。</p>
<p>以下是为连接池创建的测量指标。</p>
<ul>
<li>
<p><code>mongodb.driver.pool.size</code> 报告连接池的当前大小，包括空闲和正在使用的成员。</p>
</li>
<li>
<p><code>mongodb.driver.pool.checkedout</code> 报告当前使用中的连接数。</p>
</li>
<li>
<p><code>mongodb.driver.pool.waitqueuesize</code> 报告池中连接的等待队列的当前大小。</p>
</li>
</ul>
<p>默认情况下，每个指标都被标记为以下信息。</p>
<table><thead><tr><th>Tag</th><th>说明</th></tr></thead><tbody><tr><td><code>cluster.id</code></td><td>连接池所对应的集群的标识符。</td></tr><tr><td><code>server.address</code></td><td>连接池所对应的服务器的地址。</td></tr></tbody></table>
<p>要取代默认的度量衡标签，请定义一个 <code>MongoConnectionPoolTagsProvider</code> bean。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyConnectionPoolTagsProviderConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MongoConnectionPoolTagsProvider customConnectionPoolTagsProvider() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CustomConnectionPoolTagsProvider();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要禁用自动配置的连接池度量，请设置以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.mongo.connectionpool.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7320-jetty-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.jetty" target="_blank" rel="noopener noreferrer"></a>7.3.20. Jetty 指标<a href="#7320-jetty-指标" class="hash-link" aria-label="Direct link to 7320-jetty-指标" title="Direct link to 7320-jetty-指标">​</a></h4>
<p>自动配置通过使用Micrometer的 <code>JettyServerThreadPoolMetrics</code> 为Jetty的 <code>ThreadPool</code> 绑定指标。 Jetty的 <code>Connector</code> 实例的指标通过使用Micrometer的 <code>JettyConnectionMetrics</code> 来绑定，当 <code>server.ssl.enabled</code> 被设置为 <code>true</code> 时，Micrometer的 <code>JettySslHandshakeMetrics</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7321-timed-注解的支持"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.timed-annotation" target="_blank" rel="noopener noreferrer"></a>7.3.21. @Timed 注解的支持<a href="#7321-timed-注解的支持" class="hash-link" aria-label="Direct link to 7321-timed-注解的支持" title="Direct link to 7321-timed-注解的支持">​</a></h4>
<p>要在Spring Boot不直接支持的地方使用 <code>@Timed</code>，请参考 <a href="https://micrometer.io/docs/concepts#_the_timed_annotation" target="_blank" rel="noopener noreferrer">Micrometer 文档</a>。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="7322-redis-指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.supported.redis" target="_blank" rel="noopener noreferrer"></a>7.3.22. Redis 指标<a href="#7322-redis-指标" class="hash-link" aria-label="Direct link to 7322-redis-指标" title="Direct link to 7322-redis-指标">​</a></h4>
<p>自动配置为自动配置的 <code>LettuceConnectionFactory</code> 注册了一个 <code>MicrometerCommandLatencyRecorder</code>。 更多细节，请参阅Lettuce文档的 <a href="https://lettuce.io/core/6.2.3.RELEASE/reference/index.html#command.latency.metrics.micrometer" target="_blank" rel="noopener noreferrer">Micrometer Metrics部分</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="74-注册自定义指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.registering-custom" target="_blank" rel="noopener noreferrer"></a>7.4. 注册自定义指标<a href="#74-注册自定义指标" class="hash-link" aria-label="Direct link to 74-注册自定义指标" title="Direct link to 74-注册自定义指标">​</a></h3>
<p>要注册自定义度量，请将 <code>MeterRegistry</code> 注入你的组件中。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyBean {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Dictionary dictionary;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MyBean(MeterRegistry registry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.dictionary = Dictionary.load();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.gauge(&quot;dictionary.size&quot;, Tags.empty(), this.dictionary.getWords().size());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果你的度量标准依赖于其他Bean，我们建议你使用 <code>MeterBinder</code> 来注册它们。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">public class MyMeterBinderConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MeterBinder queueSize(Queue queue) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (registry) -&gt; Gauge.builder(&quot;queueSize&quot;, queue::size).register(registry);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>MeterBinder</code> 可以确保建立正确的依赖关系，并且在检索度量值的时候，Bean是可用的。 如果你发现你在组件或应用程序中重复测量一套指标，那么 <code>MeterBinder</code> 的实现也会很有用。</p>
<table><thead><tr><th></th><th>默认情况下，所有 <code>MeterBinder</code> Bean的指标都会自动绑定到Spring管理的 <code>MeterRegistry</code>。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="75-定制个别指标"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.customizing" target="_blank" rel="noopener noreferrer"></a>7.5. 定制个别指标<a href="#75-定制个别指标" class="hash-link" aria-label="Direct link to 75-定制个别指标" title="Direct link to 75-定制个别指标">​</a></h3>
<p>如果你需要对特定的 <code>Meter</code> 实例进行自定义，你可以使用 <code>io.micrometer.core.instrument.config.MeterFilter</code> 接口。</p>
<p>例如，如果你想把所有以 <code>com.example</code> 开头的仪表ID的 <code>mytag.region</code> 标签重命名为 <code>mytag.area</code>，你可以做以下工作。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyMetricsFilterConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public MeterFilter renameRegionTagMeterFilter() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return MeterFilter.renameTag(&quot;com.example&quot;, &quot;mytag.region&quot;, &quot;mytag.area&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>默认情况下，所有的 <code>MeterFilter</code> Bean都自动绑定到Spring管理的 <code>MeterRegistry</code>。 请确保使用Spring管理的 <code>MeterRegistry</code> 来注册你的指标，而不是使用 <code>Metrics</code> 的任何静态方法。 这些方法使用的是不被Spring管理的全局注册表。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="751-常见标签tag"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.customizing.common-tags" target="_blank" rel="noopener noreferrer"></a>7.5.1. 常见标签（Tag）<a href="#751-常见标签tag" class="hash-link" aria-label="Direct link to 751-常见标签tag" title="Direct link to 751-常见标签tag">​</a></h4>
<p>通用标签一般用于对运行环境进行维度下钻，如主机、实例、区域、堆栈等。 共用标签适用于所有仪表，可以进行配置，如下例所示。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.tags.region=us-east-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.tags.stack=prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>前面的例子为所有值为 <code>us-east-1</code> 和 <code>prod</code> 的仪表添加了 <code>region</code> 和 <code>stack</code> 标签。</p>
<table><thead><tr><th></th><th>如果你使用Graphite，普通标签的顺序是很重要的。 由于使用这种方法不能保证常见标签的顺序，建议Graphite用户定义一个自定义的 <code>MeterFilter</code> 来代替。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="752-per-meter-properties"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.customizing.per-meter-properties" target="_blank" rel="noopener noreferrer"></a>7.5.2. Per-meter Properties<a href="#752-per-meter-properties" class="hash-link" aria-label="Direct link to 752-per-meter-properties" title="Direct link to 752-per-meter-properties">​</a></h4>
<p>除了 <code>MeterFilter</code> Bean，你还可以使用属性在每个表的基础上应用一组有限的自定义功能。 使用Spring Boot的 <code>PropertiesMeterFilter</code>，每个表的定制被应用于以给定名称开头的任何表的ID。 下面的例子过滤掉任何ID以 <code>example.remote</code> 开头的仪表。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.metrics.enable.example.remote=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>下面的属性允许per-meter的定制。</p>
<table><thead><tr><th>Property</th><th>说明</th></tr></thead><tbody><tr><td><code>management.metrics.enable</code></td><td>是否接受具有特定ID的Meter。 不接受的Meter将从 <code>MeterRegistry</code> 中过滤掉。</td></tr><tr><td><code>management.metrics.distribution.percentiles-histogram</code></td><td>  是否发布适合计算可聚集（跨维度）的百分位数近似值的直方图。</td></tr><tr><td><code>management.metrics.distribution.minimum-expected-value</code>, <code>management.metrics.distribution.maximum-expected-value</code></td><td>通过钳制预期值的范围，发布更少的直方图桶。</td></tr><tr><td><code>management.metrics.distribution.percentiles</code></td><td>发布在你的应用程序中计算的百分位值</td></tr><tr><td><code>management.metrics.distribution.expiry</code>, <code>management.metrics.distribution.buffer-length</code></td><td>通过在环形缓冲区中积累最近的样本，给它们更大的权重，环形缓冲区在可配置的过期后旋转，缓冲区长度为 可配置的缓冲区长度。</td></tr><tr><td><code>management.metrics.distribution.slo</code></td><td>发布一个累积直方图，其中的桶由你的服务水平目标定义。</td></tr></tbody></table>
<p>关于 <code>percentiles-histogram</code> （百分数-直方图）、<code>percentiles</code>（百分数）和 <code>slo</code> 背后的概念的更多细节，请参见Micrometer文档中的 <a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles" target="_blank" rel="noopener noreferrer">“Histograms and percentiles” （直方图和百分数）部分</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="76-指标端点"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.endpoint" target="_blank" rel="noopener noreferrer"></a>7.6. 指标端点<a href="#76-指标端点" class="hash-link" aria-label="Direct link to 76-指标端点" title="Direct link to 76-指标端点">​</a></h3>
<p>Spring Boot提供了一个 <code>metrics</code> 端点，你可以诊断性地使用它来检查应用程序收集的指标。该端点默认情况下是不可用的，必须公开。更多细节请参见 <a href="https://springdoc.cn/spring-boot/actuator.html#actuator.endpoints.exposing" target="_blank" rel="noopener noreferrer">暴露端点</a>。</p>
<p>导航到 <code>/actuator/metrics</code> 会显示一个可用的仪表名称列表。 你可以通过提供名称作为选择器来深入查看某个特定仪表的信息，例如，<code>/actuator/metrics/jvm.memory.max</code>。</p>
<table><thead><tr><th></th><th>你在这里使用的名字应该与代码中使用的名字一致，而不是在它被运往的监控系统中经过命名惯例规范化后的名字。 换句话说，如果 <code>jvm.memory.max</code> 在Prometheus中显示为 <code>jvm_memory_max</code>，因为它的蛇形命名惯例，你仍然应该使用 <code>jvm.memory.max</code> 作为选择器，在 <code>metrics</code> 端点中检查仪表。</th></tr></thead></table>
<p>你也可以在URL的末尾添加任意数量的 <code>tag=KEY:VALUE</code> 查询参数，以对仪表进行维度下钻?—?例如，<code>/actuator/metrics/jvm.memory.max?tag=area:nonheap</code>。</p>
<table><thead><tr><th></th><th>报告的测量值是所有与仪表名称相匹配的仪表和任何已应用的标签的统计量的 <em>总和</em>。 在前面的例子中，返回的 <code>Value</code> 统计是堆的 “Code Cache”、“Compressed Class Space” 和 “Metaspace” 区域的最大内存“足迹”之和。 如果你想只看到 “Metaspace” 的最大尺寸，你可以添加一个额外的 <code>tag=id:Metaspace</code> --即 <code>/actuator/metrics/jvm.memory.max?tag=area:nonheap&amp;tag=id:Metaspace</code>。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="77-整合-micrometer-observation"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.metrics.micrometer-observation" target="_blank" rel="noopener noreferrer"></a>7.7. 整合 Micrometer Observation<a href="#77-整合-micrometer-observation" class="hash-link" aria-label="Direct link to 77-整合-micrometer-observation" title="Direct link to 77-整合-micrometer-observation">​</a></h3>
<p>一个 <code>DefaultMeterObservationHandler</code> 被自动注册在 <code>ObservationRegistry</code> 上，它为每个完成的观察（completed observation）创建度量（metric）。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="8-追踪tracing"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing" target="_blank" rel="noopener noreferrer"></a>8. 追踪（Tracing）<a href="#8-追踪tracing" class="hash-link" aria-label="Direct link to 8-追踪tracing" title="Direct link to 8-追踪tracing">​</a></h2>
<p>Spring Boot Actuator 为 Micrometer Tracing 提供了依赖性管理和自动配置， <a href="https://micrometer.io/docs/tracing" target="_blank" rel="noopener noreferrer">Micrometer Tracing</a> 是流行的追踪器（tracer）库的一个接口（facade）。</p>
<table><thead><tr><th></th><th>要了解更多关于 Micrometer Tracing 功能的信息，请参阅其 <a href="https://micrometer.io/docs/tracing" target="_blank" rel="noopener noreferrer">参考文档</a>。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="81-支持的追踪器"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracers" target="_blank" rel="noopener noreferrer"></a>8.1. 支持的追踪器<a href="#81-支持的追踪器" class="hash-link" aria-label="Direct link to 81-支持的追踪器" title="Direct link to 81-支持的追踪器">​</a></h3>
<p>Spring Boot为以下追踪器提供了自动配置。</p>
<ul>
<li>
<p>使用 <a href="https://zipkin.io/" target="_blank" rel="noopener noreferrer">Zipkin</a> 或 <a href="https://docs.wavefront.com/" target="_blank" rel="noopener noreferrer">Wavefront</a> 的 <a href="https://opentelemetry.io/" target="_blank" rel="noopener noreferrer">OpenTelemetry</a></p>
</li>
<li>
<p>使用 <a href="https://zipkin.io/" target="_blank" rel="noopener noreferrer">Zipkin</a> 或 <a href="https://docs.wavefront.com/" target="_blank" rel="noopener noreferrer">Wavefront</a> 的 <a href="https://github.com/openzipkin/brave" target="_blank" rel="noopener noreferrer">OpenZipkin Brave</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="82-入门"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.getting-started" target="_blank" rel="noopener noreferrer"></a>8.2. 入门<a href="#82-入门" class="hash-link" aria-label="Direct link to 82-入门" title="Direct link to 82-入门">​</a></h3>
<p>我们需要一个可以用来开始追踪的示例应用程序。就我们的目的而言，“<a href="https://springdoc.cn/spring-boot/getting-started.html#getting-started.first-application" target="_blank" rel="noopener noreferrer">getting-started.html</a>” 部分所涉及的简单的 “Hello World!” web程序就足够了。我们将使用 <code>OpenTelemetry</code> 追踪器和 <code>Zipkin</code> 作为追踪后端。</p>
<p>回顾一下，我们的主要应用代码看起来是这样的。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyApplication {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Log logger = LogFactory.getLog(MyApplication.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @RequestMapping(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String home() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info(&quot;home() has been called&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;Hello World!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SpringApplication.run(MyApplication.class, args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>在 <code>home()</code> 方法中，有一个附加的logger语句，这在后面会很重要 。</th></tr></thead></table>
<p>现在，我们必须添加以下依赖项。</p>
<ul>
<li>
<p><code>org.springframework.boot:spring-boot-starter-actuator</code></p>
</li>
<li>
<p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - 这是连接 Micrometer Observation API 和 OpenTelemetry 的必要条件。</p>
</li>
<li>
<p><code>io.opentelemetry:opentelemetry-exporter-zipkin</code> - 这是向Zipkin报告 <a href="https://micrometer.io/docs/tracing#_glossary" target="_blank" rel="noopener noreferrer">traces</a> 所需要的。</p>
</li>
</ul>
<p>添加如下的 application properties:</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.tracing.sampling.probability=1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认情况下，Spring Boot只对10%的请求进行采样，以防止追踪后端不堪重负。此属性将其切换为100%，这样每个请求都会被发送到跟踪后端。</p>
<p>为了收集和可视化跟踪，我们需要一个运行跟踪的后端。我们在这里使用Zipkin作为我们的跟踪后端。 <a href="https://zipkin.io/pages/quickstart" target="_blank" rel="noopener noreferrer">Zipkin快速入门指南</a> 提供了如何在本地启动Zipkin的说明。</p>
<p>Zipkin运行后，你可以启动你的应用程序。</p>
<p>如果你打开web浏览器访问 <code>[localhost:8080](http://localhost:8080/)</code>，你应该看到以下输出。</p>
<p>Hello World!</p>
<p>在幕后，已经为HTTP请求创建了一个 observation，它反过来被桥接到 <code>OpenTelemetry</code>，后者向Zipkin报告一个新的跟踪（trace）。</p>
<p>现在，在 <code>[localhost:9411](http://localhost:9411/)</code> 打开Zipkin用户界面，点击 &quot;Run Query&quot; 按钮，列出所有收集到的跟踪信息。你应该看到一个追踪。点击 &quot;Show&quot; 按钮，查看该追踪的细节。</p>
<table><thead><tr><th></th><th>你可以通过将 <code>logging.pattern.level</code> 属性设置为 <code>%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]</code>，在日志中包含当前的跟踪（trace）和 span id。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="83-跟踪器tracer的实现"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracer-implementations" target="_blank" rel="noopener noreferrer"></a>8.3. 跟踪器（Tracer）的实现<a href="#83-跟踪器tracer的实现" class="hash-link" aria-label="Direct link to 83-跟踪器tracer的实现" title="Direct link to 83-跟踪器tracer的实现">​</a></h3>
<p>由于Micrometer Tracer支持多种示踪器的实现，因此Spring Boot可能有多种依赖组合。</p>
<p>所有追踪器的实现都需要 <code>org.springframework.boot:spring-boot-starter-actuator</code> 依赖。</p>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="831-使用-zipkin-的-opentelemetry"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracer-implementations.otel-zipkin" target="_blank" rel="noopener noreferrer"></a>8.3.1. 使用 Zipkin 的 OpenTelemetry<a href="#831-使用-zipkin-的-opentelemetry" class="hash-link" aria-label="Direct link to 831-使用-zipkin-的-opentelemetry" title="Direct link to 831-使用-zipkin-的-opentelemetry">​</a></h4>
<ul>
<li>
<p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - 这是连接 Micrometer Observation API 和 OpenTelemetry 的必要条件。</p>
</li>
<li>
<p><code>io.opentelemetry:opentelemetry-exporter-zipkin</code> - 这是向Zipkin报告trace所需要的。</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="832-使用-wavefront-的-opentelemetry"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracer-implementations.otel-wavefront" target="_blank" rel="noopener noreferrer"></a>8.3.2. 使用 Wavefront 的 OpenTelemetry<a href="#832-使用-wavefront-的-opentelemetry" class="hash-link" aria-label="Direct link to 832-使用-wavefront-的-opentelemetry" title="Direct link to 832-使用-wavefront-的-opentelemetry">​</a></h4>
<ul>
<li>
<p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - 这是连接 Micrometer Observation API 和 OpenTelemetry 的必要条件。</p>
</li>
<li>
<p><code>io.micrometer:micrometer-tracing-reporter-wavefront</code> - 这是向Wavefront报告trace所需要的。</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="833-使用-zipkin-的-openzipkin-brave"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracer-implementations.brave-zipkin" target="_blank" rel="noopener noreferrer"></a>8.3.3. 使用 Zipkin 的 OpenZipkin Brave<a href="#833-使用-zipkin-的-openzipkin-brave" class="hash-link" aria-label="Direct link to 833-使用-zipkin-的-openzipkin-brave" title="Direct link to 833-使用-zipkin-的-openzipkin-brave">​</a></h4>
<ul>
<li>
<p><code>io.micrometer:micrometer-tracing-bridge-brave</code> - 这是连接 Micrometer Observation API 和 Brave 的必要条件。</p>
</li>
<li>
<p><code>io.zipkin.reporter2:zipkin-reporter-brave</code> - 这是向Zipkin报告 trace 所需要的。</p>
</li>
</ul>
<table><thead><tr><th></th><th>如果你的项目没有使用Spring MVC或Spring WebFlux，也需要使用 <code>io.zipkin.reporter2:zipkin-sender-urlconnection</code> 依赖项。</th></tr></thead></table>
<h4 class="anchor anchorWithStickyNavbar_HWLp" id="834-使用wavefront的openzipkin-brave"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.tracer-implementations.brave-wavefront" target="_blank" rel="noopener noreferrer"></a>8.3.4. 使用Wavefront的OpenZipkin Brave<a href="#834-使用wavefront的openzipkin-brave" class="hash-link" aria-label="Direct link to 834-使用wavefront的openzipkin-brave" title="Direct link to 834-使用wavefront的openzipkin-brave">​</a></h4>
<ul>
<li>
<p><code>io.micrometer:micrometer-tracing-bridge-brave</code> - 这是连接测Micrometer Observation API和Brave的必要条件。</p>
</li>
<li>
<p><code>io.micrometer:micrometer-tracing-reporter-wavefront</code> - 这是向Wavefront报告trace所需要的。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="84-创建自定义跨度span"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.micrometer-tracing.creating-spans" target="_blank" rel="noopener noreferrer"></a>8.4. 创建自定义跨度（span）<a href="#84-创建自定义跨度span" class="hash-link" aria-label="Direct link to 84-创建自定义跨度span" title="Direct link to 84-创建自定义跨度span">​</a></h3>
<p>你可以通过启动一个 observation 来创建你自己的span。为此，将 <code>ObservationRegistry</code> 注入到你的组件中。</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class CustomObservation {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final ObservationRegistry observationRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CustomObservation(ObservationRegistry observationRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.observationRegistry = observationRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void someOperation() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Observation observation = Observation.createNotStarted(&quot;some-operation&quot;, this.observationRegistry);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        observation.lowCardinalityKeyValue(&quot;some-tag&quot;, &quot;some-value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        observation.observe(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Business logic ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这将创建一个名为 &quot;some-operation&quot; 的 observation，标签为，标签为 &quot;some-tag=some-value&quot;。</p>
<table><thead><tr><th></th><th>如果你想在不创建metric的情况下创建一个span，你需要使用 Micrometer 的 <a href="https://micrometer.io/docs/tracing#_using_micrometer_tracing_directly" target="_blank" rel="noopener noreferrer">低级Tracer API</a>。</th></tr></thead></table>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="9-审计"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.auditing" target="_blank" rel="noopener noreferrer"></a>9. 审计<a href="#9-审计" class="hash-link" aria-label="Direct link to 9-审计" title="Direct link to 9-审计">​</a></h2>
<p>一旦Spring Security发挥作用，Spring Boot Actuator就有一个灵活的审计框架，可以发布事件（默认为 “authentication success”, “failure” 和 “access denied” 的异常）。 这一功能对于报告和实施基于认证失败的锁定策略非常有用。</p>
<p>你可以通过在应用程序的配置  中提供一个 <code>AuditEventRepository</code> 类型的bean来启用审计。 为了方便，Spring Boot提供了一个 <code>InMemoryAuditEventRepository</code>。 <code>InMemoryAuditEventRepository</code> 的功能有限，我们建议只在开发环境中使用它。 对于生产环境，请考虑创建你自己的替代 <code>AuditEventRepository</code> 实现。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="91-定制审计"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.auditing.custom" target="_blank" rel="noopener noreferrer"></a>9.1. 定制审计<a href="#91-定制审计" class="hash-link" aria-label="Direct link to 91-定制审计" title="Direct link to 91-定制审计">​</a></h3>
<p>为了定制发布的安全事件，你可以提供你自己的 <code>AbstractAuthenticationAuditListener</code> 和 <code>AbstractAuthorizationAuditListener</code> 的实现。</p>
<p>你也可以为你自己的业务事件使用审计服务。 要做到这一点，要么将 <code>AuditEventRepository</code> bean注入你自己的组件并直接使用它，要么用Spring的 <code>ApplicationEventPublisher</code> 发布 <code>AuditApplicationEvent</code>（通过实现 <code>ApplicationEventPublisherAware</code>）。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="10-记录-http-exchange"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.http-exchanges" target="_blank" rel="noopener noreferrer"></a>10. 记录 HTTP Exchange<a href="#10-记录-http-exchange" class="hash-link" aria-label="Direct link to 10-记录-http-exchange" title="Direct link to 10-记录-http-exchange">​</a></h2>
<p>你可以通过在应用程序的配置中提供一个 <code>HttpExchangeRepository</code> 类型的 bean 来启用 HTTP exchange 的记录。为了方便起见，Spring Boot 提供了 <code>InMemoryHttpExchangeRepository</code>，默认情况下，它存储了最后100个 request/response exchange。与追踪解决方案（tracing solutions）相比，<code>InMemoryHttpExchangeRepository</code> 是有限的，我们建议只在开发环境中使用它。对于生产环境，我们建议使用一个生产就绪的跟踪或观察解决方案，如 <code>Zipkin</code> 或 <code>OpenTelemetry</code>。另外，你也可以创建你自己的 <code>HttpExchangeRepository</code>。</p>
<p>你可以使用 <code>httpexchanges</code> 端点来获取存储在 <code>HttpExchangeRepository</code> 中的 request/response exchange 的信息。</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="101-自定义-http-exchange-记录"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.http-exchanges.custom" target="_blank" rel="noopener noreferrer"></a>10.1. 自定义 HTTP Exchange 记录<a href="#101-自定义-http-exchange-记录" class="hash-link" aria-label="Direct link to 101-自定义-http-exchange-记录" title="Direct link to 101-自定义-http-exchange-记录">​</a></h3>
<p>要自定义包括在每个记录的 exchange 项目，请使用 <code>management.httpexchanges.recording.include</code> 配置属性。</p>
<p>要完全禁止重新编码，请将 <code>management.httpexchanges.recording.enabled</code> 设置为 <code>false</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="11-进程监控"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring" target="_blank" rel="noopener noreferrer"></a>11. 进程监控<a href="#11-进程监控" class="hash-link" aria-label="Direct link to 11-进程监控" title="Direct link to 11-进程监控">​</a></h2>
<p>在 <code>spring-boot</code> 模块中，你可以找到两个创建文件的类，这些文件在进程监控中通常很有用。</p>
<ul>
<li>
<p><code>ApplicationPidFileWriter</code> 创建一个包含应用程序PID的文件（默认情况下，在应用程序目录下，文件名为 <code>application.pid</code>）。</p>
</li>
<li>
<p><code>WebServerPortFileWriter</code> 创建一个（或多个）文件，包含运行中的Web服务器的端口（默认情况下，在应用程序目录下 ，文件名为 <code>application.port</code>）。</p>
</li>
</ul>
<p>默认情况下，这些写手没有被激活，但你可以启用它们。</p>
<ul>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring.configuration" target="_blank" rel="noopener noreferrer">通过扩展配置</a></p>
</li>
<li>
<p><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring.programmatically" target="_blank" rel="noopener noreferrer">以编程方式实现进程监控</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="111-扩展配置"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring.configuration" target="_blank" rel="noopener noreferrer"></a>11.1. 扩展配置<a href="#111-扩展配置" class="hash-link" aria-label="Direct link to 111-扩展配置" title="Direct link to 111-扩展配置">​</a></h3>
<p>在 <code>META-INF/spring.factories</code> 文件中，你可以激活写入PID文件的listener（一个或者多个）。</p>
<p>org.springframework.context.ApplicationListener=<br>
<!-- -->org.springframework.boot.context.ApplicationPidFileWriter,<br>
<!-- -->org.springframework.boot.web.context.WebServerPortFileWriter</p>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="112-以编程方式实现进程监控"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.process-monitoring.programmatically" target="_blank" rel="noopener noreferrer"></a>11.2. 以编程方式实现进程监控<a href="#112-以编程方式实现进程监控" class="hash-link" aria-label="Direct link to 112-以编程方式实现进程监控" title="Direct link to 112-以编程方式实现进程监控">​</a></h3>
<p>你也可以通过调用 <code>SpringApplication.addListeners(…?)</code> 方法并传递适当的 <code>Writer</code> 对象来激活一个监听器。 这个方法还可以让你在 <code>Writer</code> 构造函数中自定义文件名和路径。</p>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="12-cloud-foundry-的支持"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.cloud-foundry" target="_blank" rel="noopener noreferrer"></a>12. Cloud Foundry 的支持<a href="#12-cloud-foundry-的支持" class="hash-link" aria-label="Direct link to 12-cloud-foundry-的支持" title="Direct link to 12-cloud-foundry-的支持">​</a></h2>
<p>Spring Boot 的actuator模块包括额外的支持，当您部署到兼容的 Cloud Foundry 实例时，该支持将被激活。 <code>/cloudfoundryapplication</code> 路径为所有 <code>@Endpoint</code> Bean提供了另一条安全路线。</p>
<p>扩展支持使 Cloud Foundry 管理 UI（例如您可以用来查看已部署的应用程序的 Web 应用程序）得到 Spring Boot 执行器信息的增强。 例如，应用程序状态页面可以包括完整的健康信息，而不是典型的 “running” 或 “stopped” 状态。</p>
<table><thead><tr><th></th><th>普通用户无法直接访问 <code>/cloudfoundryapplication</code> 路径。 要使用该端点，您必须在请求中传递一个有效的 UAA 令牌。</th></tr></thead></table>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="121-禁用扩展的-cloud-foundry-actuator-支持"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.cloud-foundry.disable" target="_blank" rel="noopener noreferrer"></a>12.1. 禁用扩展的 Cloud Foundry Actuator 支持<a href="#121-禁用扩展的-cloud-foundry-actuator-支持" class="hash-link" aria-label="Direct link to 121-禁用扩展的-cloud-foundry-actuator-支持" title="Direct link to 121-禁用扩展的-cloud-foundry-actuator-支持">​</a></h3>
<p>如果您想完全禁用 <code>/cloudfoundryapplication</code> 端点，您可以在您的 <code>application.properties</code> 文件中添加以下设置。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.cloudfoundry.enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="122-cloud-foundry自签名证书"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.cloud-foundry.ssl" target="_blank" rel="noopener noreferrer"></a>12.2. Cloud Foundry自签名证书<a href="#122-cloud-foundry自签名证书" class="hash-link" aria-label="Direct link to 122-cloud-foundry自签名证书" title="Direct link to 122-cloud-foundry自签名证书">​</a></h3>
<p>默认情况下，<code>/cloudfoundryapplication</code> 端点的安全验证会对各种 Cloud Foundry 服务进行 SSL 调用。 如果您的 Cloud Foundry UAA 或 Cloud Controller 服务使用自签名证书，您需要设置以下属性。</p>
<p>Properties</p>
<p>Yaml</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">management.cloudfoundry.skip-ssl-validation=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_HWLp" id="123-自定义-context-path"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.cloud-foundry.custom-context-path" target="_blank" rel="noopener noreferrer"></a>12.3. 自定义 Context Path<a href="#123-自定义-context-path" class="hash-link" aria-label="Direct link to 123-自定义-context-path" title="Direct link to 123-自定义-context-path">​</a></h3>
<p>如果服务器的 context-path 被配置为 <code>/</code> 以外的任何内容，则 Cloud Foundry 端点在应用程序的根部不可用。 例如，如果 <code>server.servlet.context-path=/app</code>，则 Cloud Foundry 端点在 <code>/app/cloudfoundryapplication/*</code> 处可用。</p>
<p>如果您希望 Cloud Foundry 端点始终在 <code>/cloudfoundryapplication/*</code> 处可用，无论服务器的上下文路径如何，您需要在您的应用程序中明确配置。 该配置因使用的 Web 服务器不同而不同。 对于 Tomcat，您可以添加以下配置。</p>
<p>Java</p>
<p>Kotlin</p>
<div class="codeBlockContainer_Ty55 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zoWS"><pre tabindex="0" class="prism-code language-text codeBlock_Po6r thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Llrq"><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration(proxyBeanMethods = false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyCloudFoundryConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TomcatServletWebServerFactory servletWebServerFactory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new TomcatServletWebServerFactory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            protected void prepareContext(Host host, ServletContextInitializer[] initializers) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                super.prepareContext(host, initializers);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                StandardContext child = new StandardContext();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                child.addLifecycleListener(new Tomcat.FixContextListener());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                child.setPath(&quot;/cloudfoundryapplication&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ServletContainerInitializer initializer = getServletContextInitializer(getContextPath());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                child.addServletContainerInitializer(initializer, Collections.emptySet());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                child.setCrossContext(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                host.addChild(child);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private ServletContainerInitializer getServletContextInitializer(String contextPath) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (classes, context) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Servlet servlet = new GenericServlet() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ServletContext context = req.getServletContext().getContext(contextPath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    context.getRequestDispatcher(&quot;/cloudfoundryapplication&quot;).forward(req, res);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context.addServlet(&quot;cloudfoundry&quot;, servlet).addMapping(&quot;/*&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_EjFN"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_RXpO" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_sabX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_WdXf"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_HWLp" id="13-接下来读什么"><a href="https://springdoc.cn/spring-boot/actuator.html#actuator.whats-next" target="_blank" rel="noopener noreferrer"></a>13. 接下来读什么<a href="#13-接下来读什么" class="hash-link" aria-label="Direct link to 13-接下来读什么" title="Direct link to 13-接下来读什么">​</a></h2>
<p>你可能想读一下 <a href="https://graphiteapp.org/" target="_blank" rel="noopener noreferrer">Graphite</a> 等图形工具。</p>
<p>否则，你可以继续阅读 <a href="https://springdoc.cn/spring-boot/deployment.html#deployment" target="_blank" rel="noopener noreferrer">“部署选项”</a> ，或者跳到前面去了解有关Spring Boot <a href="https://springdoc.cn/spring-boot/build-tool-plugins.html#build-tool-plugins" target="_blank" rel="noopener noreferrer">构建工具插</a>件的一些深入信息。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring全家桶/SpringBoot/SpringBoot生产环境工具Actuator.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_EYjg" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_eevz"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot集成Swagger实现API文档自动生成"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SpringBoot集成Swagger实现API文档自动生成</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/code-note-blog/docs/Spring全家桶/SpringBoot/SpringBoot应用也可以部署到外部Tomcat"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SpringBoot应用也可以部署到外部Tomcat</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_lc2k thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-启用生产就绪的功能" class="table-of-contents__link toc-highlight">1. 启用生产就绪的功能</a></li><li><a href="#2-端点endpoint" class="table-of-contents__link toc-highlight">2. 端点（Endpoint）</a><ul><li><a href="#21-启用端点" class="table-of-contents__link toc-highlight">2.1. 启用端点</a></li><li><a href="#22-暴露端点" class="table-of-contents__link toc-highlight">2.2. 暴露端点</a></li><li><a href="#23-安全security" class="table-of-contents__link toc-highlight">2.3. 安全（Security）</a></li><li><a href="#24-配置端点" class="table-of-contents__link toc-highlight">2.4. 配置端点</a></li><li><a href="#25-用于-actuator-web-端点的超媒体hypermedia" class="table-of-contents__link toc-highlight">2.5. 用于 Actuator Web 端点的超媒体（Hypermedia）</a></li><li><a href="#26-cors的支持" class="table-of-contents__link toc-highlight">2.6. CORS的支持</a></li><li><a href="#27-实现自定义端点" class="table-of-contents__link toc-highlight">2.7. 实现自定义端点</a></li><li><a href="#28-健康信息" class="table-of-contents__link toc-highlight">2.8. 健康信息</a></li><li><a href="#29-kubernetes-探针" class="table-of-contents__link toc-highlight">2.9. Kubernetes 探针</a></li><li><a href="#210-应用信息" class="table-of-contents__link toc-highlight">2.10. 应用信息</a></li></ul></li><li><a href="#3-通过http进行监控和管理" class="table-of-contents__link toc-highlight">3. 通过HTTP进行监控和管理</a><ul><li><a href="#31-定制管理端点路径" class="table-of-contents__link toc-highlight">3.1. 定制管 理端点路径</a></li><li><a href="#32-定制管理服务器端口" class="table-of-contents__link toc-highlight">3.2. 定制管理服务器端口</a></li><li><a href="#33-配置针对management管理层的ssl" class="table-of-contents__link toc-highlight">3.3. 配置针对Management（管理）层的SSL</a></li><li><a href="#34-定制management管理服务器地址" class="table-of-contents__link toc-highlight">3.4. 定制Management（管理）服务器地址</a></li><li><a href="#35-禁用http端点" class="table-of-contents__link toc-highlight">3.5. 禁用HTTP端点</a></li></ul></li><li><a href="#4-通过jmx进行监控和管理" class="table-of-contents__link toc-highlight">4. 通过JMX进行监控和管理</a><ul><li><a href="#41-自定义mbean名称" class="table-of-contents__link toc-highlight">4.1. 自定义MBean名称</a></li><li><a href="#42-禁用jmx端点" class="table-of-contents__link toc-highlight">4.2. 禁用JMX端点</a></li></ul></li><li><a href="#5-可观测性observability" class="table-of-contents__link toc-highlight">5. 可观测性（Observability）</a></li><li><a href="#6-日志记录器logger" class="table-of-contents__link toc-highlight">6. 日志记录器（Logger）</a><ul><li><a href="#61-配置一个-logger" class="table-of-contents__link toc-highlight">6.1. 配置一个 Logger</a></li></ul></li><li><a href="#7-指标metrics" class="table-of-contents__link toc-highlight">7. 指标（Metrics）</a><ul><li><a href="#71-入门" class="table-of-contents__link toc-highlight">7.1. 入门</a></li><li><a href="#72-支持的监控系统" class="table-of-contents__link toc-highlight">7.2. 支持的监控系统</a></li><li><a href="#73-支持的指标-metric和度量meter" class="table-of-contents__link toc-highlight">7.3. 支持的指标 （Metric）和度量（Meter）</a></li><li><a href="#74-注册自定义指标" class="table-of-contents__link toc-highlight">7.4. 注册自定义指标</a></li><li><a href="#75-定制个别指标" class="table-of-contents__link toc-highlight">7.5. 定制个别指标</a></li><li><a href="#76-指标端点" class="table-of-contents__link toc-highlight">7.6. 指标端点</a></li><li><a href="#77-整合-micrometer-observation" class="table-of-contents__link toc-highlight">7.7. 整合 Micrometer Observation</a></li></ul></li><li><a href="#8-追踪tracing" class="table-of-contents__link toc-highlight">8. 追踪（Tracing）</a><ul><li><a href="#81-支持的追踪器" class="table-of-contents__link toc-highlight">8.1. 支持的追踪器</a></li><li><a href="#82-入门" class="table-of-contents__link toc-highlight">8.2. 入门</a></li><li><a href="#83-跟踪器tracer的实现" class="table-of-contents__link toc-highlight">8.3. 跟踪器（Tracer）的实现</a></li><li><a href="#84-创建自定义跨度span" class="table-of-contents__link toc-highlight">8.4. 创建自定义跨度（span）</a></li></ul></li><li><a href="#9-审计" class="table-of-contents__link toc-highlight">9. 审计</a><ul><li><a href="#91-定制审计" class="table-of-contents__link toc-highlight">9.1. 定制审计</a></li></ul></li><li><a href="#10-记录-http-exchange" class="table-of-contents__link toc-highlight">10. 记录 HTTP Exchange</a><ul><li><a href="#101-自定义-http-exchange-记录" class="table-of-contents__link toc-highlight">10.1. 自定义 HTTP Exchange 记录</a></li></ul></li><li><a href="#11-进程监控" class="table-of-contents__link toc-highlight">11. 进程监控</a><ul><li><a href="#111-扩展配置" class="table-of-contents__link toc-highlight">11.1. 扩展配置</a></li><li><a href="#112-以编程方式实现进程监控" class="table-of-contents__link toc-highlight">11.2. 以编程方式实现进程监控</a></li></ul></li><li><a href="#12-cloud-foundry-的支持" class="table-of-contents__link toc-highlight">12. Cloud Foundry 的支持</a><ul><li><a href="#121-禁用扩展的-cloud-foundry-actuator-支持" class="table-of-contents__link toc-highlight">12.1. 禁用扩展的 Cloud Foundry Actuator 支持</a></li><li><a href="#122-cloud-foundry自签名证书" class="table-of-contents__link toc-highlight">12.2. Cloud Foundry自签名证书</a></li><li><a href="#123-自定义-context-path" class="table-of-contents__link toc-highlight">12.3. 自定义 Context Path</a></li></ul></li><li><a href="#13-接下来读什么" class="table-of-contents__link toc-highlight">13. 接下来读什么</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/code-note-blog/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/code-note-blog/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_B3Gq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>