"use strict";(self.webpackChunkcode_note_blog=self.webpackChunkcode_note_blog||[]).push([[8346],{50538:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var i=r(11527),t=r(88672);const o={},s=void 0,c={id:"Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudHystrix",title:"SpringCloudHystrix",description:"\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\uff0c\u4e00\u4e2a\u5e94\u7528\u5f80\u5f80\u7531\u591a\u4e2a\u670d\u52a1\u7ec4\u6210\uff0c\u8fd9\u4e9b\u670d\u52a1\u4e4b\u95f4\u76f8\u4e92\u4f9d\u8d56\uff0c\u4f9d\u8d56\u5173\u7cfb\u9519\u7efc\u590d\u6742\u3002",source:"@site/docs/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudHystrix.md",sourceDirName:"Spring\u5168\u5bb6\u6876/SpringCloud",slug:"/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudHystrix",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudHystrix",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudHystrix.md",tags:[],version:"current",frontMatter:{},sidebar:"spring",previous:{title:"SpringCloudGateway",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudGateway"},next:{title:"SpringCloudLoadBalancer",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringCloud/SpringCloudLoadBalancer"}},a={},d=[{value:"\u7194\u65ad\u5668",id:"\u7194\u65ad\u5668",level:2},{value:"Spring Cloud Hystrix",id:"spring-cloud-hystrix",level:2},{value:"Hystrix \u670d\u52a1\u964d\u7ea7",id:"hystrix-\u670d\u52a1\u964d\u7ea7",level:2},{value:"\u793a\u4f8b1",id:"\u793a\u4f8b1",level:2},{value:"\u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7",id:"\u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7",level:4},{value:"\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7",id:"\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7",level:4},{value:"\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5",id:"\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5",level:2},{value:"\u89e3\u8026\u964d\u7ea7\u903b\u8f91",id:"\u89e3\u8026\u964d\u7ea7\u903b\u8f91",level:2},{value:"Hystrix \u670d\u52a1\u7194\u65ad",id:"hystrix-\u670d\u52a1\u7194\u65ad",level:2},{value:"\u7194\u65ad\u72b6\u6001",id:"\u7194\u65ad\u72b6\u6001",level:4},{value:"Hystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236",id:"hystrix-\u5b9e\u73b0\u7194\u65ad\u673a\u5236",level:4},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:4},{value:"Hystrix \u6545\u969c\u76d1\u63a7",id:"hystrix-\u6545\u969c\u76d1\u63a7",level:2}];function l(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\uff0c\u4e00\u4e2a\u5e94\u7528\u5f80\u5f80\u7531\u591a\u4e2a\u670d\u52a1\u7ec4\u6210\uff0c\u8fd9\u4e9b\u670d\u52a1\u4e4b\u95f4\u76f8\u4e92\u4f9d\u8d56\uff0c\u4f9d\u8d56\u5173\u7cfb\u9519\u7efc\u590d\u6742\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4f8b\u5982\u4e00\u4e2a\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u5b58\u5728 A\u3001B\u3001C\u3001D\u3001E\u3001F \u7b49\u591a\u4e2a\u670d\u52a1\uff0c\u5b83\u4eec\u7684\u4f9d\u8d56\u5173\u7cfb\u5982\u4e0b\u56fe\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/101623H11-0.png",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"\u56fe1\uff1a\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u7528\u6237\u8bf7\u6c42\u5f80\u5f80\u9700\u8981\u591a\u4e2a\u670d\u52a1\u914d\u5408\u624d\u80fd\u5b8c\u6210\u3002\u5982\u56fe 1 \u6240\u793a\uff0c\u5728\u6240\u6709\u670d\u52a1\u90fd\u5904\u4e8e\u53ef\u7528\u72b6\u6001\u65f6\uff0c\u8bf7\u6c42 1 \u9700\u8981\u8c03\u7528 A\u3001D\u3001E\u3001F \u56db\u4e2a\u670d\u52a1\u624d\u80fd\u5b8c\u6210\uff0c\u8bf7\u6c42 2 \u9700\u8981\u8c03\u7528 B\u3001E\u3001D \u4e09\u4e2a\u670d\u52a1\u624d\u80fd\u5b8c\u6210\uff0c\u8bf7\u6c42 3 \u9700\u8981\u8c03\u7528\u670d\u52a1 C\u3001F\u3001E\u3001D \u56db\u4e2a\u670d\u52a1\u624d\u80fd\u5b8c\u6210\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u670d\u52a1 E \u53d1\u751f\u6545\u969c\u6216\u7f51\u7edc\u5ef6\u8fdf\u65f6\uff0c\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u60c5\u51b5\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5373\u4f7f\u5176\u4ed6\u6240\u6709\u670d\u52a1\u90fd\u53ef\u7528\uff0c\u7531\u4e8e\u670d\u52a1 E \u7684\u4e0d\u53ef\u7528\uff0c\u90a3\u4e48\u7528\u6237\u8bf7\u6c42 1\u30012\u30013 \u90fd\u4f1a\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1 E \u7684\u54cd\u5e94\u3002\u5728\u9ad8\u5e76\u53d1\u7684\u573a\u666f\u4e0b\uff0c\u4f1a\u5bfc\u81f4\u6574\u4e2a\u670d\u52a1\u5668\u7684\u7ebf\u7a0b\u8d44\u6e90\u5728\u77ed\u65f6\u95f4\u5185\u8fc5\u901f\u6d88\u8017\u6b86\u5c3d\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u6240\u6709\u4f9d\u8d56\u4e8e\u670d\u52a1 E \u7684\u5176\u4ed6\u670d\u52a1\uff0c\u4f8b\u5982\u670d\u52a1 B\u3001D \u4ee5\u53ca F \u4e5f\u90fd\u4f1a\u5904\u4e8e\u7ebf\u7a0b\u963b\u585e\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1 E \u7684\u54cd\u5e94\uff0c\u5bfc\u81f4\u8fd9\u4e9b\u670d\u52a1\u7684\u4e0d\u53ef\u7528\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u6240\u6709\u4f9d\u8d56\u670d\u52a1B\u3001D \u548c F \u7684\u670d\u52a1\uff0c\u4f8b\u5982\u670d\u52a1 A \u548c\u670d\u52a1 C \u4e5f\u4f1a\u5904\u4e8e\u7ebf\u7a0b\u963b\u585e\u72b6\u6001\uff0c\u4ee5\u7b49\u5f85\u670d\u52a1 D \u548c\u670d\u52a1 F \u7684\u54cd\u5e94\uff0c\u5bfc\u81f4\u670d\u52a1 A \u548c\u670d\u52a1 C \u4e5f\u4e0d\u53ef\u7528\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u4ee5\u4e0a\u8fc7\u7a0b\u53ef\u4ee5\u770b\u51fa\uff0c\u5f53\u5fae\u670d\u52a1\u7cfb\u7edf\u7684\u4e00\u4e2a\u670d\u52a1\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u6545\u969c\u4f1a\u6cbf\u7740\u670d\u52a1\u7684\u8c03\u7528\u94fe\u8def\u5728\u7cfb\u7edf\u4e2d\u75af\u72c2\u8513\u5ef6\uff0c\u6700\u7ec8\u5bfc\u81f4\u6574\u4e2a\u5fae\u670d\u52a1\u7cfb\u7edf\u7684\u762b\u75ea\uff0c\u8fd9\u5c31\u662f\u201c\u96ea\u5d29\u6548\u5e94\u201d\u3002\u4e3a\u4e86\u9632\u6b62\u6b64\u7c7b\u4e8b\u4ef6\u7684\u53d1\u751f\uff0c\u5fae\u670d\u52a1\u67b6\u6784\u5f15\u5165\u4e86\u201c\u7194\u65ad\u5668\u201d\u7684\u4e00\u7cfb\u5217\u670d\u52a1\u5bb9\u9519\u548c\u4fdd\u62a4\u673a\u5236\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u7194\u65ad\u5668",children:"\u7194\u65ad\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u7194\u65ad\u5668\uff08Circuit Breaker\uff09\u4e00\u8bcd\u6765\u6e90\u7269\u7406\u5b66\u4e2d\u7684\u7535\u8def\u77e5\u8bc6\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5f53\u7ebf\u8def\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u8fc5\u901f\u5207\u65ad\u7535\u6e90\u4ee5\u4fdd\u62a4\u7535\u8def\u7684\u5b89\u5168\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728\u5fae\u670d\u52a1\u9886\u57df\uff0c\u7194\u65ad\u5668\u6700\u65e9\u662f\u7531 Martin Fowler \u5728\u4ed6\u53d1\u8868\u7684 \u300a",(0,i.jsx)(e.a,{href:"https://martinfowler.com/bliki/CircuitBreaker.html",children:"Circuit Breake"}),"r\u300b\u4e00\u6587\u4e2d\u63d0\u51fa\u3002\u4e0e\u7269\u7406\u5b66\u4e2d\u7684\u7194\u65ad\u5668\u4f5c\u7528\u76f8\u4f3c\uff0c\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u7194\u65ad\u5668\u80fd\u591f\u5728\u67d0\u4e2a\u670d\u52a1\u53d1\u751f\u6545\u969c\u540e\uff0c\u5411\u670d\u52a1\u8c03\u7528\u65b9\u8fd4\u56de\u4e00\u4e2a\u7b26\u5408\u9884\u671f\u7684\u3001\u53ef\u5904\u7406\u7684\u964d\u7ea7\u54cd\u5e94\uff08FallBack\uff09\uff0c\u800c\u4e0d\u662f\u957f\u65f6\u95f4\u7684\u7b49\u5f85\u6216\u8005\u629b\u51fa\u8c03\u7528\u65b9\u65e0\u6cd5\u5904\u7406\u7684\u5f02\u5e38\u3002\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u670d\u52a1\u8c03\u7528\u65b9\u7684\u7ebf\u7a0b\u4e0d\u4f1a\u88ab\u957f\u65f6\u95f4\u3001\u4e0d\u5fc5\u8981\u5730\u5360\u7528\uff0c\u907f\u514d\u6545\u969c\u5728\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u7684\u8513\u5ef6\uff0c\u9632\u6b62\u7cfb\u7edf\u96ea\u5d29\u6548\u5e94\u7684\u53d1\u751f\u3002"]}),"\n",(0,i.jsx)(e.h2,{id:"spring-cloud-hystrix",children:"Spring Cloud Hystrix"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Hystrix \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u670d\u52a1\u5bb9\u9519\u4e0e\u4fdd\u62a4\u7ec4\u4ef6\uff0c\u4e5f\u662f Spring Cloud \u4e2d\u6700\u91cd\u8981\u7684\u7ec4\u4ef6\u4e4b\u4e00\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Hystrix \u662f\u57fa\u4e8e Netflix \u516c\u53f8\u7684\u5f00\u6e90\u7ec4\u4ef6 Hystrix \u5b9e\u73b0\u7684\uff0c\u5b83\u63d0\u4f9b\u4e86\u7194\u65ad\u5668\u529f\u80fd\uff0c\u80fd\u591f\u6709\u6548\u5730\u963b\u6b62\u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u51fa\u73b0\u8054\u52a8\u6545\u969c\uff0c\u4ee5\u63d0\u9ad8\u5fae\u670d\u52a1\u7cfb\u7edf\u7684\u5f39\u6027\u3002Spring Cloud Hystrix \u5177\u6709\u670d\u52a1\u964d\u7ea7\u3001\u670d\u52a1\u7194\u65ad\u3001\u7ebf\u7a0b\u9694\u79bb\u3001\u8bf7\u6c42\u7f13\u5b58\u3001\u8bf7\u6c42\u5408\u5e76\u4ee5\u53ca\u5b9e\u65f6\u6545\u969c\u76d1\u63a7\u7b49\u5f3a\u5927\u529f\u80fd\u3002"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"Hystrix [h?st'r?ks]\uff0c\u4e2d\u6587\u542b\u4e49\u662f\u8c6a\u732a\uff0c\u8c6a\u732a\u7684\u80cc\u4e0a\u957f\u6ee1\u4e86\u68d8\u523a\uff0c\u4f7f\u5b83\u62e5\u6709\u4e86\u5f3a\u5927\u7684\u81ea\u6211\u4fdd\u62a4\u80fd\u529b\u3002\u800c Spring Cloud Hystrix \u4f5c\u4e3a\u4e00\u4e2a\u670d\u52a1\u5bb9\u9519\u4e0e\u4fdd\u62a4\u7ec4\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u8ba9\u670d\u52a1\u62e5\u6709\u81ea\u6211\u4fdd\u62a4\u7684\u80fd\u529b\uff0c\u56e0\u6b64\u4e5f\u6709\u4eba\u5c06\u5176\u620f\u79f0\u4e3a\u201c\u8c6a\u732a\u54e5\u201d\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\uff0cHystrix \u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u4ee5\u4e0b\u76ee\u6807\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4fdd\u62a4\u7ebf\u7a0b\u8d44\u6e90"}),"\uff1a\u9632\u6b62\u5355\u4e2a\u670d\u52a1\u7684\u6545\u969c\u8017\u5c3d\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u8d44\u6e90\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5feb\u901f\u5931\u8d25\u673a\u5236"}),"\uff1a\u5f53\u67d0\u4e2a\u670d\u52a1\u53d1\u751f\u4e86\u6545\u969c\uff0c\u4e0d\u8ba9\u670d\u52a1\u8c03\u7528\u65b9\u4e00\u76f4\u7b49\u5f85\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\u8bf7\u6c42\u5931\u8d25\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u63d0\u4f9b\u964d\u7ea7\uff08FallBack\uff09\u65b9\u6848"}),"\uff1a\u5728\u8bf7\u6c42\u5931\u8d25\u540e\uff0c\u63d0\u4f9b\u4e00\u4e2a\u8bbe\u8ba1\u597d\u7684\u964d\u7ea7\u65b9\u6848\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u515c\u5e95\u65b9\u6cd5\uff0c\u5f53\u8bf7\u6c42\u5931\u8d25\u540e\u5373\u8c03\u7528\u8be5\u65b9\u6cd5\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9632\u6b62\u6545\u969c\u6269\u6563"}),"\uff1a\u4f7f\u7528\u7194\u65ad\u673a\u5236\uff0c\u9632\u6b62\u6545\u969c\u6269\u6563\u5230\u5176\u4ed6\u670d\u52a1\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u76d1\u63a7\u529f\u80fd"}),"\uff1a\u63d0\u4f9b\u7194\u65ad\u5668\u6545\u969c\u76d1\u63a7\u7ec4\u4ef6 Hystrix Dashboard\uff0c\u968f\u65f6\u76d1\u63a7\u7194\u65ad\u5668\u7684\u72b6\u6001\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"hystrix-\u670d\u52a1\u964d\u7ea7",children:"Hystrix \u670d\u52a1\u964d\u7ea7"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u63d0\u4f9b\u4e86\u670d\u52a1\u964d\u7ea7\u529f\u80fd\uff0c\u80fd\u591f\u4fdd\u8bc1\u5f53\u524d\u670d\u52a1\u4e0d\u53d7\u5176\u4ed6\u670d\u52a1\u6545\u969c\u7684\u5f71\u54cd\uff0c\u63d0\u9ad8\u670d\u52a1\u7684\u5065\u58ee\u6027\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u964d\u7ea7\u7684\u4f7f\u7528\u573a\u666f\u6709\u4ee5\u4e0b 2 \u79cd\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728\u670d\u52a1\u5668\u538b\u529b\u5267\u589e\u65f6\uff0c\u6839\u636e\u5b9e\u9645\u4e1a\u52a1\u60c5\u51b5\u53ca\u6d41\u91cf\uff0c\u5bf9\u4e00\u4e9b\u4e0d\u91cd\u8981\u3001\u4e0d\u7d27\u6025\u7684\u670d\u52a1\u8fdb\u884c\u6709\u7b56\u7565\u5730\u4e0d\u5904\u7406\u6216\u7b80\u5355\u5904\u7406\uff0c\u4ece\u800c\u91ca\u653e\u670d\u52a1\u5668\u8d44\u6e90\u4ee5\u4fdd\u8bc1\u6838\u5fc3\u670d\u52a1\u6b63\u5e38\u8fd0\u4f5c\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5f53\u67d0\u4e9b\u670d\u52a1\u4e0d\u53ef\u7528\u65f6\uff0c\u4e3a\u4e86\u907f\u514d\u957f\u65f6\u95f4\u7b49\u5f85\u9020\u6210\u670d\u52a1\u5361\u987f\u6216\u96ea\u5d29\u6548\u5e94\uff0c\u800c\u4e3b\u52a8\u6267\u884c\u5907\u7528\u7684\u964d\u7ea7\u903b\u8f91\u7acb\u523b\u8fd4\u56de\u4e00\u4e2a\u53cb\u597d\u7684\u63d0\u793a\uff0c\u4ee5\u4fdd\u969c\u4e3b\u4f53\u4e1a\u52a1\u4e0d\u53d7\u5f71\u54cd\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u91cd\u5199 HystrixCommand \u7684 getFallBack() \u65b9\u6cd5\u6216 HystrixObservableCommand \u7684 resumeWithFallback() \u65b9\u6cd5\uff0c\u4f7f\u670d\u52a1\u652f\u6301\u670d\u52a1\u964d\u7ea7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u670d\u52a1\u964d\u7ea7 FallBack \u65e2\u53ef\u4ee5\u653e\u5728\u670d\u52a1\u7aef\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u4f1a\u5728\u4ee5\u4e0b\u573a\u666f\u4e0b\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\u5904\u7406\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7a0b\u5e8f\u8fd0\u884c\u5f02\u5e38"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u8d85\u65f6"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u5668\u5904\u4e8e\u6253\u5f00\u72b6\u6001"}),"\n",(0,i.jsx)(e.li,{children:"\u7ebf\u7a0b\u6c60\u8d44\u6e90\u8017\u5c3d"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u793a\u4f8b1",children:"\u793a\u4f8b1"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u9762\u6211\u4eec\u5c31\u901a\u8fc7\u4e00\u4e2a\u6848\u4f8b\uff0c\u5206\u522b\u6f14\u793a\u4e0b Hystrix \u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7\u548c\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7",children:"\u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728\u4e3b\u5de5\u7a0b spring-cloud-demo2 \u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a micro-service-cloud-provider-dept-hystrix-8004 \u7684\u670d\u52a1\u63d0\u4f9b\u8005\uff0c\u5e76\u5728\u5176 pom.xml \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4f9d\u8d56\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    \x3c!--\u7236pom--\x3e\n    <parent>\n        <artifactId>spring-cloud-demo2</artifactId>\n        <groupId>net.biancheng.c</groupId>\n        <version>0.0.1-SNAPSHOT</version>\n    </parent>\n\n    <groupId>net.biancheng.c</groupId>\n    <artifactId>micro-service-cloud-provider-dept-hystrix-8004</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>micro-service-cloud-provider-dept-hystrix-8004</name>\n    <description>Demo project for Spring Boot</description>\n    <properties>\n        <java.version>1.8</java.version>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-devtools</artifactId>\n            <scope>runtime</scope>\n            <optional>true</optional>\n        </dependency>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <optional>true</optional>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n        \x3c!--\u6dfb\u52a0 Spring Boot \u7684\u76d1\u63a7\u6a21\u5757--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n        \x3c!-- eureka \u5ba2\u6237\u7aef--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n        \x3c!--hystrix \u4f9d\u8d56--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <configuration>\n                    <excludes>\n                        <exclude>\n                            <groupId>org.projectlombok</groupId>\n                            <artifactId>lombok</artifactId>\n                        </exclude>\n                    </excludes>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"2. \u5728\u7c7b\u8def\u5f84\uff08\u5373 /resources \u76ee\u5f55\uff09\u4e0b\u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6 application.yml\uff0c\u914d\u7f6e\u5185\u5bb9\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\nspring:\n  application:\n    name: microServiceCloudProviderDeptHystrix  #\u5fae\u670d\u52a1\u540d\u79f0\uff0c\u5bf9\u5916\u66b4\u6f0f\u7684\u5fae\u670d\u52a1\u540d\u79f0\uff0c\u5341\u5206\u91cd\u8981\n\nserver:\n  port: 8004\n########################################### Spring cloud \u81ea\u5b9a\u4e49\u670d\u52a1\u540d\u79f0\u548c ip \u5730\u5740###############################################\neureka:\n  client: #\u5c06\u5ba2\u6237\u7aef\u6ce8\u518c\u5230 eureka \u670d\u52a1\u5217\u8868\u5185\n    service-url:\n      #defaultZone: http://eureka7001:7001/eureka  #\u8fd9\u4e2a\u5730\u5740\u662f 7001\u6ce8\u518c\u4e2d\u5fc3\u5728 application.yml \u4e2d\u66b4\u9732\u51fa\u6765\u989d\u6ce8\u518c\u5730\u5740 \uff08\u5355\u673a\u7248\uff09\n      defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/  #\u5c06\u670d\u52a1\u6ce8\u518c\u5230 Eureka \u96c6\u7fa4\n  instance:\n    instance-id: spring-cloud-provider-8004 #\u81ea\u5b9a\u4e49\u670d\u52a1\u540d\u79f0\u4fe1\u606f\n    prefer-ip-address: true  #\u663e\u793a\u8bbf\u95ee\u8def\u5f84\u7684 ip \u5730\u5740\n#####################spring cloud \u4f7f\u7528 Spring Boot actuator \u76d1\u63a7\u5b8c\u5584\u4fe1\u606f###########################################\n# Spring Boot 2.50\u5bf9 actuator \u76d1\u63a7\u5c4f\u853d\u4e86\u5927\u591a\u6570\u7684\u8282\u70b9\uff0c\u53ea\u66b4\u9732\u4e86 heath \u8282\u70b9\uff0c\u672c\u6bb5\u914d\u7f6e\uff08*\uff09\u5c31\u662f\u4e3a\u4e86\u5f00\u542f\u6240\u6709\u7684\u8282\u70b9\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: "*"   # * \u5728yaml \u6587\u4ef6\u5c5e\u4e8e\u5173\u952e\u5b57\uff0c\u6240\u4ee5\u9700\u8981\u52a0\u5f15\u53f7\ninfo:\n  app.name: micro-service-cloud-provider-dept-hystrix\n  company.name: c.biancheng.net\n  build.aetifactId: @project.artifactId@\n  build.version: @project.version@\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"3. \u5728 net.biancheng.c.service \u5305\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a  DeptService \u7684\u63a5\u53e3\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\npackage net.biancheng.c.service;\n\npublic interface DeptService {\n\n    // hystrix \u7194\u65ad\u5668\u793a\u4f8b ok\n    public String deptInfo_Ok(Integer id);\n\n    //hystrix \u7194\u65ad\u5668\u8d85\u65f6\u6848\u4f8b\n    public String deptInfo_Timeout(Integer id);\n}\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"4. \u5728 net.biancheng.c.service.impl \u5305\u4e0b\uff0c\u521b\u5efa DeptService \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b DeptServiceImpl\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'package net.biancheng.c.service.impl;\n\nimport com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;\nimport com.netflix.hystrix.contrib.javanica.annotation.HystrixProperty;\nimport net.biancheng.c.service.DeptService;\nimport org.springframework.stereotype.Service;\n\nimport java.util.concurrent.TimeUnit;\n\n@Service("deptService")\npublic class DeptServiceImpl implements DeptService {\n\n    @Override\n    public String deptInfo_Ok(Integer id) {\n        return "\u7ebf\u7a0b\u6c60\uff1a" + Thread.currentThread().getName() + "  deptInfo_Ok,id:   " + id;\n    }\n\n    //\u4e00\u65e6\u8be5\u65b9\u6cd5\u5931\u8d25\u5e76\u629b\u51fa\u4e86\u5f02\u5e38\u4fe1\u606f\u540e\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528  @HystrixCommand \u6ce8\u89e3\u6807\u6ce8\u7684 fallbackMethod \u6307\u5b9a\u7684\u65b9\u6cd5\n    @HystrixCommand(fallbackMethod = "dept_TimeoutHandler",\n            commandProperties =\n                    //\u89c4\u5b9a 5 \u79d2\u949f\u4ee5\u5185\u5c31\u4e0d\u62a5\u9519\uff0c\u6b63\u5e38\u8fd0\u884c\uff0c\u8d85\u8fc7 5 \u79d2\u5c31\u62a5\u9519\uff0c\u8c03\u7528\u6307\u5b9a\u7684\u65b9\u6cd5\n                    {@HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "5000")})\n    @Override\n    public String deptInfo_Timeout(Integer id) {\n        int outTime = 6;\n        try {\n            TimeUnit.SECONDS.sleep(outTime);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        return "\u7ebf\u7a0b\u6c60\uff1a" + Thread.currentThread().getName() + "  deptInfo_Timeout,id:   " + id + "  \u8017\u65f6: " + outTime;\n    }\n\n    // \u5f53\u670d\u52a1\u51fa\u73b0\u6545\u969c\u540e\uff0c\u8c03\u7528\u8be5\u65b9\u6cd5\u7ed9\u51fa\u53cb\u597d\u63d0\u793a\n    public String dept_TimeoutHandler(Integer id) {\n       return  "C\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0c\u7cfb\u7edf\u7e41\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01"+"\u7ebf\u7a0b\u6c60\uff1a" + Thread.currentThread().getName() + "  deptInfo_Timeout,id:   " + id;\n    }\n}\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u53ef\u4ee5\u770b\u5230 deptInfo_Timeout() \u65b9\u6cd5\u4e0a\u4f7f\u7528 @HystrixCommand \u6ce8\u89e3\uff0c\u8be5\u6ce8\u89e3\u8bf4\u660e\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53c2\u6570 fallbackMethod \u5c5e\u6027\u7528\u4e8e\u6307\u5b9a\u964d\u7ea7\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u53c2\u6570 execution.isolation.thread.timeoutInMilliseconds \u7528\u4e8e\u8bbe\u7f6e\u81ea\u8eab\u8c03\u7528\u8d85\u65f6\u65f6\u95f4\u7684\u5cf0\u503c\uff0c\u5cf0\u503c\u5185\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff0c\u5426\u5219\u6267\u884c\u964d\u7ea7\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.ol,{start:"5",children:["\n",(0,i.jsx)(e.li,{children:"\u5728 net.biancheng.c.controller \u5305\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a DeptController \u7684 Controller \u7c7b\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\npackage net.biancheng.c.controller;\n\nimport lombok.extern.slf4j.Slf4j;\nimport net.biancheng.c.service.DeptService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.web.bind.annotation.*;\n\n@RestController\n@Slf4j\npublic class DeptController {\n    @Autowired\n    private DeptService deptService;\n    @Value("${server.port}")\n    private String serverPort;\n\n    @RequestMapping(value = "/dept/hystrix/ok/{id}")\n    public String deptInfo_Ok(@PathVariable("id") Integer id) {\n        String result = deptService.deptInfo_Ok(id);\n        log.info("\u7aef\u53e3\u53f7\uff1a" + serverPort + " result:" + result);\n        return result + "\uff0c   \u7aef\u53e3\u53f7\uff1a" + serverPort;\n    }\n\n    // Hystrix \u670d\u52a1\u8d85\u65f6\u964d\u7ea7\n    @RequestMapping(value = "/dept/hystrix/timeout/{id}")\n    public String deptInfo_Timeout(@PathVariable("id") Integer id) {\n        String result = deptService.deptInfo_Timeout(id);\n        log.info("\u7aef\u53e3\u53f7\uff1a" + serverPort + " result:" + result);\n        return result + "\uff0c   \u7aef\u53e3\u53f7\uff1a" + serverPort;\n    }\n\n}\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"6. \u5728 micro-service-cloud-provider-dept-hystrix-8004 \u7684\u4e3b\u542f\u52a8\u7c7b\u4e0a\uff0c\u4f7f\u7528 @EnableCircuitBreaker \u6ce8\u89e3\u5f00\u542f\u7194\u65ad\u5668\u529f\u80fd\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\n\npackage net.biancheng.c;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;\nimport org.springframework.cloud.netflix.eureka.EnableEurekaClient;\n\n@SpringBootApplication\n@EnableEurekaClient //\u5f00\u542f Eureka \u5ba2\u6237\u7aef\u529f\u80fd\n@EnableCircuitBreaker //\u6fc0\u6d3b\u7194\u65ad\u5668\u529f\u80fd\npublic class MicroServiceCloudProviderDeptHystrix8004Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MicroServiceCloudProviderDeptHystrix8004Application.class, args);\n    }\n\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["7. \u4f9d\u6b21\u542f\u52a8\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\uff08Eureka Server\uff09\u96c6\u7fa4\u548c micro-service-cloud-provider-dept-hystrix-8004\uff0c\u5e76\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/ok/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/ok/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016234615-1.png",alt:"Hystrix ok"}),"\n\u56fe2\uff1aHystrix \u6b63\u5e38\u670d\u52a1\u6848\u4f8b"]}),"\n",(0,i.jsxs)(e.p,{children:["8. \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/timeout/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/timeout/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/101623FR-2.png",alt:"Hystrix \u670d\u52a1\u964d\u7ea7"}),"\n\u56fe3\uff1aHystrix \u670d\u52a1\u7aef\u670d\u52a1\u964d\u7ea7"]}),"\n",(0,i.jsx)(e.h4,{id:"\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7",children:"\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u90fd\u4f1a\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\uff0c\u5f53\u5ba2\u6237\u7aef\u8c03\u7528\u7684\u670d\u52a1\u7aef\u7684\u670d\u52a1\u4e0d\u53ef\u7528\u65f6\uff0c\u5ba2\u6237\u7aef\u76f4\u63a5\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\u5904\u7406\uff0c\u907f\u514d\u5176\u7ebf\u7a0b\u88ab\u957f\u65f6\u95f4\u3001\u4e0d\u5fc5\u8981\u5730\u5360\u7528\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7\u6b65\u9aa4\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728 micro-service-cloud-consumer-dept-feign \u7684 pom.xml \u4e2d\u6dfb\u52a0 Hystrix \u7684\u4f9d\u8d56\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\n\n\x3c!--hystrix \u4f9d\u8d56--\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsx)(e.li,{children:"\u5728 micro-service-cloud-consumer-dept-feign \u7684 application.yml \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff0c\u5f00\u542f\u5ba2\u6237\u7aef\u7684 Hystrix \u529f\u80fd\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\nfeign:\n  hystrix:\n    enabled: true #\u5f00\u542f\u5ba2\u6237\u7aef hystrix\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"3. \u5728 net.biancheng.c.service \u5305\u4e0b\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a DeptHystrixService \u7684\u670d\u52a1\u7ed1\u5b9a\u63a5\u53e3\uff0c\u4e0e micro-service-cloud-provider-dept-hystrix-8004 \u4e2d\u63d0\u4f9b\u7684\u670d\u52a1\u63a5\u53e3\u8fdb\u884c\u7ed1\u5b9a\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\npackage net.biancheng.c.service;\n\nimport org.springframework.cloud.openfeign.FeignClient;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n@Component\n@FeignClient(value = "MICROSERVICECLOUDPROVIDERDEPTHYSTRIX")\npublic interface DeptHystrixService {\n    @RequestMapping(value = "/dept/hystrix/ok/{id}")\n    public String deptInfo_Ok(@PathVariable("id") Integer id);\n\n    @RequestMapping(value = "/dept/hystrix/timeout/{id}")\n    public String deptInfo_Timeout(@PathVariable("id") Integer id);\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"4. \u5728 net.biancheng.c.controller \u5305\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a HystrixController_Consumer \u7684 Controller \uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'package net.biancheng.c.controller;\n\nimport com.netflix.hystrix.contrib.javanica.annotation.DefaultProperties;\nimport com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;;\nimport lombok.extern.slf4j.Slf4j;\nimport net.biancheng.c.service.DeptHystrixService;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.annotation.Resource;\n\n@Slf4j\n@RestController\npublic class HystrixController_Consumer {\n\n    @Resource\n    private DeptHystrixService deptHystrixService;\n\n    @RequestMapping(value = "/consumer/dept/hystrix/ok/{id}")\n    public String deptInfo_Ok(@PathVariable("id") Integer id) {\n        return deptHystrixService.deptInfo_Ok(id);\n    }\n\n    //\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u964d\u7ea7\n    @RequestMapping(value = "/consumer/dept/hystrix/timeout/{id}")\n    @HystrixCommand(fallbackMethod = "dept_TimeoutHandler") //\u4e3a\u8be5\u8bf7\u6c42\u6307\u5b9a\u4e13\u5c5e\u7684\u56de\u9000\u65b9\u6cd5\n    public String deptInfo_Timeout(@PathVariable("id") Integer id) {\n        String s = deptHystrixService.deptInfo_Timeout(id);\n        log.info(s);\n        return s;\n    }\n\n    // deptInfo_Timeout\u65b9\u6cd5\u7684 \u4e13\u7528 fallback \u65b9\u6cd5\n    public String dept_TimeoutHandler(@PathVariable("id") Integer id) {\n        log.info("deptInfo_Timeout \u51fa\u9519\uff0c\u670d\u52a1\u5df2\u88ab\u964d\u7ea7\uff01");\n        return "C\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff1a\u670d\u52a1\u7aef\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01\uff08\u5ba2\u6237\u7aef deptInfo_Timeout \u4e13\u5c5e\u7684\u56de\u9000\u65b9\u6cd5\u89e6\u53d1\uff09";\n    }\n}\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"5. \u5728\u914d\u7f6e\u6587\u4ef6 appliction.yml \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff0c\u5728\u5ba2\u6237\u7aef\u914d\u7f6e\u8bf7\u6c42\u8d85\u65f6\u7684\u65f6\u95f4\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"######################### Ribbon \u5ba2\u6237\u7aef\u8d85\u65f6\u63a7\u5236 ###################################\nribbon:\n  ReadTimeout: 6000 #\u5efa\u7acb\u8fde\u63a5\u6240\u7528\u7684\u65f6\u95f4\uff0c\u9002\u7528\u4e8e\u7f51\u7edc\u72b6\u51b5\u6b63\u5e38\u7684\u60c5\u51b5\u4e0b\uff0c\u4e24\u7aef\u4e24\u7aef\u8fde\u63a5\u6240\u7528\u7684\u65f6\u95f4\n  ConnectionTimeout: 6000 #\u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u670d\u52a1\u5668\u8bfb\u53d6\u5230\u53ef\u7528\u8d44\u6e90\u7684\u65f6\u95f4\n######################\u914d\u7f6e\u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4##########################\nhystrix:\n  command:\n    default:\n      execution:\n        isolation:\n          thread:\n            timeoutInMilliseconds: 7000\n####################\u914d\u7f6e\u5177\u4f53\u65b9\u6cd5\u8d85\u65f6\u65f6\u95f4 \u4e3a 3 \u79d2########################\n    DeptHystrixService#deptInfo_Timeout(Integer):\n      execution:\n        isolation:\n          thread:\n            timeoutInMilliseconds: 3000\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u8ba1\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\u65f6\uff0c\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b 2 \u70b9\uff1a"}),"\n",(0,i.jsx)(e.p,{children:"1\uff09Hystrix \u53ef\u4ee5\u6765\u4e3a\u6240\u6709\u8bf7\u6c42\uff08\u65b9\u6cd5\uff09\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u6beb\u79d2\uff09\uff0c\u82e5\u8bf7\u6c42\u8d85\u65f6\u5219\u89e6\u53d1\u5168\u5c40\u7684\u56de\u9000\u65b9\u6cd5\u8fdb\u884c\u5904\u7406\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"hystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=mmm"})}),"\n",(0,i.jsx)(e.p,{children:"2\uff09Hystrix \u8fd8\u53ef\u4ee5\u4e3a\u67d0\u4e2a\u7279\u5b9a\u7684\u670d\u52a1\u8bf7\u6c42\uff08\u65b9\u6cd5\uff09\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"hystrix.command.xxx#yyy(zzz).execution.isolation.thread.timeoutInMilliseconds=mmm"})}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\u8bf4\u660e\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"xxx\uff1a\u4e3a\u5305\u542b\u8be5\u670d\u52a1\u65b9\u6cd5\u7684\u7c7b\u7684\u540d\u79f0\uff08\u901a\u5e38\u4e3a\u670d\u52a1\u7ed1\u5b9a\u63a5\u53e3\u7684\u540d\u79f0\uff09\uff0c\u4f8b\u5982 DeptHystrixService \u63a5\u53e3\u3002"}),"\n",(0,i.jsx)(e.li,{children:"yyy\uff1a\u670d\u52a1\u65b9\u6cd5\u540d\uff0c\u4f8b\u5982 deptInfo_Timeout() \u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.li,{children:"zzz\uff1a\u65b9\u6cd5\u5185\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u4f8b\u5982 Integer\u3001String \u7b49\u7b49"}),"\n",(0,i.jsx)(e.li,{children:"mmm\uff1a\u8981\u8bbe\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\uff081 \u79d2 =1000 \u6beb\u79d2\uff09"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"6. \u5728 micro-service-cloud-consumer-dept-feign \u7684\u4e3b\u542f\u52a8\u7c7b\u4e0a\uff0c\u4f7f\u7528 @EnableHystrix \u6ce8\u89e3\u5f00\u542f\u5ba2\u6237\u7aef Hystrix \u529f\u80fd\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\npackage net.biancheng.c;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.netflix.hystrix.EnableHystrix;\nimport org.springframework.cloud.openfeign.EnableFeignClients;\n\n@SpringBootApplication\n@EnableFeignClients //\u5f00\u542f OpenFeign \u529f\u80fd\n@EnableHystrix //\u542f\u7528 Hystrix\npublic class MicroServiceCloudConsumerDeptFeignApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MicroServiceCloudConsumerDeptFeignApplication.class, args);\n    }\n}\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"7. \u4fee\u6539 micro-service-cloud-provider-dept-hystrix-8004 \u4e2d DeptServiceImpl \u7684\u4ee3\u7801\uff0c\u5c06 deptInfo_Timeout() \u65b9\u6cd5\u7684\u8fd0\u884c\u65f6\u95f4\u4fee\u6539\u4e3a 4 \u79d2\uff08\u5c0f\u4e8e\u8d85\u65f6\u65f6\u95f4 5 \u79d2\uff09\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7aef\u8bf7\u6c42\u6b63\u5e38\u4e0d\u88ab\u964d\u7ea7\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'//\u4e00\u65e6\u8be5\u65b9\u6cd5\u5931\u8d25\u5e76\u629b\u51fa\u4e86\u5f02\u5e38\u4fe1\u606f\u540e\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528  @HystrixCommand \u6ce8\u89e3\u6807\u6ce8\u7684 fallbackMethod \u6307\u5b9a\u7684\u65b9\u6cd5\n@HystrixCommand(fallbackMethod = "dept_TimeoutHandler",\n        commandProperties =\n                //\u89c4\u5b9a 5 \u79d2\u949f\u4ee5\u5185\u5c31\u4e0d\u62a5\u9519\uff0c\u6b63\u5e38\u8fd0\u884c\uff0c\u8d85\u8fc7 5 \u79d2\u5c31\u62a5\u9519\uff0c\u8c03\u7528\u6307\u5b9a\u7684\u65b9\u6cd5\n                {@HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "5000")})\n@Override\npublic String deptInfo_Timeout(Integer id) {\n    int outTime = 4;\n    try {\n        TimeUnit.SECONDS.sleep(outTime);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n    return "\u7ebf\u7a0b\u6c60\uff1a" + Thread.currentThread().getName() + "  deptInfo_Timeout,id:   " + id + "  \u8017\u65f6: " + outTime;\n}\n\n'})}),"\n",(0,i.jsxs)(e.p,{children:["8. \u91cd\u542f micro-service-cloud-provider-dept-hystrix-8004 \u548c micro-service-cloud-consumer-dept-feign\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/timeout/1%E2%80%9D%EF%BC%8C%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84",children:"http://eureka7001.com:8004/dept/hystrix/timeout/1\u201d\uff0c\u76f4\u63a5\u8c03\u7528\u670d\u52a1\u7aef\u7684"})," deptInfo_Timeout() \u65b9\u6cd5\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016231059-3.png",alt:"Hystrix \u670d\u52a1\u7aef\u8bf7\u6c42\u6b63\u5e38"}),"\n\u56fe4\uff1aHystrix \u670d\u52a1\u7aef\u8bf7\u6c42\u6b63\u5e38"]}),"\n",(0,i.jsxs)(e.p,{children:["9. \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com/consumer/dept/hystrix/timeout/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com/consumer/dept/hystrix/timeout/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/101623C94-4.png",alt:"Hystrix \u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7"}),"\n\u56fe5\uff1aHystrix \u5ba2\u6237\u7aef\u670d\u52a1\u964d\u7ea7"]}),"\n",(0,i.jsx)(e.p,{children:"\u7531\u56fe 5 \u53ef\u4ee5\u770b\u51fa\uff0c\u7531\u4e8e\u670d\u52a1\u8bf7\u6c42\u7684\u8017\u65f6\u4e3a 4 \u79d2\uff0c\u8d85\u8fc7\u4e86\u5ba2\u6237\u7aef\u4e3a\u8be5\u8bf7\u6c42\u6307\u5b9a\u7684\u8d85\u65f6\u65f6\u95f4 \uff083 \u79d2 \uff09\uff0c\u56e0\u6b64\u8be5\u670d\u52a1\u88ab\u964d\u7ea7\u5904\u7406\uff0c\u89e6\u53d1\u4e86\u5176\u6307\u5b9a\u7684\u56de\u9000\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5",children:"\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u5f0f\u5b9e\u73b0\u670d\u52a1\u964d\u7ea7\u65f6\uff0c\u9700\u8981\u9488\u5bf9\u6240\u6709\u4e1a\u52a1\u65b9\u6cd5\u90fd\u914d\u7f6e\u964d\u7ea7\u65b9\u6cd5\uff0c\u8fd9\u6781\u6709\u53ef\u80fd\u4f1a\u9020\u6210\u4ee3\u7801\u7684\u6025\u5267\u81a8\u80c0\u3002\u4e3a\u4e86\u89e3\u51b3\u8be5\u95ee\u9898\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4e3a\u6240\u6709\u4e1a\u52a1\u65b9\u6cd5\u6307\u5b9a\u4e00\u4e2a\u5168\u5c40\u7684\u56de\u9000\u65b9\u6cd5\uff0c\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728 HystrixController_Consumer \u7684\u7c7b\u540d\u4e0a\u6807\u6ce8 @DefaultProperties \u6ce8\u89e3\uff0c\u5e76\u901a\u8fc7\u5176 defaultFallback \u5c5e\u6027\u6307\u5b9a\u4e00\u4e2a\u5168\u5c40\u7684\u964d\u7ea7\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n\n@Slf4j\n@RestController\n@DefaultProperties(defaultFallback = "dept_Global_FallbackMethod") //\u5168\u5c40\u7684\u670d\u52a1\u964d\u7ea7\u65b9\u6cd5\npublic class HystrixController_Consumer {\n\u2026\u2026\n}\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"2. \u5728 HystrixController_Consumer \u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a dept_Global_FallbackMethod \u7684\u5168\u5c40\u56de\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n\n/**\n * \u5168\u5c40\u7684 fallback \u65b9\u6cd5\uff0c\n * \u56de\u9000\u65b9\u6cd5\u5fc5\u987b\u548c hystrix \u7684\u6267\u884c\u65b9\u6cd5\u5728\u76f8\u540c\u7c7b\u4e2d\n * @DefaultProperties(defaultFallback = "dept_Global_FallbackMethod") \u7c7b\u4e0a\u6ce8\u89e3\uff0c\u8bf7\u6c42\u65b9\u6cd5\u4e0a\u4f7f\u7528 @HystrixCommand \u6ce8\u89e3\n */\npublic String dept_Global_FallbackMethod() {\n    return "C\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0c\u8fd0\u884c\u51fa\u9519\u6216\u670d\u52a1\u7aef\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01\uff08\u5ba2\u6237\u7aef\u5168\u5c40\u56de\u9000\u65b9\u6cd5\u89e6\u53d1,\uff09";\n}\n\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6ce8\u610f"}),"\uff1a\u964d\u7ea7\uff08FallBack\uff09\u65b9\u6cd5\u5fc5\u987b\u4e0e\u5176\u5bf9\u5e94\u7684\u4e1a\u52a1\u65b9\u6cd5\u5728\u540c\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u5426\u5219\u65e0\u6cd5\u751f\u6548\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:'3. \u5728\u6240\u6709\u7684\u4e1a\u52a1\u65b9\u6cd5\u4e0a\u90fd\u6807\u6ce8 @HystrixCommand \u6ce8\u89e3\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06 deptInfo_Timeout() \u65b9\u6cd5\u4e0a\u7684 @HystrixCommand(fallbackMethod = "dept_TimeoutHandler") \u4fee\u6539\u4e3a @HystrixCommand \u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b\u3002'}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n\n//\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u964d\u7ea7\n@RequestMapping(value = "/consumer/dept/hystrix/timeout/{id}")\n@HystrixCommand\npublic String deptInfo_Timeout(@PathVariable("id") Integer id) {\n    String s = deptHystrixService.deptInfo_Timeout(id);\n    log.info(s);\n    return s;\n}\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6ce8\u610f"}),"\uff1a\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5\u7684\u4f18\u5148\u7ea7\u8f83\u4f4e\uff0c\u53ea\u6709\u4e1a\u52a1\u65b9\u6cd5\u6ca1\u6709\u6307\u5b9a\u5176\u964d\u7ea7\u65b9\u6cd5\u65f6\uff0c\u670d\u52a1\u964d\u7ea7\u65f6\u624d\u4f1a\u89e6\u53d1\u5168\u5c40\u56de\u9000\u65b9\u6cd5\u3002\u82e5\u4e1a\u52a1\u65b9\u6cd5\u6307\u5b9a\u5b83\u81ea\u5df1\u7684\u56de\u9000\u65b9\u6cd5\uff0c\u90a3\u4e48\u5728\u670d\u52a1\u964d\u7ea7\u65f6\uff0c\u5c31\u53ea\u4f1a\u76f4\u63a5\u89e6\u53d1\u5b83\u81ea\u5df1\u7684\u56de\u9000\u65b9\u6cd5\uff0c\u800c\u975e\u5168\u5c40\u56de\u9000\u65b9\u6cd5\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["4. \u91cd\u542f micro-service-cloud-consumer-dept-feign\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com/consumer/dept/hystrix/timeout/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com/consumer/dept/hystrix/timeout/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/101623J11-5.png",alt:"Hystrix \u5168\u5c40\u56de\u9000\u65b9\u6cd5"}),"\n\u56fe6\uff1a\u5168\u5c40\u56de\u9000\u65b9\u6cd5"]}),"\n",(0,i.jsx)(e.h2,{id:"\u89e3\u8026\u964d\u7ea7\u903b\u8f91",children:"\u89e3\u8026\u964d\u7ea7\u903b\u8f91"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0d\u7ba1\u662f\u4e1a\u52a1\u65b9\u6cd5\u6307\u5b9a\u7684\u964d\u7ea7\u65b9\u6cd5\u8fd8\u662f\u5168\u5c40\u964d\u7ea7\u65b9\u6cd5\uff0c\u5b83\u4eec\u90fd\u5fc5\u987b\u548c\u4e1a\u52a1\u65b9\u6cd5\u5728\u540c\u4e00\u4e2a\u7c7b\u4e2d\u624d\u80fd\u751f\u6548\uff0c\u4e1a\u52a1\u903b\u8f91\u4e0e\u964d\u7ea7\u903b\u8f91\u8026\u5408\u5ea6\u6781\u9ad8\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u9762\u6211\u4eec\u5bf9\u4e1a\u52a1\u903b\u8f91\u4e0e\u964d\u7ea7\u903b\u8f91\u8fdb\u884c\u89e3\u8026\uff0c\u64cd\u4f5c\u6b65\u9aa4\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728 micro-service-cloud-consumer-dept-feign \u7684 net.biancheng.c.service \u5305\u4e0b\uff0c\u65b0\u5efa DeptHystrixService \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b DeptHystrixFallBackService\uff0c\u7edf\u4e00\u4e3a DeptHystrixService \u4e2d\u7684\u65b9\u6cd5\u63d0\u4f9b\u670d\u52a1\u964d\u7ea7\u5904\u7406 \uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\npackage net.biancheng.c.service;\nimport org.springframework.stereotype.Component;\n/**\n* Hystrix \u670d\u52a1\u964d\u7ea7\n* \u89e3\u8026\u56de\u9000\u903b\u8f91\n*/\n@Component\npublic class DeptHystrixFallBackService implements DeptHystrixService {\n    @Override\n    public String deptInfo_Ok(Integer id) {\n        return "--------------------C\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0c\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01\uff08\u89e3\u8026\u56de\u9000\u65b9\u6cd5\u89e6\u53d1\uff09-----------------------";\n    }\n    @Override\n    public String deptInfo_Timeout(Integer id) {\n        return "--------------------C\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0c\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01\uff08\u89e3\u8026\u56de\u9000\u65b9\u6cd5\u89e6\u53d1\uff09-----------------------";\n    }\n}\n\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6ce8\u610f"}),"\uff1a\u8be5\u7c7b\u5fc5\u987b\u4ee5\u7ec4\u4ef6\u7684\u5f62\u5f0f\u6dfb\u52a0 Spring \u5bb9\u5668\u4e2d\u624d\u80fd\u751f\u6548\uff0c\u6700\u5e38\u7528\u7684\u65b9\u5f0f\u5c31\u662f\u5728\u7c7b\u4e0a\u6807\u6ce8 @Component \u6ce8\u89e3\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"2. \u5728\u670d\u52a1\u7ed1\u5b9a\u63a5\u53e3 DeptHystrixService \u6807\u6ce8\u7684 @FeignClient \u6ce8\u89e3\u4e2d\u6dfb\u52a0 fallback \u5c5e\u6027\uff0c\u5c5e\u6027\u503c\u4e3a DeptHystrixFallBackService.class\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'package net.biancheng.c.service;\nimport org.springframework.cloud.openfeign.FeignClient;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\n@Component\n@FeignClient(value = "MICROSERVICECLOUDPROVIDERDEPTHYSTRIX", fallback = DeptHystrixFallBackService.class)\npublic interface DeptHystrixService {\n    @RequestMapping(value = "/dept/hystrix/ok/{id}")\n    public String deptInfo_Ok(@PathVariable("id") Integer id);\n    @RequestMapping(value = "/dept/hystrix/timeout/{id}")\n    public String deptInfo_Timeout(@PathVariable("id") Integer id);\n}\n\n'})}),"\n",(0,i.jsxs)(e.p,{children:["3. \u91cd\u542f micro-service-cloud-consumer-dept-feign\uff0c\u7136\u540e\u5173\u95ed\u670d\u52a1\u7aef micro-service-cloud-provider-dept-hystrix-8004\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com/consumer/dept/hystrix/ok/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com/consumer/dept/hystrix/ok/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016233063-6.png",alt:"Hystrix \u89e3\u8026\u56de\u9000\u903b\u8f91"}),"\n\u56fe7\uff1aHystrix \u89e3\u8026\u56de\u9000\u65b9\u6cd5"]}),"\n",(0,i.jsx)(e.h2,{id:"hystrix-\u670d\u52a1\u7194\u65ad",children:"Hystrix \u670d\u52a1\u7194\u65ad"}),"\n",(0,i.jsx)(e.p,{children:"\u7194\u65ad\u673a\u5236\u662f\u4e3a\u4e86\u5e94\u5bf9\u96ea\u5d29\u6548\u5e94\u800c\u51fa\u73b0\u7684\u4e00\u79cd\u5fae\u670d\u52a1\u94fe\u8def\u4fdd\u62a4\u673a\u5236\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e2a\u5fae\u670d\u52a1\u4e0d\u53ef\u7528\u6216\u54cd\u5e94\u65f6\u95f4\u592a\u957f\u65f6\uff0c\u4e3a\u4e86\u4fdd\u62a4\u7cfb\u7edf\u7684\u6574\u4f53\u53ef\u7528\u6027\uff0c\u7194\u65ad\u5668\u4f1a\u6682\u65f6\u5207\u65ad\u8bf7\u6c42\u5bf9\u8be5\u670d\u52a1\u7684\u8c03\u7528\uff0c\u5e76\u5feb\u901f\u8fd4\u56de\u4e00\u4e2a\u53cb\u597d\u7684\u9519\u8bef\u54cd\u5e94\u3002\u8fd9\u79cd\u7194\u65ad\u72b6\u6001\u4e0d\u662f\u6c38\u4e45\u7684\uff0c\u5728\u7ecf\u5386\u4e86\u4e00\u5b9a\u7684\u65f6\u95f4\u540e\uff0c\u7194\u65ad\u5668\u4f1a\u518d\u6b21\u68c0\u6d4b\u8be5\u5fae\u670d\u52a1\u662f\u5426\u6062\u590d\u6b63\u5e38\uff0c\u82e5\u670d\u52a1\u6062\u590d\u6b63\u5e38\u5219\u6062\u590d\u5176\u8c03\u7528\u94fe\u8def\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"\u7194\u65ad\u72b6\u6001",children:"\u7194\u65ad\u72b6\u6001"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u7194\u65ad\u673a\u5236\u4e2d\u6d89\u53ca\u4e86\u4e09\u79cd\u7194\u65ad\u72b6\u6001\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u5173\u95ed\u72b6\u6001\uff08Closed\uff09\uff1a\u5f53\u670d\u52a1\u8bbf\u95ee\u6b63\u5e38\u65f6\uff0c\u7194\u65ad\u5668\u5904\u4e8e\u5173\u95ed\u72b6\u6001\uff0c\u670d\u52a1\u8c03\u7528\u65b9\u53ef\u4ee5\u6b63\u5e38\u5730\u5bf9\u670d\u52a1\u8fdb\u884c\u8c03\u7528\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u5f00\u542f\u72b6\u6001\uff08Open\uff09\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u56fa\u5b9a\u65f6\u95f4\u5185\u63a5\u53e3\u8c03\u7528\u51fa\u9519\u6bd4\u7387\u8fbe\u5230\u4e00\u4e2a\u9608\u503c\uff08\u4f8b\u5982 50%\uff09\uff0c\u7194\u65ad\u5668\u4f1a\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u72b6\u6001\u3002\u8fdb\u5165\u7194\u65ad\u72b6\u6001\u540e\uff0c\u540e\u7eed\u5bf9\u8be5\u670d\u52a1\u7684\u8c03\u7528\u90fd\u4f1a\u88ab\u5207\u65ad\uff0c\u7194\u65ad\u5668\u4f1a\u6267\u884c\u672c\u5730\u7684\u964d\u7ea7\uff08FallBack\uff09\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u534a\u7194\u65ad\u72b6\u6001\uff08Half-Open\uff09\uff1a \u5728\u7194\u65ad\u5f00\u542f\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u7194\u65ad\u5668\u4f1a\u8fdb\u5165\u534a\u7194\u65ad\u72b6\u6001\u3002\u5728\u534a\u7194\u65ad\u72b6\u6001\u4e0b\uff0c\u7194\u65ad\u5668\u4f1a\u5c1d\u8bd5\u6062\u590d\u670d\u52a1\u8c03\u7528\u65b9\u5bf9\u670d\u52a1\u7684\u8c03\u7528\uff0c\u5141\u8bb8\u90e8\u5206\u8bf7\u6c42\u8c03\u7528\u8be5\u670d\u52a1\uff0c\u5e76\u76d1\u63a7\u5176\u8c03\u7528\u6210\u529f\u7387\u3002\u5982\u679c\u6210\u529f\u7387\u8fbe\u5230\u9884\u671f\uff0c\u5219\u8bf4\u660e\u670d\u52a1\u5df2\u6062\u590d\u6b63\u5e38\uff0c\u7194\u65ad\u5668\u8fdb\u5165\u5173\u95ed\u72b6\u6001\uff1b\u5982\u679c\u6210\u529f\u7387\u4ecd\u65e7\u5f88\u4f4e\uff0c\u5219\u91cd\u65b0\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u72b6\u6001\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e09\u79cd\u7194\u65ad\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u5316\u5173\u7cfb\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/10162355X-7.png",alt:"\u7194\u65ad\u72b6\u6001\u8f6c\u6362"}),"\n\u56fe8\uff1a\u4e09\u79cd\u7194\u65ad\u72b6\u6001\u8f6c\u6362"]}),"\n",(0,i.jsx)(e.h4,{id:"hystrix-\u5b9e\u73b0\u7194\u65ad\u673a\u5236",children:"Hystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 Spring Cloud \u4e2d\uff0c\u7194\u65ad\u673a\u5236\u662f\u901a\u8fc7 Hystrix \u5b9e\u73b0\u7684\u3002Hystrix \u4f1a\u76d1\u63a7\u5fae\u670d\u52a1\u95f4\u8c03\u7528\u7684\u72b6\u51b5\uff0c\u5f53\u5931\u8d25\u8c03\u7528\u5230\u4e00\u5b9a\u6bd4\u4f8b\u65f6\uff08\u4f8b\u5982 5 \u79d2\u5185\u5931\u8d25 20 \u6b21\uff09\uff0c\u5c31\u4f1a\u542f\u52a8\u7194\u65ad\u673a\u5236\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u5b9e\u73b0\u670d\u52a1\u7194\u65ad\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5f53\u670d\u52a1\u7684\u8c03\u7528\u51fa\u9519\u7387\u8fbe\u5230\u6216\u8d85\u8fc7 Hystix \u89c4\u5b9a\u7684\u6bd4\u7387\uff08\u9ed8\u8ba4\u4e3a 50%\uff09\u540e\uff0c\u7194\u65ad\u5668\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u5668\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u72b6\u6001\u540e\uff0cHystrix \u4f1a\u542f\u52a8\u4e00\u4e2a\u4f11\u7720\u65f6\u95f4\u7a97\uff0c\u5728\u8fd9\u4e2a\u65f6\u95f4\u7a97\u5185\uff0c\u8be5\u670d\u52a1\u7684\u964d\u7ea7\u903b\u8f91\u4f1a\u4e34\u65f6\u5145\u5f53\u4e1a\u52a1\u4e3b\u903b\u8f91\uff0c\u800c\u539f\u6765\u7684\u4e1a\u52a1\u4e3b\u903b\u8f91\u4e0d\u53ef\u7528\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5f53\u6709\u8bf7\u6c42\u518d\u6b21\u8c03\u7528\u8be5\u670d\u52a1\u65f6\uff0c\u4f1a\u76f4\u63a5\u8c03\u7528\u964d\u7ea7\u903b\u8f91\u5feb\u901f\u5730\u8fd4\u56de\u5931\u8d25\u54cd\u5e94\uff0c\u4ee5\u907f\u514d\u7cfb\u7edf\u96ea\u5d29\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5f53\u4f11\u7720\u65f6\u95f4\u7a97\u5230\u671f\u540e\uff0cHystrix \u4f1a\u8fdb\u5165\u534a\u7194\u65ad\u8f6c\u6001\uff0c\u5141\u8bb8\u90e8\u5206\u8bf7\u6c42\u5bf9\u670d\u52a1\u539f\u6765\u7684\u4e3b\u4e1a\u52a1\u903b\u8f91\u8fdb\u884c\u8c03\u7528\uff0c\u5e76\u76d1\u63a7\u5176\u8c03\u7528\u6210\u529f\u7387\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u8c03\u7528\u6210\u529f\u7387\u8fbe\u5230\u9884\u671f\uff0c\u5219\u8bf4\u660e\u670d\u52a1\u5df2\u6062\u590d\u6b63\u5e38\uff0cHystrix \u8fdb\u5165\u7194\u65ad\u5173\u95ed\u72b6\u6001\uff0c\u670d\u52a1\u539f\u6765\u7684\u4e3b\u4e1a\u52a1\u903b\u8f91\u6062\u590d\uff1b\u5426\u5219 Hystrix \u91cd\u65b0\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u72b6\u6001\uff0c\u4f11\u7720\u65f6\u95f4\u7a97\u53e3\u91cd\u65b0\u8ba1\u65f6\uff0c\u7ee7\u7eed\u91cd\u590d\u7b2c 2 \u5230\u7b2c 5 \u6b65\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u9762\u6211\u4eec\u5c31\u901a\u8fc7\u4e00\u4e2a\u5b9e\u4f8b\u6765\u9a8c\u8bc1\u4e0b Hystrix \u662f\u5982\u4f55\u5b9e\u73b0\u7194\u65ad\u673a\u5236\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728 micro-service-cloud-provider-dept-hystrix-8004 \u4e2d\u7684 DeptService \u63a5\u53e3\u4e2d\u6dfb\u52a0\u4e00\u4e2a deptCircuitBreaker() \u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\npackage net.biancheng.c.service;\npublic interface DeptService {\n    // hystrix \u7194\u65ad\u5668\u793a\u4f8b ok\n    public String deptInfo_Ok(Integer id);\n   \n    //hystrix \u7194\u65ad\u5668\u8d85\u65f6\u6848\u4f8b\n    public String deptInfo_Timeout(Integer id);\n    // Hystrix \u7194\u65ad\u673a\u5236\u6848\u4f8b\n    public String deptCircuitBreaker(Integer id);\n}\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"2. \u5728 DeptService \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b DeptServiceImpl \u6dfb\u52a0 deptCircuitBreaker() \u7684\u65b9\u6cd5\u5b9e\u73b0\u53ca\u5176\u56de\u9000\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'//Hystrix \u7194\u65ad\u6848\u4f8b\n@Override\n@HystrixCommand(fallbackMethod = "deptCircuitBreaker_fallback", commandProperties = {\n        //\u4ee5\u4e0b\u53c2\u6570\u5728 HystrixCommandProperties \u7c7b\u4e2d\u6709\u9ed8\u8ba4\u914d\u7f6e\n        @HystrixProperty(name = "circuitBreaker.enabled", value = "true"), //\u662f\u5426\u5f00\u542f\u7194\u65ad\u5668\n    @HystrixProperty(name = "metrics.rollingStats.timeInMilliseconds",value = "1000"), //\u7edf\u8ba1\u65f6\u95f4\u7a97\n        @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "10"), //\u7edf\u8ba1\u65f6\u95f4\u7a97\u5185\u8bf7\u6c42\u6b21\u6570\n        @HystrixProperty(name = "circuitBreaker.sleepWindowInMilliseconds", value = "10000"), //\u4f11\u7720\u65f6\u95f4\u7a97\u53e3\u671f\n        @HystrixProperty(name = "circuitBreaker.errorThresholdPercentage", value = "60"), //\u5728\u7edf\u8ba1\u65f6\u95f4\u7a97\u53e3\u671f\u4ee5\u5185\uff0c\u8bf7\u6c42\u5931\u8d25\u7387\u8fbe\u5230 60% \u65f6\u8fdb\u5165\u7194\u65ad\u72b6\u6001\n})\npublic String deptCircuitBreaker(Integer id) {\n    if (id < 0) {\n        //\u5f53\u4f20\u5165\u7684 id \u4e3a\u8d1f\u6570\u65f6\uff0c\u629b\u51fa\u5f02\u5e38\uff0c\u8c03\u7528\u964d\u7ea7\u65b9\u6cd5\n        throw new RuntimeException("c\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0cid \u4e0d\u80fd\u662f\u8d1f\u6570\uff01");\n    }\n    String serialNum = IdUtil.simpleUUID();\n    return Thread.currentThread().getName() + "\\t" + "\u8c03\u7528\u6210\u529f\uff0c\u6d41\u6c34\u53f7\u4e3a\uff1a" + serialNum;\n}\n\n//deptCircuitBreaker \u7684\u964d\u7ea7\u65b9\u6cd5\npublic String deptCircuitBreaker_fallback(Integer id) {\n    return "c\u8bed\u8a00\u4e2d\u6587\u7f51\u63d0\u9192\u60a8\uff0cid \u4e0d\u80fd\u662f\u8d1f\u6570,\u8bf7\u7a0d\u540e\u91cd\u8bd5!\\t id:" + id;\n}\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u4ee5\u4e0a\u4ee3\u7801\u4e2d\uff0c\u5171\u6d89\u53ca\u5230\u4e86 4 \u4e2a\u4e0e Hystrix \u7194\u65ad\u673a\u5236\u76f8\u5173\u7684\u91cd\u8981\u53c2\u6570\uff0c\u8fd9 4 \u4e2a\u53c2\u6570\u7684\u542b\u4e49\u5982\u4e0b\u8868\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u53c2\u6570"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"metrics.rollingStats.timeInMilliseconds"}),(0,i.jsx)(e.td,{children:"\u7edf\u8ba1\u65f6\u95f4\u7a97\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"circuitBreaker.sleepWindowInMilliseconds"}),(0,i.jsx)(e.td,{children:"\u4f11\u7720\u65f6\u95f4\u7a97\uff0c\u7194\u65ad\u5f00\u542f\u72b6\u6001\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u7194\u65ad\u5668\u4f1a\u81ea\u52a8\u8fdb\u5165\u534a\u7194\u65ad\u72b6\u6001\uff0c\u8fd9\u6bb5\u65f6\u95f4\u5c31\u88ab\u79f0\u4e3a\u4f11\u7720\u7a97\u53e3\u671f\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"circuitBreaker.requestVolumeThreshold"}),(0,i.jsx)(e.td,{children:"\u8bf7\u6c42\u603b\u6570\u9600\u503c\u3002\u5728\u7edf\u8ba1\u65f6\u95f4\u7a97\u5185\uff0c\u8bf7\u6c42\u603b\u6570\u5fc5\u987b\u5230\u8fbe\u4e00\u5b9a\u7684\u6570\u91cf\u7ea7\uff0cHystrix \u624d\u53ef\u80fd\u4f1a\u5c06\u7194\u65ad\u5668\u6253\u5f00\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u8f6c\u6001\uff0c\u800c\u8fd9\u4e2a\u8bf7\u6c42\u6570\u91cf\u7ea7\u5c31\u662f \u8bf7\u6c42\u603b\u6570\u9600\u503c\u3002Hystrix \u8bf7\u6c42\u603b\u6570\u9608\u503c\u9ed8\u8ba4\u4e3a 20\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u5728\u7edf\u8ba1\u65f6\u95f4\u7a97\u5185\uff0c\u5982\u679c\u670d\u52a1\u8c03\u7528\u6b21\u6570\u4e0d\u8db3 20 \u6b21\uff0c\u5373\u4f7f\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u8c03\u7528\u51fa\u9519\uff0c\u7194\u65ad\u5668\u4e5f\u4e0d\u4f1a\u6253\u5f00\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"circuitBreaker.errorThresholdPercentage"}),(0,i.jsx)(e.td,{children:"\u9519\u8bef\u767e\u5206\u6bd4\u9608\u503c\u3002\u5f53\u8bf7\u6c42\u603b\u6570\u5728\u7edf\u8ba1\u65f6\u95f4\u7a97\u5185\u8d85\u8fc7\u4e86\u8bf7\u6c42\u603b\u6570\u9600\u503c\uff0c\u4e14\u8bf7\u6c42\u8c03\u7528\u51fa\u9519\u7387\u8d85\u8fc7\u4e00\u5b9a\u7684\u6bd4\u4f8b\uff0c\u7194\u65ad\u5668\u624d\u4f1a\u6253\u5f00\u8fdb\u5165\u7194\u65ad\u5f00\u542f\u8f6c\u6001\uff0c\u800c\u8fd9\u4e2a\u6bd4\u4f8b\u5c31\u662f\u9519\u8bef\u767e\u5206\u6bd4\u9608\u503c\u3002\u9519\u8bef\u767e\u5206\u6bd4\u9608\u503c\u8bbe\u7f6e\u4e3a 50\uff0c\u5c31\u8868\u793a\u9519\u8bef\u767e\u5206\u6bd4\u4e3a 50%\uff0c\u5982\u679c\u670d\u52a1\u53d1\u751f\u4e86 30 \u6b21\u8c03\u7528\uff0c\u5176\u4e2d\u6709 15 \u6b21\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u5373\u8d85\u8fc7\u4e86 50% \u7684\u9519\u8bef\u767e\u5206\u6bd4\uff0c\u8fd9\u65f6\u5019\u5c06\u7194\u65ad\u5668\u5c31\u4f1a\u6253\u5f00\u3002"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"3. \u5728 DeptController \u4e2d\u6dfb\u52a0\u4e00\u4e2a deptCircuitBreaker() \u65b9\u6cd5\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n// Hystrix \u670d\u52a1\u7194\u65ad\n@RequestMapping(value = "/dept/hystrix/circuit/{id}")\npublic String deptCircuitBreaker(@PathVariable("id") Integer id){\n    String result = deptService.deptCircuitBreaker(id);\n    log.info("result:"+result);\n    return result;\n}\n\n'})}),"\n",(0,i.jsxs)(e.p,{children:["4. \u91cd\u542f micro-service-cloud-provider-dept-hystrix-8004\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/1%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/circuit/1\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016233Q8-8.png",alt:"Hystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236 \u8c03\u7528\u6b63\u786e"}),"\n\u56fe9\uff1aHystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236 \u8c03\u7528\u6b63\u786e\u793a\u4f8b"]}),"\n",(0,i.jsxs)(e.p,{children:["5. \u6d4f\u89c8\u5668\u591a\u6b21\uff08\u8c03\u7528\u6b21\u6570\u5927\u4e8e\u8bf7\u6c42\u603b\u6570\u9600\u503c\uff09\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/-2%E2%80%9D%EF%BC%8C%E4%BD%BF%E8%B0%83%E7%94%A8%E5%87%BA%E9%94%99%E7%8E%87%E5%A4%A7%E4%BA%8E%E9%94%99%E8%AF%AF%E7%99%BE%E5%88%86%E6%AF%94%E9%98%80%E5%80%BC%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/circuit/-2\u201d\uff0c\u4f7f\u8c03\u7528\u51fa\u9519\u7387\u5927\u4e8e\u9519\u8bef\u767e\u5206\u6bd4\u9600\u503c\uff0c\u7ed3\u679c\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/10162332D-9.png",alt:"Hystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236 \u9519\u8bef\u8c03\u7528"}),"\n\u56fe10\uff1aHystrix \u5b9e\u73b0\u7194\u65ad\u673a\u5236 \u9519\u8bef\u8c03\u7528"]}),"\n",(0,i.jsxs)(e.p,{children:["6. \u91cd\u65b0\u5c06\u53c2\u6570\u4fee\u6539\u4e3a\u6b63\u6570\uff08\u4f8b\u5982\u53c2\u6570\u4e3a 3\uff09\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/3%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/circuit/3\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016235592-10.png",alt:"Hystrix \u7194\u65ad\u5f00\u542f\u8f6c\u53f0"}),"\n\u56fe11\uff1aHystrix \u7194\u65ad\u5f00\u542f\u72b6\u6001\u4f20\u5165\u6b63\u6570"]}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u56fe 11 \u53ef\u4ee5\u770b\u5230\uff0c\u5728\u7194\u65ad\u5f00\u542f\u72b6\u6001\u4e0b\uff0c\u5373\u4f7f\u6211\u4eec\u4f20\u5165\u7684\u53c2\u6570\u5df2\u7ecf\u662f\u6b63\u6570\uff0c\u8c03\u7528\u7684\u4f9d\u7136\u964d\u7ea7\u903b\u8f91\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["7. \u7ee7\u7eed\u8fde\u7eed\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/3%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:8004/dept/hystrix/circuit/3\u201d\uff0c\u7ed3\u679c\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016231R0-11.gif",alt:"Hystrix \u7194\u65ad\u5173\u95ed"}),"\n\u56fe12\uff1aHystrix \u8fdb\u5165\u7194\u65ad\u5173\u95ed\u72b6\u6001"]}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u56fe 12 \u53ef\u4ee5\u770b\u51fa\uff0c\u5f53\u670d\u52a1\u8c03\u7528\u6b63\u786e\u7387\u4e0a\u5347\u5230\u4e00\u5b9a\u7684\u5229\u7387\u540e\uff0cHystrix \u8fdb\u5165\u7194\u65ad\u5173\u95ed\u72b6\u6001\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"hystrix-\u6545\u969c\u76d1\u63a7",children:"Hystrix \u6545\u969c\u76d1\u63a7"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u8fd8\u63d0\u4f9b\u4e86\u51c6\u5b9e\u65f6\u7684\u8c03\u7528\u76d1\u63a7\uff08Hystrix Dashboard\uff09\u529f\u80fd\uff0cHystrix \u4f1a\u6301\u7eed\u5730\u8bb0\u5f55\u6240\u6709\u901a\u8fc7 Hystrix \u53d1\u8d77\u7684\u8bf7\u6c42\u7684\u6267\u884c\u4fe1\u606f\uff0c\u5e76\u4ee5\u7edf\u8ba1\u62a5\u8868\u7684\u5f62\u5f0f\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u5305\u62ec\u6bcf\u79d2\u6267\u884c\u8bf7\u6c42\u7684\u6570\u91cf\u3001\u6210\u529f\u8bf7\u6c42\u7684\u6570\u91cf\u548c\u5931\u8d25\u8bf7\u6c42\u7684\u6570\u91cf\u7b49\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u9762\u6211\u4eec\u5c31\u901a\u8fc7\u4e00\u4e2a\u5b9e\u4f8b\u6765\u642d\u5efa Hystrix Dashboard\uff0c\u76d1\u63a7 micro-service-cloud-provider-dept-hystrix-8004 \u7684\u8fd0\u884c\u60c5\u51b5\u3002"}),"\n",(0,i.jsx)(e.p,{children:"1. \u5728\u7236\u5de5\u7a0b\u4e0b\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a micro-service-cloud-consumer-dept-hystrix-dashboard-9002 \u7684\u5b50\u6a21\u5757\uff0c\u5e76\u5728\u5176 pom.xml \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4f9d\u8d56\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    <parent>\n        <artifactId>spring-cloud-demo2</artifactId>\n        <groupId>net.biancheng.c</groupId>\n        <version>0.0.1-SNAPSHOT</version>\n    </parent>\n    <groupId>net.biancheng.c</groupId>\n    <artifactId>micro-service-cloud-consumer-dept-hystrix-dashboard-9002</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>micro-service-cloud-consumer-dept-hystrix-dashboard-9002</name>\n    <description>Demo project for Spring Boot</description>\n    <properties>\n        <java.version>1.8</java.version>\n    </properties>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter</artifactId>\n        </dependency>\n        \x3c!--Spring Boot \u6d4b\u8bd5\u4f9d\u8d56--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n        \x3c!--hystrix-dashboard \u76d1\u63a7\u7684\u4f9d\u8d56--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix-dashboard</artifactId>\n        </dependency>\n        \x3c!--\u6dfb\u52a0 Spring Boot \u7684\u76d1\u63a7\u6a21\u5757--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-devtools</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"2. \u5728 micro-service-cloud-consumer-dept-hystrix-dashboard-9002 \u7684 application.yml \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\nserver:\n  port: 9002  #\u7aef\u53e3\u53f7\n\n#http://eureka7001.com:9002/hystrix \u7194\u65ad\u5668\u76d1\u63a7\u9875\u9762\n# localhost:8004//actuator/hystrix.stream \u76d1\u63a7\u5730\u5740\nhystrix:\n  dashboard:\n    proxy-stream-allow-list:\n      - "localhost"\n\n'})}),"\n",(0,i.jsx)(e.p,{children:"3. \u5728 micro-service-cloud-consumer-dept-hystrix-dashboard-9002 \u7684\u4e3b\u542f\u52a8\u7c7b\u4e0a\u6dfb\u52a0 @EnableHystrixDashboard \u6ce8\u89e3\uff0c\u5f00\u542f Hystrix \u76d1\u63a7\u529f\u80fd\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\npackage net.biancheng.c;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;\n\n@SpringBootApplication\n@EnableHystrixDashboard\npublic class MicroServiceCloudConsumerDeptHystrixDashboard9002Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MicroServiceCloudConsumerDeptHystrixDashboard9002Application.class, args);\n    }\n\n}\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"4. \u5728 micro-service-cloud-provider-dept-hystrix-8004 \u7684 net.biancheng.c.config \u5305\u4e0b\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a HystrixDashboardConfig \u7684\u914d\u7f6e\u7c7b\uff0c\u4ee3\u7801\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\npackage net.biancheng.c.config;\n\nimport com.netflix.hystrix.contrib.metrics.eventstream.HystrixMetricsStreamServlet;\nimport org.springframework.boot.web.servlet.ServletRegistrationBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class HystrixDashboardConfig {\n    /**\n     *  Hystrix dashboard \u76d1\u63a7\u754c\u9762\u5fc5\u987b\u914d\u7f6e\n     * @return\n     */\n    @Bean\n    public ServletRegistrationBean getServlet() {\n        HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();\n        ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet);\n        registrationBean.setLoadOnStartup(1);\n        registrationBean.addUrlMappings("/actuator/hystrix.stream");//\u8bbf\u95ee\u8def\u5f84\n        registrationBean.setName("hystrix.stream");\n        return registrationBean;\n    }\n\n}\n\n'})}),"\n",(0,i.jsxs)(e.p,{children:["5. \u542f\u52a8 micro-service-cloud-consumer-dept-hystrix-dashboard-9002\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:9002/hystrix%E2%80%9D%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82",children:"http://eureka7001.com:9002/hystrix\u201d\uff0c\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016234440-12.png",alt:"Hystrix \u76d1\u63a7"}),"\n\u56fe13\uff1aHystrix \u76d1\u63a7\u9875\u9762"]}),"\n",(0,i.jsx)(e.p,{children:"6. \u91cd\u542f micro-service-cloud-provider-dept-hystrix-8004\uff0c\u5e76\u5c06\u4ee5\u4e0b\u4fe1\u606f\u586b\u5230 Hystrix \u76d1\u63a7\u9875\u9762\u4e2d\uff0c\u5982\u4e0b\u56fe\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016232636-13.png",alt:"Hystrix \u76d1\u63a7\u4fe1\u606f"}),"\n\u56fe14\uff1aHystrix \u76d1\u63a7\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.p,{children:"7. \u70b9\u51fb\u4e0b\u65b9\u7684 Monitor Stream \u6309\u94ae\uff0c\u8df3\u8f6c\u5230 Hystrix \u5bf9 micro-service-cloud-provider-dept-hystrix-8004 \u7684\u76d1\u63a7\u9875\u9762\uff0c\u5982\u4e0b\u56fe\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/1016231229-14.png",alt:"Hystrix \u76d1\u63a7 8004"}),"\n\u56fe15\uff1aHystrix \u76d1\u63a7\u5fae\u670d\u52a1\u8fd0\u884c\u60c5\u51b5"]}),"\n",(0,i.jsxs)(e.p,{children:["8. \u4f7f\u7528\u6d4f\u89c8\u5668\u591a\u6b21\u8bbf\u95ee\u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/1%E2%80%9D%E5%92%8C",children:"http://eureka7001.com:8004/dept/hystrix/circuit/1\u201d\u548c"})," \u201c",(0,i.jsx)(e.a,{href:"http://eureka7001.com:8004/dept/hystrix/circuit/-1%E2%80%9D%EF%BC%8C%E6%9F%A5%E7%9C%8B",children:"http://eureka7001.com:8004/dept/hystrix/circuit/-1\u201d\uff0c\u67e5\u770b"})," Hystrix \u76d1\u63a7\u9875\u9762\uff0c\u5982\u4e0b\u56fe\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/10162345J-15.png",alt:"Hystrix \u76d1\u63a7 8004 \u8fd0\u884c\u60c5\u51b5"}),"\n\u56fe16\uff1aHystrix \u76d1\u63a7\u670d\u52a1\u8fd0\u884c\u60c5\u51b5"]}),"\n",(0,i.jsx)(e.h1,{id:"\u53c2\u8003\u6587\u7ae0",children:"\u53c2\u8003\u6587\u7ae0"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://lijunyi.xyz/docs/SpringCloud/SpringCloud.html#_2-2-x-%E5%88%86%E6%94%AF",children:"https://lijunyi.xyz/docs/SpringCloud/SpringCloud.html#_2-2-x-%E5%88%86%E6%94%AF"}),"\n",(0,i.jsx)(e.a,{href:"https://mp.weixin.qq.com/s/2jeovmj77O9Ux96v3A0NtA",children:"https://mp.weixin.qq.com/s/2jeovmj77O9Ux96v3A0NtA"}),"\n",(0,i.jsx)(e.a,{href:"https://juejin.cn/post/6931922457741770760",children:"https://juejin.cn/post/6931922457741770760"}),"\n",(0,i.jsx)(e.a,{href:"https://github.com/D2C-Cai/herring",children:"https://github.com/D2C-Cai/herring"}),"\n",(0,i.jsx)(e.a,{href:"http://c.biancheng.net/springcloud",children:"http://c.biancheng.net/springcloud"}),"\n",(0,i.jsx)(e.a,{href:"https://github.com/macrozheng/springcloud-learning",children:"https://github.com/macrozheng/springcloud-learning"})]})]})}function p(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},88672:(n,e,r)=>{r.d(e,{Z:()=>c,a:()=>s});var i=r(50959);const t={},o=i.createContext(t);function s(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);