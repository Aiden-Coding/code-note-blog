"use strict";(self.webpackChunkcode_note_blog=self.webpackChunkcode_note_blog||[]).push([[1431],{93191:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var r=i(11527),t=i(88672);const a={},l="Spring \u6821\u9a8c",s={id:"Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6821\u9a8c\u529f\u80fd\u7684\u652f\u6301",title:"Spring \u6821\u9a8c",description:"Java API \u89c4\u8303(JSR303)\u5b9a\u4e49\u4e86Bean\u6821\u9a8c\u7684\u6807\u51c6validation-api\uff0c\u4f46\u6ca1\u6709\u63d0\u4f9b\u5b9e\u73b0\u3002hibernate validation\u662f\u5bf9\u8fd9\u4e2a\u89c4\u8303\u7684\u5b9e\u73b0\uff0c\u5e76\u589e\u52a0\u4e86\u6821\u9a8c\u6ce8\u89e3\u5982@Email\u3001@Length\u7b49\u3002Spring Validation\u662f\u5bf9hibernate validation\u7684\u4e8c\u6b21\u5c01\u88c5\uff0c\u7528\u4e8e\u652f\u6301spring mvc\u53c2\u6570\u81ea\u52a8\u6821\u9a8c\u3002",source:"@site/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6821\u9a8c\u529f\u80fd\u7684\u652f\u6301.md",sourceDirName:"Spring\u5168\u5bb6\u6876/Spring",slug:"/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6821\u9a8c\u529f\u80fd\u7684\u652f\u6301",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6821\u9a8c\u529f\u80fd\u7684\u652f\u6301",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6821\u9a8c\u529f\u80fd\u7684\u652f\u6301.md",tags:[],version:"current",frontMatter:{},sidebar:"spring",previous:{title:"Spring\u4e2d\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u8bbf\u95ee",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u8bbf\u95ee"},next:{title:"Spring \u6846\u67b6\u7684 AOP",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/SpringAOP\u7684\u6982\u5ff5\u4e0e\u4f5c\u7528"}},o={},d=[{value:"#\u5feb\u901f\u5165\u95e8",id:"\u5feb\u901f\u5165\u95e8",level:2},{value:"#\u5f15\u5165\u4f9d\u8d56",id:"\u5f15\u5165\u4f9d\u8d56",level:3},{value:"#\u6821\u9a8c\u793a\u4f8b",id:"\u6821\u9a8c\u793a\u4f8b",level:3},{value:"#\u7edf\u4e00\u5f02\u5e38\u5904\u7406",id:"\u7edf\u4e00\u5f02\u5e38\u5904\u7406",level:3},{value:"#\u8fdb\u9636\u4f7f\u7528",id:"\u8fdb\u9636\u4f7f\u7528",level:2},{value:"#\u5206\u7ec4\u6821\u9a8c",id:"\u5206\u7ec4\u6821\u9a8c",level:3},{value:"#\u5d4c\u5957\u6821\u9a8c",id:"\u5d4c\u5957\u6821\u9a8c",level:3},{value:"#\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3",id:"\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3",level:3},{value:"#\u81ea\u5b9a\u4e49\u6821\u9a8c",id:"\u81ea\u5b9a\u4e49\u6821\u9a8c",level:3},{value:"#\u5feb\u901f\u5931\u8d25(Fail Fast)",id:"\u5feb\u901f\u5931\u8d25fail-fast",level:3},{value:"#Spring \u6821\u9a8c\u539f\u7406",id:"spring-\u6821\u9a8c\u539f\u7406",level:2},{value:"#Spring \u6821\u9a8c\u4f7f\u7528\u573a\u666f",id:"spring-\u6821\u9a8c\u4f7f\u7528\u573a\u666f",level:3},{value:"#Validator \u63a5\u53e3\u8bbe\u8ba1",id:"validator-\u63a5\u53e3\u8bbe\u8ba1",level:3},{value:"#Errors \u63a5\u53e3\u8bbe\u8ba1",id:"errors-\u63a5\u53e3\u8bbe\u8ba1",level:3},{value:"#Errors \u6587\u6848\u6765\u6e90",id:"errors-\u6587\u6848\u6765\u6e90",level:3},{value:"#spring web \u6821\u9a8c\u539f\u7406",id:"spring-web-\u6821\u9a8c\u539f\u7406",level:3},{value:"#RequestBody \u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",id:"requestbody-\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",level:4},{value:"#\u65b9\u6cd5\u7ea7\u522b\u7684\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",id:"\u65b9\u6cd5\u7ea7\u522b\u7684\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",level:4},{value:"#\u95ee\u9898",id:"\u95ee\u9898",level:2},{value:"#\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"spring-\u6821\u9a8c",children:"Spring \u6821\u9a8c"}),"\n",(0,r.jsxs)(e.p,{children:["Java API \u89c4\u8303(",(0,r.jsx)(e.code,{children:"JSR303"}),")\u5b9a\u4e49\u4e86",(0,r.jsx)(e.code,{children:"Bean"}),"\u6821\u9a8c\u7684\u6807\u51c6",(0,r.jsx)(e.code,{children:"validation-api"}),"\uff0c\u4f46\u6ca1\u6709\u63d0\u4f9b\u5b9e\u73b0\u3002",(0,r.jsx)(e.code,{children:"hibernate validation"}),"\u662f\u5bf9\u8fd9\u4e2a\u89c4\u8303\u7684\u5b9e\u73b0\uff0c\u5e76\u589e\u52a0\u4e86\u6821\u9a8c\u6ce8\u89e3\u5982",(0,r.jsx)(e.code,{children:"@Email"}),"\u3001",(0,r.jsx)(e.code,{children:"@Length"}),"\u7b49\u3002",(0,r.jsx)(e.code,{children:"Spring Validation"}),"\u662f\u5bf9",(0,r.jsx)(e.code,{children:"hibernate validation"}),"\u7684\u4e8c\u6b21\u5c01\u88c5\uff0c\u7528\u4e8e\u652f\u6301",(0,r.jsx)(e.code,{children:"spring mvc"}),"\u53c2\u6570\u81ea\u52a8\u6821\u9a8c\u3002"]}),"\n",(0,r.jsxs)(e.h2,{id:"\u5feb\u901f\u5165\u95e8",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8",children:"#"}),"\u5feb\u901f\u5165\u95e8"]}),"\n",(0,r.jsxs)(e.h3,{id:"\u5f15\u5165\u4f9d\u8d56",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96",children:"#"}),"\u5f15\u5165\u4f9d\u8d56"]}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c spring-boot \u7248\u672c\u5c0f\u4e8e 2.3.x\uff0cspring-boot-starter-web \u4f1a\u81ea\u52a8\u4f20\u5165 hibernate-validator \u4f9d\u8d56\u3002\u5982\u679c spring-boot \u7248\u672c\u5927\u4e8e 2.3.x\uff0c\u5219\u9700\u8981\u624b\u52a8\u5f15\u5165\u4f9d\u8d56\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"<dependency>\n  <groupId>org.hibernate.validator</groupId>\n  hibernate-validator-parent\n  <version>6.2.5.Final</version>\n</dependency>\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5bf9\u4e8e web \u670d\u52a1\u6765\u8bf4\uff0c\u4e3a\u9632\u6b62\u975e\u6cd5\u53c2\u6570\u5bf9\u4e1a\u52a1\u9020\u6210\u5f71\u54cd\uff0c\u5728 Controller \u5c42\u4e00\u5b9a\u8981\u505a\u53c2\u6570\u6821\u9a8c\u7684\uff01\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8bf7\u6c42\u53c2\u6570\u5206\u4e3a\u5982\u4e0b\u4e24\u79cd\u5f62\u5f0f\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"POST\u3001PUT \u8bf7\u6c42\uff0c\u4f7f\u7528 requestBody \u4f20\u9012\u53c2\u6570\uff1b"}),"\n",(0,r.jsx)(e.li,{children:"GET \u8bf7\u6c42\uff0c\u4f7f\u7528 requestParam/PathVariable \u4f20\u9012\u53c2\u6570\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u9645\u4e0a\uff0c\u4e0d\u7ba1\u662f requestBody \u53c2\u6570\u6821\u9a8c\u8fd8\u662f\u65b9\u6cd5\u7ea7\u522b\u7684\u6821\u9a8c\uff0c\u6700\u7ec8\u90fd\u662f\u8c03\u7528 Hibernate Validator \u6267\u884c\u6821\u9a8c\uff0cSpring Validation \u53ea\u662f\u505a\u4e86\u4e00\u5c42\u5c01\u88c5\u3002"}),"\n",(0,r.jsxs)(e.h3,{id:"\u6821\u9a8c\u793a\u4f8b",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E6%A0%A1%E9%AA%8C%E7%A4%BA%E4%BE%8B",children:"#"}),"\u6821\u9a8c\u793a\u4f8b"]}),"\n",(0,r.jsx)(e.p,{children:"\uff081\uff09\u5728\u5b9e\u4f53\u4e0a\u6807\u8bb0\u6821\u9a8c\u6ce8\u89e3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class User implements Serializable {\n\n    @NotNull\n    private Long id;\n\n    @NotBlank\n    @Size(min = 2, max = 10)\n    private String name;\n\n    @Min(value = 1)\n    @Max(value = 100)\n    private Integer age;\n\n}\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\u58f0\u660e\u6821\u9a8c\u6ce8\u89e3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'@Slf4j\n@Validated\n@RestController\n@RequestMapping("validate1")\npublic class ValidatorController {\n\n    /**\n     * {@link RequestBody} \u53c2\u6570\u6821\u9a8c\n     */\n    @PostMapping(value = "save")\n    public DataResult<Boolean> save(@Valid @RequestBody User entity) {\n        log.info("\u4fdd\u5b58\u4e00\u6761\u8bb0\u5f55\uff1a{}", JSONUtil.toJsonStr(entity));\n        return DataResult.ok(true);\n    }\n\n    /**\n     * {@link RequestParam} \u53c2\u6570\u6821\u9a8c\n     */\n    @GetMapping(value = "queryByName")\n    public DataResult<User> queryByName(\n        @RequestParam("username")\n        @NotBlank\n        @Size(min = 2, max = 10)\n        String name\n    ) {\n        User user = new User(1L, name, 18);\n        return DataResult.ok(user);\n    }\n\n    /**\n     * {@link PathVariable} \u53c2\u6570\u6821\u9a8c\n     */\n    @GetMapping(value = "detail/{id}")\n    public DataResult<User> detail(@PathVariable("id") @Min(1L) Long id) {\n        User user = new User(id, "\u674e\u56db", 18);\n        return DataResult.ok(user);\n    }\n\n}\n\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\uff083\uff09\u5982\u679c\u8bf7\u6c42\u53c2\u6570\u4e0d\u6ee1\u8db3\u6821\u9a8c\u89c4\u5219\uff0c\u5219\u4f1a\u629b\u51fa ",(0,r.jsx)(e.code,{children:"ConstraintViolationException"})," \u6216 ",(0,r.jsx)(e.code,{children:"MethodArgumentNotValidException"})," \u5f02\u5e38\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"\u7edf\u4e00\u5f02\u5e38\u5904\u7406",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86",children:"#"}),"\u7edf\u4e00\u5f02\u5e38\u5904\u7406"]}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u901a\u5e38\u4f1a\u7528\u7edf\u4e00\u5f02\u5e38\u5904\u7406\u6765\u8fd4\u56de\u4e00\u4e2a\u66f4\u53cb\u597d\u7684\u63d0\u793a\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'@Slf4j\n@ControllerAdvice\npublic class GlobalExceptionHandler {\n\n    /**\n     * \u5904\u7406\u6240\u6709\u4e0d\u53ef\u77e5\u7684\u5f02\u5e38\n     */\n    @ResponseBody\n    @ResponseStatus(HttpStatus.OK)\n    @ExceptionHandler(Throwable.class)\n    public Result handleException(Throwable e) {\n        log.error("\u672a\u77e5\u5f02\u5e38", e);\n        return new Result(ResultStatus.HTTP_SERVER_ERROR.getCode(), e.getMessage());\n    }\n\n    /**\n     * \u7edf\u4e00\u5904\u7406\u8bf7\u6c42\u53c2\u6570\u6821\u9a8c\u5f02\u5e38(\u666e\u901a\u4f20\u53c2)\n     *\n     * @param e ConstraintViolationException\n     * @return {@link DataResult}\n     */\n    @ResponseBody\n    @ResponseStatus(HttpStatus.BAD_REQUEST)\n    @ExceptionHandler({ ConstraintViolationException.class })\n    public Result handleConstraintViolationException(final ConstraintViolationException e) {\n        log.error("ConstraintViolationException", e);\n        List<String> errors = new ArrayList<>();\n        for (ConstraintViolation<?> violation : e.getConstraintViolations()) {\n            Path path = violation.getPropertyPath();\n            List<String> pathArr = StrUtil.split(path.toString(), \',\');\n            errors.add(pathArr.get(0) + " " + violation.getMessage());\n        }\n        return new Result(ResultStatus.REQUEST_ERROR.getCode(), CollectionUtil.join(errors, ","));\n    }\n\n    /**\n     * \u5904\u7406\u53c2\u6570\u6821\u9a8c\u5f02\u5e38\n     *\n     * @param e MethodArgumentNotValidException\n     * @return {@link DataResult}\n     */\n    @ResponseBody\n    @ResponseStatus(HttpStatus.BAD_REQUEST)\n    @ExceptionHandler({ MethodArgumentNotValidException.class })\n    private Result handleMethodArgumentNotValidException(final MethodArgumentNotValidException e) {\n        log.error("MethodArgumentNotValidException", e);\n        List<String> errors = new ArrayList<>();\n        for (ObjectError error : e.getBindingResult().getAllErrors()) {\n            errors.add(((FieldError) error).getField() + " " + error.getDefaultMessage());\n        }\n        return new Result(ResultStatus.REQUEST_ERROR.getCode(), CollectionUtil.join(errors, ","));\n    }\n\n}\n\n'})}),"\n",(0,r.jsxs)(e.h2,{id:"\u8fdb\u9636\u4f7f\u7528",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8",children:"#"}),"\u8fdb\u9636\u4f7f\u7528"]}),"\n",(0,r.jsxs)(e.h3,{id:"\u5206\u7ec4\u6821\u9a8c",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%88%86%E7%BB%84%E6%A0%A1%E9%AA%8C",children:"#"}),"\u5206\u7ec4\u6821\u9a8c"]}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u53ef\u80fd\u591a\u4e2a\u65b9\u6cd5\u9700\u8981\u4f7f\u7528\u540c\u4e00\u4e2a DTO \u7c7b\u6765\u63a5\u6536\u53c2\u6570\uff0c\u800c\u4e0d\u540c\u65b9\u6cd5\u7684\u6821\u9a8c\u89c4\u5219\u5f88\u53ef\u80fd\u662f\u4e0d\u4e00\u6837\u7684\u3002\u8fd9\u4e2a\u65f6\u5019\uff0c\u7b80\u5355\u5730\u5728 DTO \u7c7b\u7684\u5b57\u6bb5\u4e0a\u52a0\u7ea6\u675f\u6ce8\u89e3\u65e0\u6cd5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u56e0\u6b64\uff0cspring-validation \u652f\u6301\u4e86\u5206\u7ec4\u6821\u9a8c\u7684\u529f\u80fd\uff0c\u4e13\u95e8\u7528\u6765\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff081\uff09\u5b9a\u4e49\u5206\u7ec4"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Target({ ElementType.FIELD, ElementType.PARAMETER })\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface AddCheck { }\n\n@Target({ ElementType.FIELD, ElementType.PARAMETER })\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface EditCheck { }\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09\u5728\u5b9e\u4f53\u4e0a\u6807\u8bb0\u6821\u9a8c\u6ce8\u89e3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'@Data\npublic class User2 {\n\n    @NotNull(groups = EditCheck.class)\n    private Long id;\n\n    @NotNull(groups = { AddCheck.class, EditCheck.class })\n    @Size(min = 2, max = 10, groups = { AddCheck.class, EditCheck.class })\n    private String name;\n\n    @IsMobile(message = "\u4e0d\u662f\u6709\u6548\u624b\u673a\u53f7", groups = { AddCheck.class, EditCheck.class })\n    private String mobile;\n\n}\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"\uff083\uff09\u5728\u65b9\u6cd5\u4e0a\u6839\u636e\u4e0d\u540c\u573a\u666f\u8fdb\u884c\u6821\u9a8c\u5206\u7ec4"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'@Slf4j\n@Validated\n@RestController\n@RequestMapping("validate2")\npublic class ValidatorController2 {\n\n    /**\n     * {@link RequestBody} \u53c2\u6570\u6821\u9a8c\n     */\n    @PostMapping(value = "add")\n    public DataResult<Boolean> add(@Validated(AddCheck.class) @RequestBody User2 entity) {\n        log.info("\u6dfb\u52a0\u4e00\u6761\u8bb0\u5f55\uff1a{}", JSONUtil.toJsonStr(entity));\n        return DataResult.ok(true);\n    }\n\n    /**\n     * {@link RequestBody} \u53c2\u6570\u6821\u9a8c\n     */\n    @PostMapping(value = "edit")\n    public DataResult<Boolean> edit(@Validated(EditCheck.class) @RequestBody User2 entity) {\n        log.info("\u7f16\u8f91\u4e00\u6761\u8bb0\u5f55\uff1a{}", JSONUtil.toJsonStr(entity));\n        return DataResult.ok(true);\n    }\n\n}\n\n'})}),"\n",(0,r.jsxs)(e.h3,{id:"\u5d4c\u5957\u6821\u9a8c",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%B5%8C%E5%A5%97%E6%A0%A1%E9%AA%8C",children:"#"}),"\u5d4c\u5957\u6821\u9a8c"]}),"\n",(0,r.jsx)(e.p,{children:"\u524d\u9762\u7684\u793a\u4f8b\u4e2d\uff0cDTO \u7c7b\u91cc\u9762\u7684\u5b57\u6bb5\u90fd\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c String \u7c7b\u578b\u3002\u4f46\u662f\u5b9e\u9645\u573a\u666f\u4e2d\uff0c\u6709\u53ef\u80fd\u67d0\u4e2a\u5b57\u6bb5\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u79cd\u60c5\u51b5\u5148\uff0c\u53ef\u4ee5\u4f7f\u7528\u5d4c\u5957\u6821\u9a8c\u3002 post \u6bd4\u5982\uff0c\u4e0a\u9762\u4fdd\u5b58 User \u4fe1\u606f\u7684\u65f6\u5019\u540c\u65f6\u8fd8\u5e26\u6709 Job \u4fe1\u606f\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u65f6 DTO \u7c7b\u7684\u5bf9\u5e94\u5b57\u6bb5\u5fc5\u987b\u6807\u8bb0@Valid \u6ce8\u89e3\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Data\npublic class UserDTO {\n\n    @Min(value = 10000000000000000L, groups = Update.class)\n    private Long userId;\n\n    @NotNull(groups = {Save.class, Update.class})\n    @Length(min = 2, max = 10, groups = {Save.class, Update.class})\n    private String userName;\n\n    @NotNull(groups = {Save.class, Update.class})\n    @Length(min = 6, max = 20, groups = {Save.class, Update.class})\n    private String account;\n\n    @NotNull(groups = {Save.class, Update.class})\n    @Length(min = 6, max = 20, groups = {Save.class, Update.class})\n    private String password;\n\n    @NotNull(groups = {Save.class, Update.class})\n    @Valid\n    private Job job;\n\n    @Data\n    public static class Job {\n\n        @Min(value = 1, groups = Update.class)\n        private Long jobId;\n\n        @NotNull(groups = {Save.class, Update.class})\n        @Length(min = 2, max = 10, groups = {Save.class, Update.class})\n        private String jobName;\n\n        @NotNull(groups = {Save.class, Update.class})\n        @Length(min = 2, max = 10, groups = {Save.class, Update.class})\n        private String position;\n    }\n\n    /**\n     * \u4fdd\u5b58\u7684\u65f6\u5019\u6821\u9a8c\u5206\u7ec4\n     */\n    public interface Save {\n    }\n\n    /**\n     * \u66f4\u65b0\u7684\u65f6\u5019\u6821\u9a8c\u5206\u7ec4\n     */\n    public interface Update {\n    }\n}\n\u590d\u5236\u4ee3\u7801\n\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5d4c\u5957\u6821\u9a8c\u53ef\u4ee5\u7ed3\u5408\u5206\u7ec4\u6821\u9a8c\u4e00\u8d77\u4f7f\u7528\u3002\u8fd8\u6709\u5c31\u662f\u5d4c\u5957\u96c6\u5408\u6821\u9a8c\u4f1a\u5bf9\u96c6\u5408\u91cc\u9762\u7684\u6bcf\u4e00\u9879\u90fd\u8fdb\u884c\u6821\u9a8c\uff0c\u4f8b\u5982",(0,r.jsx)(e.code,{children:"List<Job>"}),"\u5b57\u6bb5\u4f1a\u5bf9\u8fd9\u4e2a list \u91cc\u9762\u7684\u6bcf\u4e00\u4e2a Job \u5bf9\u8c61\u90fd\u8fdb\u884c\u6821\u9a8c"]}),"\n",(0,r.jsxs)(e.h3,{id:"\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3",children:"#"}),"\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3"]}),"\n",(0,r.jsxs)(e.p,{children:["\uff081\uff09\u81ea\u5b9a\u4e49\u6821\u9a8c\u6ce8\u89e3 ",(0,r.jsx)(e.code,{children:"@IsMobile"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })\n@Retention(RUNTIME)\n@Constraint(validatedBy = MobileValidator.class)\npublic @interface IsMobile {\n\n    String message();\n\n    Class<?>[] groups() default {};\n\n    Class<? extends Payload>[] payload() default {};\n\n}\n\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\uff082\uff09\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"ConstraintValidator"})," \u63a5\u53e3\uff0c\u7f16\u5199 ",(0,r.jsx)(e.code,{children:"@IsMobile"})," \u6821\u9a8c\u6ce8\u89e3\u7684\u89e3\u6790\u5668"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"import cn.hutool.core.util.StrUtil;\nimport io.github.dunwu.spring.core.validation.annotation.IsMobile;\nimport io.github.dunwu.tool.util.ValidatorUtil;\n\nimport javax.validation.ConstraintValidator;\nimport javax.validation.ConstraintValidatorContext;\n\npublic class MobileValidator implements ConstraintValidator<IsMobile, String> {\n\n    @Override\n    public void initialize(IsMobile isMobile) { }\n\n    @Override\n    public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) {\n        if (StrUtil.isBlank(s)) {\n            return false;\n        } else {\n            return ValidatorUtil.isMobile(s);\n        }\n    }\n\n}\n\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"\u81ea\u5b9a\u4e49\u6821\u9a8c",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C",children:"#"}),"\u81ea\u5b9a\u4e49\u6821\u9a8c"]}),"\n",(0,r.jsxs)(e.p,{children:["\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"org.springframework.validation.Validator"})," \u63a5\u53e3\u6765\u81ea\u5b9a\u4e49\u6821\u9a8c\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u6709\u4ee5\u4e0b\u8981\u70b9"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"supports"})," \u65b9\u6cd5"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"validate"})," \u65b9\u6cd5","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"Errors"})," \u5bf9\u8c61\u6536\u96c6\u9519\u8bef","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"ObjectError"}),"\uff1a\u5bf9\u8c61\uff08Bean\uff09\u9519\u8bef\uff1a"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"FieldError"}),"\uff1a\u5bf9\u8c61\uff08Bean\uff09\u5c5e\u6027\uff08Property\uff09\u9519\u8bef"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"ObjectError"})," \u548c ",(0,r.jsx)(e.code,{children:"FieldError"})," \u5173\u8054 ",(0,r.jsx)(e.code,{children:"MessageSource"})," \u5b9e\u73b0\u83b7\u53d6\u6700\u7ec8\u7684\u9519\u8bef\u6587\u6848"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'package io.github.dunwu.spring.core.validation;\n\nimport io.github.dunwu.spring.core.validation.annotation.Valid;\nimport io.github.dunwu.spring.core.validation.config.CustomValidatorConfig;\nimport io.github.dunwu.spring.core.validation.entity.Person;\nimport org.springframework.stereotype.Component;\nimport org.springframework.validation.Errors;\nimport org.springframework.validation.ValidationUtils;\nimport org.springframework.validation.Validator;\n\nimport java.lang.annotation.Annotation;\nimport java.lang.reflect.Field;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.List;\n\n@Component\npublic class CustomValidator implements Validator {\n\n    private final CustomValidatorConfig validatorConfig;\n\n    public CustomValidator(CustomValidatorConfig validatorConfig) {\n        this.validatorConfig = validatorConfig;\n    }\n\n    /**\n     * \u672c\u6821\u9a8c\u5668\u53ea\u9488\u5bf9 Person \u5bf9\u8c61\u8fdb\u884c\u6821\u9a8c\n     */\n    @Override\n    public boolean supports(Class<?> clazz) {\n        return Person.class.equals(clazz);\n    }\n\n    @Override\n    public void validate(Object target, Errors errors) {\n        ValidationUtils.rejectIfEmpty(errors, "name", "name.empty");\n\n        List<Field> fields = getFields(target.getClass());\n        for (Field field : fields) {\n            Annotation[] annotations = field.getAnnotations();\n            for (Annotation annotation : annotations) {\n                if (annotation.annotationType().getAnnotation(Valid.class) != null) {\n                    try {\n                        ValidatorRule validatorRule = validatorConfig.findRule(annotation);\n                        if (validatorRule != null) {\n                            validatorRule.valid(annotation, target, field, errors);\n                        }\n                    } catch (Exception e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }\n    }\n\n    private List<Field> getFields(Class<?> clazz) {\n        // \u58f0\u660eField\u6570\u7ec4\n        List<Field> fields = new ArrayList<>();\n        // \u5982\u679cclass\u7c7b\u578b\u4e0d\u4e3a\u7a7a\n        while (clazz != null) {\n            // \u6dfb\u52a0\u5c5e\u6027\u5230\u5c5e\u6027\u6570\u7ec4\n            Collections.addAll(fields, clazz.getDeclaredFields());\n            clazz = clazz.getSuperclass();\n        }\n        return fields;\n    }\n\n}\n\n'})}),"\n",(0,r.jsxs)(e.h3,{id:"\u5feb\u901f\u5931\u8d25fail-fast",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%BF%AB%E9%80%9F%E5%A4%B1%E8%B4%A5-fail-fast",children:"#"}),"\u5feb\u901f\u5931\u8d25(Fail Fast)"]}),"\n",(0,r.jsx)(e.p,{children:"Spring Validation \u9ed8\u8ba4\u4f1a\u6821\u9a8c\u5b8c\u6240\u6709\u5b57\u6bb5\uff0c\u7136\u540e\u624d\u629b\u51fa\u5f02\u5e38\u3002\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u7684\u914d\u7f6e\uff0c\u5f00\u542f Fali Fast \u6a21\u5f0f\uff0c\u4e00\u65e6\u6821\u9a8c\u5931\u8d25\u5c31\u7acb\u5373\u8fd4\u56de\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Bean\npublic Validator validator() {\n    ValidatorFactory validatorFactory = Validation.byProvider(HibernateValidator.class)\n            .configure()\n            // \u5feb\u901f\u5931\u8d25\u6a21\u5f0f\n            .failFast(true)\n            .buildValidatorFactory();\n    return validatorFactory.getValidator();\n}\n\n"})}),"\n",(0,r.jsxs)(e.h2,{id:"spring-\u6821\u9a8c\u539f\u7406",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#spring-%E6%A0%A1%E9%AA%8C%E5%8E%9F%E7%90%86",children:"#"}),"Spring \u6821\u9a8c\u539f\u7406"]}),"\n",(0,r.jsxs)(e.h3,{id:"spring-\u6821\u9a8c\u4f7f\u7528\u573a\u666f",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#spring-%E6%A0%A1%E9%AA%8C%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF",children:"#"}),"Spring \u6821\u9a8c\u4f7f\u7528\u573a\u666f"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Spring \u5e38\u89c4\u6821\u9a8c\uff08Validator\uff09"}),"\n",(0,r.jsx)(e.li,{children:"Spring \u6570\u636e\u7ed1\u5b9a\uff08DataBinder\uff09"}),"\n",(0,r.jsx)(e.li,{children:"Spring Web \u53c2\u6570\u7ed1\u5b9a\uff08WebDataBinder\uff09"}),"\n",(0,r.jsx)(e.li,{children:"Spring WebMVC/WebFlux \u5904\u7406\u65b9\u6cd5\u53c2\u6570\u6821\u9a8c"}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"validator-\u63a5\u53e3\u8bbe\u8ba1",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#validator-%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1",children:"#"}),"Validator \u63a5\u53e3\u8bbe\u8ba1"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u63a5\u53e3\u804c\u8d23","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Spring \u5185\u90e8\u6821\u9a8c\u5668\u63a5\u53e3\uff0c\u901a\u8fc7\u7f16\u7a0b\u7684\u65b9\u5f0f\u6821\u9a8c\u76ee\u6807\u5bf9\u8c61"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u6838\u5fc3\u65b9\u6cd5","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"supports(Class)"}),"\uff1a\u6821\u9a8c\u76ee\u6807\u7c7b\u80fd\u5426\u6821\u9a8c"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"validate(Object,Errors)"}),"\uff1a\u6821\u9a8c\u76ee\u6807\u5bf9\u8c61\uff0c\u5e76\u5c06\u6821\u9a8c\u5931\u8d25\u7684\u5185\u5bb9\u8f93\u51fa\u81f3 Errors \u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u914d\u5957\u7ec4\u4ef6","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u9519\u8bef\u6536\u96c6\u5668\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.Errors"})]}),"\n",(0,r.jsxs)(e.li,{children:["Validator \u5de5\u5177\u7c7b\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.ValidationUtils"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"errors-\u63a5\u53e3\u8bbe\u8ba1",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#errors-%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1",children:"#"}),"Errors \u63a5\u53e3\u8bbe\u8ba1"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u63a5\u53e3\u804c\u8d23","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u6570\u636e\u7ed1\u5b9a\u548c\u6821\u9a8c\u9519\u8bef\u6536\u96c6\u63a5\u53e3\uff0c\u4e0e Java Bean \u548c\u5176\u5c5e\u6027\u6709\u5f3a\u5173\u8054\u6027"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u6838\u5fc3\u65b9\u6cd5","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"reject"})," \u65b9\u6cd5\uff08\u91cd\u8f7d\uff09\uff1a\u6536\u96c6\u9519\u8bef\u6587\u6848"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"rejectValue"})," \u65b9\u6cd5\uff08\u91cd\u8f7d\uff09\uff1a\u6536\u96c6\u5bf9\u8c61\u5b57\u6bb5\u4e2d\u7684\u9519\u8bef\u6587\u6848"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u914d\u5957\u7ec4\u4ef6","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Java Bean \u9519\u8bef\u63cf\u8ff0\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.ObjectError"})]}),"\n",(0,r.jsxs)(e.li,{children:["Java Bean \u5c5e\u6027\u9519\u8bef\u63cf\u8ff0\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.FieldError"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"errors-\u6587\u6848\u6765\u6e90",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#errors-%E6%96%87%E6%A1%88%E6%9D%A5%E6%BA%90",children:"#"}),"Errors \u6587\u6848\u6765\u6e90"]}),"\n",(0,r.jsx)(e.p,{children:"Errors \u6587\u6848\u751f\u6210\u6b65\u9aa4"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u9009\u62e9 Errors \u5b9e\u73b0\uff08\u5982\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.BeanPropertyBindingResult"}),"\uff09"]}),"\n",(0,r.jsx)(e.li,{children:"\u8c03\u7528 reject \u6216 rejectValue \u65b9\u6cd5"}),"\n",(0,r.jsx)(e.li,{children:"\u83b7\u53d6 Errors \u5bf9\u8c61\u4e2d ObjectError \u6216 FieldError"}),"\n",(0,r.jsxs)(e.li,{children:["\u5c06 ObjectError \u6216 FieldError \u4e2d\u7684 code \u548c args\uff0c\u5173\u8054 MessageSource \u5b9e\u73b0\uff08\u5982\uff1a",(0,r.jsx)(e.code,{children:"ResourceBundleMessageSource"}),"\uff09"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"spring-web-\u6821\u9a8c\u539f\u7406",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#spring-web-%E6%A0%A1%E9%AA%8C%E5%8E%9F%E7%90%86",children:"#"}),"spring web \u6821\u9a8c\u539f\u7406"]}),"\n",(0,r.jsxs)(e.h4,{id:"requestbody-\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#requestbody-%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86",children:"#"}),"RequestBody \u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5728 spring-mvc \u4e2d\uff0c",(0,r.jsx)(e.code,{children:"RequestResponseBodyMethodProcessor"})," \u662f\u7528\u4e8e\u89e3\u6790 ",(0,r.jsx)(e.code,{children:"@RequestBody"})," \u6807\u6ce8\u7684\u53c2\u6570\u4ee5\u53ca\u5904\u7406",(0,r.jsx)(e.code,{children:"@ResponseBody"})," \u6807\u6ce8\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7684\u3002\u5176\u4e2d\uff0c\u6267\u884c\u53c2\u6570\u6821\u9a8c\u7684\u903b\u8f91\u80af\u5b9a\u5c31\u5728\u89e3\u6790\u53c2\u6570\u7684\u65b9\u6cd5 ",(0,r.jsx)(e.code,{children:"resolveArgument()"})," \u4e2d\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Override\npublic Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,\n    NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception {\n\n    parameter = parameter.nestedIfOptional();\n    Object arg = readWithMessageConverters(webRequest, parameter, parameter.getNestedGenericParameterType());\n    String name = Conventions.getVariableNameForParameter(parameter);\n\n    if (binderFactory != null) {\n        WebDataBinder binder = binderFactory.createBinder(webRequest, arg, name);\n        if (arg != null) {\n            // \u5c1d\u8bd5\u8fdb\u884c\u53c2\u6570\u6821\u9a8c\n            validateIfApplicable(binder, parameter);\n            if (binder.getBindingResult().hasErrors() && isBindExceptionRequired(binder, parameter)) {\n                // \u5982\u679c\u5b58\u5728\u6821\u9a8c\u9519\u8bef\uff0c\u5219\u629b\u51fa MethodArgumentNotValidException\n                throw new MethodArgumentNotValidException(parameter, binder.getBindingResult());\n            }\n        }\n        if (mavContainer != null) {\n            mavContainer.addAttribute(BindingResult.MODEL_KEY_PREFIX + name, binder.getBindingResult());\n        }\n    }\n\n    return adaptArgumentIfNecessary(arg, parameter);\n}\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53ef\u4ee5\u770b\u5230\uff0cresolveArgument()\u8c03\u7528\u4e86 validateIfApplicable()\u8fdb\u884c\u53c2\u6570\u6821\u9a8c\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'protected void validateIfApplicable(WebDataBinder binder, MethodParameter parameter) {\n    // \u83b7\u53d6\u53c2\u6570\u6ce8\u89e3\uff0c\u5982 @RequestBody\u3001@Valid\u3001@Validated\n    Annotation[] annotations = parameter.getParameterAnnotations();\n    for (Annotation ann : annotations) {\n        // \u5148\u5c1d\u8bd5\u83b7\u53d6 @Validated \u6ce8\u89e3\n        Validated validatedAnn = AnnotationUtils.getAnnotation(ann, Validated.class);\n        // \u5982\u679c\u6807\u6ce8\u4e86 @Validated\uff0c\u76f4\u63a5\u5f00\u59cb\u6821\u9a8c\u3002\n        // \u5982\u679c\u6ca1\u6709\uff0c\u90a3\u4e48\u5224\u65ad\u53c2\u6570\u524d\u662f\u5426\u6709 Valid \u5f00\u5934\u7684\u6ce8\u89e3\u3002\n        if (validatedAnn != null || ann.annotationType().getSimpleName().startsWith("Valid")) {\n            Object hints = (validatedAnn != null ? validatedAnn.value() : AnnotationUtils.getValue(ann));\n            Object[] validationHints = (hints instanceof Object[] ? (Object[]) hints : new Object[] {hints});\n            // \u6267\u884c\u6821\u9a8c\n            binder.validate(validationHints);\n            break;\n        }\n    }\n}\n\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5c31\u89e3\u91ca\u4e86 Spring \u4e3a\u4ec0\u4e48\u80fd\u540c\u65f6\u652f\u6301 ",(0,r.jsx)(e.code,{children:"@Validated"}),"\u3001",(0,r.jsx)(e.code,{children:"@Valid"})," \u4e24\u4e2a\u6ce8\u89e3\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u4e0b\u6765\uff0c\u770b\u4e00\u4e0b WebDataBinder.validate() \u7684\u5b9e\u73b0\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"@Override\npublic void validate(Object target, Errors errors, Object... validationHints) {\n    if (this.targetValidator != null) {\n        processConstraintViolations(\n            // \u6b64\u5904\u8c03\u7528 Hibernate Validator \u6267\u884c\u771f\u6b63\u7684\u6821\u9a8c\n            this.targetValidator.validate(target, asValidationGroups(validationHints)), errors);\n    }\n}\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u901a\u8fc7\u4e0a\u9762\u4ee3\u7801\uff0c\u53ef\u4ee5\u770b\u51fa Spring \u6821\u9a8c\u5b9e\u9645\u4e0a\u662f\u57fa\u4e8e Hibernate Validator \u7684\u5c01\u88c5\u3002"}),"\n",(0,r.jsxs)(e.h4,{id:"\u65b9\u6cd5\u7ea7\u522b\u7684\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E6%96%B9%E6%B3%95%E7%BA%A7%E5%88%AB%E7%9A%84%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86",children:"#"}),"\u65b9\u6cd5\u7ea7\u522b\u7684\u53c2\u6570\u6821\u9a8c\u5b9e\u73b0\u539f\u7406"]}),"\n",(0,r.jsxs)(e.p,{children:["Spring \u652f\u6301\u6839\u636e\u65b9\u6cd5\u53bb\u8fdb\u884c\u62e6\u622a\u3001\u6821\u9a8c\uff0c\u539f\u7406\u5c31\u5728\u4e8e\u5e94\u7528\u4e86 AOP \u6280\u672f\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u662f\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"MethodValidationPostProcessor"})," \u52a8\u6001\u6ce8\u518c AOP \u5207\u9762\uff0c\u7136\u540e\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"MethodValidationInterceptor"})," \u5bf9\u5207\u70b9\u65b9\u6cd5\u7ec7\u5165\u589e\u5f3a\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"public class MethodValidationPostProcessor extends AbstractBeanFactoryAwareAdvisingPostProcessorimplements InitializingBean {\n    @Override\n    public void afterPropertiesSet() {\n        // \u4e3a\u6240\u6709 @Validated \u6807\u6ce8\u7684 Bean \u521b\u5efa\u5207\u9762\n        Pointcut pointcut = new AnnotationMatchingPointcut(this.validatedAnnotationType, true);\n        // \u521b\u5efa Advisor \u8fdb\u884c\u589e\u5f3a\n        this.advisor = new DefaultPointcutAdvisor(pointcut, createMethodValidationAdvice(this.validator));\n    }\n\n    // \u521b\u5efa Advice\uff0c\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u65b9\u6cd5\u62e6\u622a\u5668\n    protected Advice createMethodValidationAdvice(@Nullable Validator validator) {\n        return (validator != null ? new MethodValidationInterceptor(validator) : new MethodValidationInterceptor());\n    }\n}\n\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u63a5\u7740\u770b\u4e00\u4e0b ",(0,r.jsx)(e.code,{children:"MethodValidationInterceptor"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"public class MethodValidationInterceptor implements MethodInterceptor {\n    @Override\n    public Object invoke(MethodInvocation invocation) throws Throwable {\n        // \u65e0\u9700\u589e\u5f3a\u7684\u65b9\u6cd5\uff0c\u76f4\u63a5\u8df3\u8fc7\n        if (isFactoryBeanMetadataMethod(invocation.getMethod())) {\n            return invocation.proceed();\n        }\n        // \u83b7\u53d6\u5206\u7ec4\u4fe1\u606f\n        Class<?>[] groups = determineValidationGroups(invocation);\n        ExecutableValidator execVal = this.validator.forExecutables();\n        Method methodToValidate = invocation.getMethod();\n        Set<ConstraintViolation<Object>> result;\n        try {\n            // \u65b9\u6cd5\u5165\u53c2\u6821\u9a8c\uff0c\u6700\u7ec8\u8fd8\u662f\u59d4\u6258\u7ed9 Hibernate Validator \u6765\u6821\u9a8c\n            result = execVal.validateParameters(\n                invocation.getThis(), methodToValidate, invocation.getArguments(), groups);\n        }\n        catch (IllegalArgumentException ex) {\n            ...\n        }\n        // \u6709\u5f02\u5e38\u76f4\u63a5\u629b\u51fa\n        if (!result.isEmpty()) {\n            throw new ConstraintViolationException(result);\n        }\n        // \u771f\u6b63\u7684\u65b9\u6cd5\u8c03\u7528\n        Object returnValue = invocation.proceed();\n        // \u5bf9\u8fd4\u56de\u503c\u505a\u6821\u9a8c\uff0c\u6700\u7ec8\u8fd8\u662f\u59d4\u6258\u7ed9Hibernate Validator\u6765\u6821\u9a8c\n        result = execVal.validateReturnValue(invocation.getThis(), methodToValidate, returnValue, groups);\n        // \u6709\u5f02\u5e38\u76f4\u63a5\u629b\u51fa\n        if (!result.isEmpty()) {\n            throw new ConstraintViolationException(result);\n        }\n        return returnValue;\n    }\n}\n\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u9645\u4e0a\uff0c\u4e0d\u7ba1\u662f requestBody \u53c2\u6570\u6821\u9a8c\u8fd8\u662f\u65b9\u6cd5\u7ea7\u522b\u7684\u6821\u9a8c\uff0c\u6700\u7ec8\u90fd\u662f\u8c03\u7528 Hibernate Validator \u6267\u884c\u6821\u9a8c\uff0cSpring Validation \u53ea\u662f\u505a\u4e86\u4e00\u5c42\u5c01\u88c5\u3002"}),"\n",(0,r.jsxs)(e.h2,{id:"\u95ee\u9898",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E9%97%AE%E9%A2%98",children:"#"}),"\u95ee\u9898"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Spring \u6709\u54ea\u4e9b\u6821\u9a8c\u6838\u5fc3\u7ec4\u4ef6"}),"\uff1f"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u68c0\u9a8c\u5668\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.Validator"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u9519\u8bef\u6536\u96c6\u5668\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.Errors"})]}),"\n",(0,r.jsxs)(e.li,{children:["Java Bean \u9519\u8bef\u63cf\u8ff0\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.ObjectError"})]}),"\n",(0,r.jsxs)(e.li,{children:["Java Bean \u5c5e\u6027\u9519\u8bef\u63cf\u8ff0\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.FieldError"})]}),"\n",(0,r.jsxs)(e.li,{children:["Bean Validation \u9002\u914d\uff1a",(0,r.jsx)(e.code,{children:"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"})]}),"\n"]}),"\n",(0,r.jsxs)(e.h2,{id:"\u53c2\u8003\u8d44\u6599",children:[(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial/pages/fe6aad/#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99",children:"#"}),"\u53c2\u8003\u8d44\u6599"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans",children:"Spring \u5b98\u65b9\u6587\u6863\u4e4b Core Technologies(opens new window)"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://time.geekbang.org/course/intro/265",children:"\u300a\u5c0f\u9a6c\u54e5\u8bb2 Spring \u6838\u5fc3\u7f16\u7a0b\u601d\u60f3\u300b(opens new window)"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://juejin.cn/post/6856541106626363399",children:"https://juejin.cn/post/6856541106626363399"})}),"\n"]}),"\n",(0,r.jsx)(e.h1,{id:"\u53c2\u8003\u6587\u7ae0",children:"\u53c2\u8003\u6587\u7ae0"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.a,{href:"https://www.w3cschool.cn/wkspring",children:"https://www.w3cschool.cn/wkspring"}),"\n",(0,r.jsx)(e.a,{href:"https://www.runoob.com/w3cnote/basic-knowledge-summary-of-spring.html",children:"https://www.runoob.com/w3cnote/basic-knowledge-summary-of-spring.html"}),"\n",(0,r.jsx)(e.a,{href:"http://codepub.cn/2015/06/21/Basic-knowledge-summary-of-Spring",children:"http://codepub.cn/2015/06/21/Basic-knowledge-summary-of-Spring"}),"\n",(0,r.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial",children:"https://dunwu.github.io/spring-tutorial"}),"\n",(0,r.jsx)(e.a,{href:"https://mszlu.com/java/spring",children:"https://mszlu.com/java/spring"}),"\n",(0,r.jsx)(e.a,{href:"http://c.biancheng.net/spring/aop-module.html",children:"http://c.biancheng.net/spring/aop-module.html"})]})]})}function p(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},88672:(n,e,i)=>{i.d(e,{Z:()=>s,a:()=>l});var r=i(50959);const t={},a=r.createContext(t);function l(n){const e=r.useContext(a);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),r.createElement(a.Provider,{value:e},n.children)}}}]);