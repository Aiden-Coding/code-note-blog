"use strict";(self.webpackChunkcode_note_blog=self.webpackChunkcode_note_blog||[]).push([[9598],{84752:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var i=r(11527),t=r(88672);const a={},c="Spring\u4e8b\u52a1\u6838\u5fc3\u63a5\u53e3",s={id:"Spring\u5168\u5bb6\u6876/Spring/Spring\u4e8b\u52a1\u57fa\u672c\u7528\u6cd5",title:"Spring\u4e8b\u52a1\u6838\u5fc3\u63a5\u53e3",description:"Spring \u7684\u4e8b\u52a1\u7ba1\u7406\u662f\u57fa\u4e8e AOP \u5b9e\u73b0\u7684\uff0c\u800c AOP \u662f\u4ee5\u65b9\u6cd5\u4e3a\u5355\u4f4d\u7684\u3002Spring \u7684\u4e8b\u52a1\u5c5e\u6027\u5206\u522b\u4e3a\u4f20\u64ad\u884c\u4e3a\u3001\u9694\u79bb\u7ea7\u522b\u3001\u53ea\u8bfb\u548c\u8d85\u65f6\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u63d0\u4f9b\u4e86\u4e8b\u52a1\u5e94\u7528\u7684\u65b9\u6cd5\u548c\u63cf\u8ff0\u7b56\u7565\u3002",source:"@site/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e8b\u52a1\u57fa\u672c\u7528\u6cd5.md",sourceDirName:"Spring\u5168\u5bb6\u6876/Spring",slug:"/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e8b\u52a1\u57fa\u672c\u7528\u6cd5",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e8b\u52a1\u57fa\u672c\u7528\u6cd5",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e8b\u52a1\u57fa\u672c\u7528\u6cd5.md",tags:[],version:"current",frontMatter:{},sidebar:"spring",previous:{title:"Spring\u5bb9\u5668\u4e0eIOC",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u5bb9\u5668\u4e0eIOC"},next:{title:"Spring \u914d\u7f6e\u5143\u6570\u636e",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/Spring/Spring\u4e2d\u7684\u914d\u7f6e\u5143\u6570\u636e\uff08\u7ba1\u7406\u914d\u7f6e\u7684\u57fa\u672c\u6570\u636e\uff09"}},o={},l=[{value:"1. PlatformTransactionManager",id:"1-platformtransactionmanager",level:4},{value:"2. TransactionDefinition",id:"2-transactiondefinition",level:4},{value:"3. TransactionStatus",id:"3-transactionstatus",level:4},{value:"1. \u521b\u5efa\u9879\u76ee",id:"1-\u521b\u5efa\u9879\u76ee",level:4},{value:"2. \u521b\u5efa\u6570\u636e\u5e93\u3001\u8868\u4ee5\u53ca\u63d2\u5165\u6570\u636e",id:"2-\u521b\u5efa\u6570\u636e\u5e93\u8868\u4ee5\u53ca\u63d2\u5165\u6570\u636e",level:4},{value:"3. \u521b\u5efa c3p0-db.properties",id:"3-\u521b\u5efa-c3p0-dbproperties",level:4},{value:"4. \u5b9e\u73b0 DAO",id:"4-\u5b9e\u73b0-dao",level:4},{value:"1\uff09\u521b\u5efa AccountDao \u63a5\u53e3",id:"1\u521b\u5efa-accountdao-\u63a5\u53e3",level:4},{value:"2\uff09\u521b\u5efaDAO\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",id:"2\u521b\u5efadao\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",level:4},{value:"5. \u5b9e\u73b0 Service",id:"5-\u5b9e\u73b0-service",level:4},{value:"1\uff09\u521b\u5efa Service \u5c42\u63a5\u53e3",id:"1\u521b\u5efa-service-\u5c42\u63a5\u53e3",level:4},{value:"2\uff09\u521b\u5efa Service \u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",id:"2\u521b\u5efa-service-\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",level:4},{value:"6. \u521b\u5efa Spring \u914d\u7f6e\u6587\u4ef6",id:"6-\u521b\u5efa-spring-\u914d\u7f6e\u6587\u4ef6",level:4},{value:"7. \u521b\u5efa\u6d4b\u8bd5\u7c7b",id:"7-\u521b\u5efa\u6d4b\u8bd5\u7c7b",level:4},{value:"1\uff09\u5728 Spring \u5bb9\u5668\u4e2d\u6ce8\u518c\u9a71\u52a8\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a",id:"1\u5728-spring-\u5bb9\u5668\u4e2d\u6ce8\u518c\u9a71\u52a8\u4ee3\u7801\u5982\u4e0b\u6240\u793a",level:4},{value:"2\uff09\u5728\u9700\u8981\u4f7f\u7528\u4e8b\u52a1\u7684\u4e1a\u52a1\u7c7b\u6216\u8005\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u6ce8\u89e3 @Transactional\uff0c\u5e76\u914d\u7f6e @Transactional \u7684\u53c2\u6570\u3002\u5173\u4e8e @Transactional \u7684\u53c2\u6570\u5982\u56fe 1 \u6240\u793a\u3002",id:"2\u5728\u9700\u8981\u4f7f\u7528\u4e8b\u52a1\u7684\u4e1a\u52a1\u7c7b\u6216\u8005\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u6ce8\u89e3-transactional\u5e76\u914d\u7f6e-transactional-\u7684\u53c2\u6570\u5173\u4e8e-transactional-\u7684\u53c2\u6570\u5982\u56fe-1-\u6240\u793a",level:4},{value:"1. \u6ce8\u518c\u9a71\u52a8",id:"1-\u6ce8\u518c\u9a71\u52a8",level:4},{value:"2. \u6dfb\u52a0 @Transactional \u6ce8\u89e3",id:"2-\u6dfb\u52a0-transactional-\u6ce8\u89e3",level:4}];function p(n){const e={a:"a",br:"br",code:"code",h1:"h1",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"spring\u4e8b\u52a1\u6838\u5fc3\u63a5\u53e3",children:"Spring\u4e8b\u52a1\u6838\u5fc3\u63a5\u53e3"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"http://www.voidme.com/spring",children:"Spring"})," \u7684\u4e8b\u52a1\u7ba1\u7406\u662f\u57fa\u4e8e AOP \u5b9e\u73b0\u7684\uff0c\u800c AOP \u662f\u4ee5\u65b9\u6cd5\u4e3a\u5355\u4f4d\u7684\u3002Spring \u7684\u4e8b\u52a1\u5c5e\u6027\u5206\u522b\u4e3a\u4f20\u64ad\u884c\u4e3a\u3001\u9694\u79bb\u7ea7\u522b\u3001\u53ea\u8bfb\u548c\u8d85\u65f6\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u63d0\u4f9b\u4e86\u4e8b\u52a1\u5e94\u7528\u7684\u65b9\u6cd5\u548c\u63cf\u8ff0\u7b56\u7565\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5728 ",(0,i.jsx)(e.a,{href:"http://www.voidme.com/java",children:"Java"})," EE \u5f00\u53d1\u7ecf\u5e38\u91c7\u7528\u7684\u5206\u5c42\u6a21\u5f0f\u4e2d\uff0cSpring \u7684\u4e8b\u52a1\u5904\u7406\u4f4d\u4e8e\u4e1a\u52a1\u903b\u8f91\u5c42\uff0c\u5b83\u63d0\u4f9b\u4e86\u9488\u5bf9\u4e8b\u52a1\u7684\u89e3\u51b3\u65b9\u6848\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728 Spring \u89e3\u538b\u5305\u7684 libs \u76ee\u5f55\u4e2d\uff0c\u5305\u542b\u4e00\u4e2a\u540d\u79f0\u4e3a spring-tx-3.2.13.RELEASE.jar \u7684\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u662f Spring \u63d0\u4f9b\u7684\u7528\u4e8e\u4e8b\u52a1\u7ba1\u7406\u7684 JAR \u5305\uff0c\u5176\u4e2d\u5305\u62ec\u4e8b\u52a1\u7ba1\u7406\u7684\u4e09\u4e2a\u6838\u5fc3\u63a5\u53e3\uff1aPlatformTransactionManager\u3001TransactionDefinition \u548c TransactionStatus\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5c06\u8be5 JAR \u5305\u7684\u540e\u7f00\u540d jar \u6539\u6210 zip \u7684\u5f62\u5f0f\u540e\uff0c\u89e3\u538b\u538b\u7f29\u5305\uff0c\u8fdb\u5165\u89e3\u538b\u6587\u4ef6\u5939\u4e2d\u7684 \\org\\springframework\\transaction \u76ee\u5f55\u540e\uff0c\u8be5\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u5982\u56fe 1 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/760_a12_405.png",alt:"\u4e8b\u52a1\u7ba1\u7406\u6838\u5fc3\u63a5\u53e3"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 1  \u4e8b\u52a1\u7ba1\u7406\u6838\u5fc3\u63a5\u53e3"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u56fe 1 \u4e2d\uff0c\u65b9\u6846\u6240\u6807\u6ce8\u7684\u4e09\u4e2a\u6587\u4ef6\u5c31\u662f\u672c\u8282\u5c06\u8981\u8bb2\u89e3\u7684\u6838\u5fc3\u63a5\u53e3\u3002\u8fd9\u4e09\u4e2a\u6838\u5fc3\u63a5\u53e3\u7684\u4f5c\u7528\u53ca\u5176\u63d0\u4f9b\u7684\u65b9\u6cd5\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"1-platformtransactionmanager",children:"1. PlatformTransactionManager"}),"\n",(0,i.jsx)(e.p,{children:"PlatformTransactionManager \u63a5\u53e3\u662f Spring \u63d0\u4f9b\u7684\u5e73\u53f0\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u7528\u4e8e\u7ba1\u7406\u4e8b\u52a1\u3002\u8be5\u63a5\u53e3\u4e2d\u63d0\u4f9b\u4e86\u4e09\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u65b9\u6cd5\uff0c\u5177\u4f53\u5982\u4e0b\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"TransactionStatus getTransaction\uff08TransactionDefinition definition\uff09\uff1a\u7528\u4e8e\u83b7\u53d6\u4e8b\u52a1\u72b6\u6001\u4fe1\u606f\u3002"}),"\n",(0,i.jsx)(e.li,{children:"void commit\uff08TransactionStatus status\uff09\uff1a\u7528\u4e8e\u63d0\u4ea4\u4e8b\u52a1\u3002"}),"\n",(0,i.jsx)(e.li,{children:"void rollback\uff08TransactionStatus status\uff09\uff1a\u7528\u4e8e\u56de\u6eda\u4e8b\u52a1\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u4e2d\uff0cSpring \u5c06 xml \u4e2d\u914d\u7f6e\u7684\u4e8b\u52a1\u8be6\u7ec6\u4fe1\u606f\u5c01\u88c5\u5230\u5bf9\u8c61 TransactionDefinition \u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u4e8b\u52a1\u7ba1\u7406\u5668\u7684 getTransaction() \u65b9\u6cd5\u83b7\u5f97\u4e8b\u52a1\u7684\u72b6\u6001\uff08TransactionStatus\uff09\uff0c\u5e76\u5bf9\u4e8b\u52a1\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"2-transactiondefinition",children:"2. TransactionDefinition"}),"\n",(0,i.jsx)(e.p,{children:"TransactionDefinition \u63a5\u53e3\u662f\u4e8b\u52a1\u5b9a\u4e49\uff08\u63cf\u8ff0\uff09\u7684\u5bf9\u8c61\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e8b\u52a1\u76f8\u5173\u4fe1\u606f\u83b7\u53d6\u7684\u65b9\u6cd5\uff0c\u5176\u4e2d\u5305\u62ec\u4e94\u4e2a\u64cd\u4f5c\uff0c\u5177\u4f53\u5982\u4e0b\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"String getName()\uff1a\u83b7\u53d6\u4e8b\u52a1\u5bf9\u8c61\u540d\u79f0\u3002"}),"\n",(0,i.jsx)(e.li,{children:"int getIsolationLevel()\uff1a\u83b7\u53d6\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b\u3002"}),"\n",(0,i.jsx)(e.li,{children:"int getPropagationBehavior()\uff1a\u83b7\u53d6\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\u3002"}),"\n",(0,i.jsx)(e.li,{children:"int getTimeout()\uff1a\u83b7\u53d6\u4e8b\u52a1\u7684\u8d85\u65f6\u65f6\u95f4\u3002"}),"\n",(0,i.jsx)(e.li,{children:"boolean isReadOnly()\uff1a\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u53ea\u8bfb\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u4e0a\u8ff0\u4e94\u4e2a\u65b9\u6cd5\u7684\u63cf\u8ff0\u4e2d\uff0c\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\u662f\u6307\u5728\u540c\u4e00\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u4e0d\u540c\u64cd\u4f5c\u524d\u540e\u6240\u4f7f\u7528\u7684\u4e8b\u52a1\u3002\u4f20\u64ad\u884c\u4e3a\u7684\u79cd\u7c7b\u5982\u8868 1 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u5c5e\u6027\u540d\u79f0"}),(0,i.jsx)(e.th,{children:"\u503c"}),(0,i.jsx)(e.th,{children:"\u63cf  \u8ff0"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_REQUIRED"}),(0,i.jsx)(e.td,{children:"required"}),(0,i.jsx)(e.td,{children:"\u652f\u6301\u5f53\u524d\u4e8b\u52a1\u3002\u5982\u679c A \u65b9\u6cd5\u5df2\u7ecf\u5728\u4e8b\u52a1\u4e2d\uff0c\u5219 B \u4e8b\u52a1\u5c06\u76f4\u63a5\u4f7f\u7528\u3002\u5426\u5219\u5c06\u521b\u5efa\u65b0\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_SUPPORTS"}),(0,i.jsx)(e.td,{children:"supports"}),(0,i.jsx)(e.td,{children:"\u652f\u6301\u5f53\u524d\u4e8b\u52a1\u3002\u5982\u679c A \u65b9\u6cd5\u5df2\u7ecf\u5728\u4e8b\u52a1\u4e2d\uff0c\u5219 B \u4e8b\u52a1\u5c06\u76f4\u63a5\u4f7f\u7528\u3002\u5426\u5219\u5c06\u4ee5\u975e\u4e8b\u52a1\u72b6\u6001\u6267\u884c"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_MANDATORY"}),(0,i.jsx)(e.td,{children:"mandatory"}),(0,i.jsx)(e.td,{children:"\u652f\u6301\u5f53\u524d\u4e8b\u52a1\u3002\u5982\u679c A \u65b9\u6cd5\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_REQUIRES_NEW"}),(0,i.jsx)(e.td,{children:"requires_new"}),(0,i.jsx)(e.td,{children:"\u5c06\u521b\u5efa\u65b0\u7684\u4e8b\u52a1\uff0c\u5982\u679c A \u65b9\u6cd5\u5df2\u7ecf\u5728\u4e8b\u52a1\u4e2d\uff0c\u5219\u5c06 A \u4e8b\u52a1\u6302\u8d77"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_NOT_SUPPORTED"}),(0,i.jsx)(e.td,{children:"not_supported"}),(0,i.jsx)(e.td,{children:"\u4e0d\u652f\u6301\u5f53\u524d\u4e8b\u52a1\uff0c\u603b\u662f\u4ee5\u975e\u4e8b\u52a1\u72b6\u6001\u6267\u884c\u3002\u5982\u679c A \u65b9\u6cd5\u5df2\u7ecf\u5728\u4e8b\u52a1\u4e2d\uff0c\u5219\u5c06\u5176\u6302\u8d77"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION_NEVER"}),(0,i.jsx)(e.td,{children:"never"}),(0,i.jsx)(e.td,{children:"\u4e0d\u652f\u6301\u5f53\u524d\u4e8b\u52a1\uff0c\u5982\u679c A \u65b9\u6cd5\u5728\u4e8b\u52a1\u4e2d\uff0c\u5219\u629b\u51fa\u5f02\u5e38"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"PROPAGATION.NESTED"}),(0,i.jsx)(e.td,{children:"nested"}),(0,i.jsx)(e.td,{children:"\u5d4c\u5957\u4e8b\u52a1\uff0c\u5e95\u5c42\u5c06\u4f7f\u7528 Savepoint \u5f62\u6210\u5d4c\u5957\u4e8b\u52a1"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u4e8b\u52a1\u7ba1\u7406\u8fc7\u7a0b\u4e2d\uff0c\u4f20\u64ad\u884c\u4e3a\u53ef\u4ee5\u63a7\u5236\u662f\u5426\u9700\u8981\u521b\u5efa\u4e8b\u52a1\u4ee5\u53ca\u5982\u4f55\u521b\u5efa\u4e8b\u52a1\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u7684\u67e5\u8be2\u4e0d\u4f1a\u6539\u53d8\u539f\u6570\u636e\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8fdb\u884c\u4e8b\u52a1\u7ba1\u7406\uff0c\u800c\u5bf9\u4e8e\u6570\u636e\u7684\u589e\u52a0\u3001\u4fee\u6539\u548c\u5220\u9664\u7b49\u64cd\u4f5c\uff0c\u5fc5\u987b\u8fdb\u884c\u4e8b\u52a1\u7ba1\u7406\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\uff0c\u5219 Spring3 \u9ed8\u8ba4\u7684\u4f20\u64ad\u884c\u4e3a\u662f required\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"3-transactionstatus",children:"3. TransactionStatus"}),"\n",(0,i.jsx)(e.p,{children:"TransactionStatus \u63a5\u53e3\u662f\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u5b83\u63cf\u8ff0\u4e86\u67d0\u4e00\u65f6\u95f4\u70b9\u4e0a\u4e8b\u52a1\u7684\u72b6\u6001\u4fe1\u606f\u3002\u5176\u4e2d\u5305\u542b\u516d\u4e2a\u64cd\u4f5c\uff0c\u5177\u4f53\u5982\u8868 2 \u6240\u793a\u3002"}),"\n",(0,i.jsx)("caption",{children:"\u8868 2  \u4e8b\u52a1\u7684\u64cd\u4f5c"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u540d\u79f0"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void flush()"}),(0,i.jsx)(e.td,{children:"\u5237\u65b0\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean hasSavepoint()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u662f\u5426\u5b58\u5728\u4fdd\u5b58\u70b9"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isCompleted()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u5b8c\u6210"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isNewTransaction()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u662f\u5426\u662f\u65b0\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isRollbackOnly()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u662f\u5426\u56de\u6eda"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void setRollbackOnly()"}),(0,i.jsx)(e.td,{children:"\u8bbe\u7f6e\u4e8b\u52a1\u56de\u6eda"})]})]})]}),"\n",(0,i.jsx)(e.h1,{id:"spring\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u57fa\u4e8exml\u65b9\u5f0f\u5b9e\u73b0",children:"Spring\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\uff08\u57fa\u4e8eXML\u65b9\u5f0f\u5b9e\u73b0\uff09"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"http://www.voidme.com/spring",children:"Spring"})," \u7684\u4e8b\u52a1\u7ba1\u7406\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a\u4e00\u79cd\u662f\u4f20\u7edf\u7684\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u7ba1\u7406\uff0c\u5373\u901a\u8fc7\u7f16\u5199\u4ee3\u7801\u5b9e\u73b0\u7684\u4e8b\u52a1\u7ba1\u7406\uff1b\u53e6\u4e00\u79cd\u662f\u57fa\u4e8e AOP \u6280\u672f\u5b9e\u73b0\u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u3002\u7531\u4e8e\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u7ba1\u7406\u5f88\u5c11\u4f7f\u7528\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u5bf9 Spring \u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u8fdb\u884c\u8be6\u7ec6\u8bb2\u89e3\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"Spring \u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u5728\u5e95\u5c42\u91c7\u7528\u4e86 AOP \u6280\u672f\uff0c\u5176\u6700\u5927\u7684\u4f18\u70b9\u5728\u4e8e\u65e0\u987b\u901a\u8fc7\u7f16\u7a0b\u7684\u65b9\u5f0f\u7ba1\u7406\u4e8b\u52a1\uff0c\u53ea\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u76f8\u5173\u7684\u89c4\u5219\u58f0\u660e\uff0c\u5c31\u53ef\u4ee5\u5c06\u4e8b\u52a1\u89c4\u5219\u5e94\u7528\u5230\u4e1a\u52a1\u903b\u8f91\u4e2d\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u5b9e\u73b0\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u57fa\u4e8e XML \u65b9\u5f0f\u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u901a\u8fc7 Annotation \u6ce8\u89e3\u65b9\u5f0f\u7684\u4e8b\u52a1\u7ba1\u7406\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u672c\u8282\u901a\u8fc7\u94f6\u884c\u8f6c\u8d26\u7684\u6848\u4f8b\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528 XML \u7684\u65b9\u5f0f\u5b9e\u73b0 Spring \u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u5904\u7406\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"1-\u521b\u5efa\u9879\u76ee",children:"1. \u521b\u5efa\u9879\u76ee"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 MyEclipse \u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a springDemo03 \u7684 Web \u9879\u76ee\uff0c\u5c06 Spring \u652f\u6301\u548c\u4f9d\u8d56\u7684 JAR \u5305\u590d\u5236\u5230 Web \u9879\u76ee\u7684 lib \u76ee\u5f55\u4e2d\uff0c\u5e76\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u4e0b\u3002\u6240\u6dfb\u52a0\u7684 JAR \u5305\u5982\u56fe 1 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/761_732_fcf.png",alt:"\u9700\u8981\u5bfc\u5165\u7684JAR\u5305"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 1  \u9700\u8981\u5bfc\u5165\u7684JAR\u5305"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4ece\u56fe 1 \u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u91cc\u589e\u52a0\u5bfc\u5165\u4e86 spring-tx-3.2.13.RELEASE.jar\uff08\u4e8b\u52a1\u7ba1\u7406\uff09\uff0c\u4ee5\u53ca ",(0,i.jsx)(e.a,{href:"http://www.voidme.com/mysql",children:"MySQL"})," \u9a71\u52a8\u3001JDBC \u548c C3P0 \u7684 JAR \u5305\u3002"]}),"\n",(0,i.jsx)(e.h4,{id:"2-\u521b\u5efa\u6570\u636e\u5e93\u8868\u4ee5\u53ca\u63d2\u5165\u6570\u636e",children:"2. \u521b\u5efa\u6570\u636e\u5e93\u3001\u8868\u4ee5\u53ca\u63d2\u5165\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 MySQL \u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a spring \u7684\u6570\u636e\u5e93\uff0c\u7136\u540e\u5728\u8be5\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a account \u8868\uff0c\u5e76\u5411\u8868\u4e2d\u63d2\u5165\u4e24\u6761\u6570\u636e\uff0c\u5176 SQL \u6267\u884c\u8bed\u53e5\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:["CREATE DATABASE spring;",(0,i.jsx)(e.br,{}),"\n","USE spring;",(0,i.jsx)(e.br,{}),"\n","CREATE TABLE account (",(0,i.jsx)(e.br,{}),"\n","id INT (11) PRIMARY KEY AUTO_INCREMENT,",(0,i.jsx)(e.br,{}),"\n","username VARCHAR(20) NOT NULL,",(0,i.jsx)(e.br,{}),"\n","money INT DEFAULT NULL",(0,i.jsx)(e.br,{}),"\n",");",(0,i.jsx)(e.br,{}),"\n","INSERT INTO account VALUES (1,'zhangsan',1000);",(0,i.jsx)(e.br,{}),"\n","INSERT INTO account VALUES (2,'lisi',1000);"]}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u540e\u7684 account \u8868\u4e2d\u7684\u6570\u636e\u5982\u56fe 2 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/762_276_8a5.PNG",alt:"\u6267\u884c\u7ed3\u679c"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 2  \u6267\u884c\u7ed3\u679c"]}),"\n",(0,i.jsx)(e.h4,{id:"3-\u521b\u5efa-c3p0-dbproperties",children:"3. \u521b\u5efa c3p0-db.properties"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a c3p0-db.properties \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u91cc\u4f7f\u7528 C3P0 \u6570\u636e\u6e90\uff0c\u9700\u8981\u5728\u8be5\u6587\u4ef6\u4e2d\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"jdbc.driverClass = com.mysql.jdbc.Driver  \njdbc.jdbcUrl = jdbc:mysql://localhost:3306/spring  \njdbc.user = root  \njdbc.password = root  \n"})}),"\n",(0,i.jsx)(e.h4,{id:"4-\u5b9e\u73b0-dao",children:"4. \u5b9e\u73b0 DAO"}),"\n",(0,i.jsx)(e.h4,{id:"1\u521b\u5efa-accountdao-\u63a5\u53e3",children:"1\uff09\u521b\u5efa AccountDao \u63a5\u53e3"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a com.mengma.dao \u7684\u5305\uff0c\u5728\u8be5\u5305\u4e0b\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3 AccountDao\uff0c\u5e76\u5728\u63a5\u53e3\u4e2d\u521b\u5efa\u6c47\u6b3e\u548c\u6536\u6b3e\u7684\u65b9\u6cd5\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"package com.mengma.dao;  \npublic interface AccountDao {  \n    // \u6c47\u6b3e  \n    public void out(String outUser, int money);  \n    // \u6536\u6b3e  \n    public void in(String inUser, int money);} ```  \n\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u5b9a\u4e49\u4e86 out() \u548c in() \u4e24\u4e2a\u65b9\u6cd5\uff0c\u5206\u522b\u7528\u4e8e\u8868\u793a\u6c47\u6b3e\u548c\u6536\u6b3e\u3002  \n"})}),"\n",(0,i.jsx)(e.h4,{id:"2\u521b\u5efadao\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",children:"2\uff09\u521b\u5efaDAO\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a com.mengma.dao.impl \u7684\u5305\uff0c\u5728\u8be5\u5305\u4e0b\u521b\u5efa\u5b9e\u73b0\u7c7b AccountDaoImpl\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'package com.mengma.dao.impl;\n\nimport org.springframework.jdbc.core.JdbcTemplate;  \nimport com.mengma.dao.AccountDao;\n\npublic class AccountDaoImpl implements AccountDao {  \nprivate JdbcTemplate jdbcTemplate;  \npublic void setJdbcTemplate(JdbcTemplate jdbcTemplate) {        this.jdbcTemplate = jdbcTemplate;    }  \n// \u6c47\u6b3e\u7684\u5b9e\u73b0\u65b9\u6cd5  \npublic void out(String outUser, int money) {        this.jdbcTemplate.update("update account set money =money-?"                + "where username =?", money, outUser);    }  \n// \u6536\u6b3e\u7684\u5b9e\u73b0\u65b9\u6cd5  \npublic void in(String inUser, int money) {        this.jdbcTemplate.update("update account set money =money+?"                + "where username =?", money, inUser);    }} \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u4f7f\u7528 JdbcTemplate \u7c7b\u7684 update() \u65b9\u6cd5\u5b9e\u73b0\u4e86\u66f4\u65b0\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"5-\u5b9e\u73b0-service",children:"5. \u5b9e\u73b0 Service"}),"\n",(0,i.jsx)(e.h4,{id:"1\u521b\u5efa-service-\u5c42\u63a5\u53e3",children:"1\uff09\u521b\u5efa Service \u5c42\u63a5\u53e3"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a com.mengma.service \u7684\u5305\uff0c\u5728\u8be5\u5305\u4e0b\u521b\u5efa\u63a5\u53e3 AccountService\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"package com.mengma.service;  \n  \npublic interface AccountService {  \n    // \u8f6c\u8d26  \n    public void transfer(String outUser, String inUser, int money);} \n"})}),"\n",(0,i.jsx)(e.h4,{id:"2\u521b\u5efa-service-\u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b",children:"2\uff09\u521b\u5efa Service \u5c42\u63a5\u53e3\u5b9e\u73b0\u7c7b"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a com.mengma.service.impl \u7684\u5305\uff0c\u5728\u8be5\u5305\u4e0b\u521b\u5efa\u5b9e\u73b0\u7c7b AccountServiceImpl\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"package com.mengma.service.impl;\n\nimport com.mengma.dao.AccountDao;\n\npublic class AccountServiceImpl {  \nprivate AccountDao accountDao;  \npublic void setAccountDao(AccountDao accountDao) {        this.accountDao = accountDao;    }  \npublic void transfer(String outUser, String inUser, int money) {        this.accountDao.out(outUser, money);        this.accountDao.in(inUser, money);    }} \n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8be5\u7c7b\u5b9e\u73b0\u4e86 AccountService \u63a5\u53e3\uff0c\u5e76\u5bf9\u8f6c\u8d26\u7684\u65b9\u6cd5\u8fdb\u884c\u4e86\u5b9e\u73b0\uff0c\u6839\u636e\u53c2\u6570\u7684\u4e0d\u540c\u8c03\u7528 DAO \u5c42\u76f8\u5e94\u7684\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"6-\u521b\u5efa-spring-\u914d\u7f6e\u6587\u4ef6",children:"6. \u521b\u5efa Spring \u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa Spirng \u914d\u7f6e\u6587\u4ef6 applicationContext.xml\uff0c\u7f16\u8f91\u540e\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:' <?xml version="1.0" encoding="UTF-8"?><beans xmlns="http://www.springframework.org/schema/beans"  \n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns:context="http://www.springframework.org/schema/context"    xmlns:tx="http://www.springframework.org/schema/tx"    xmlns:aop="http://www.springframework.org/schema/aop"    xsi:schemaLocation="http://www.springframework.org/schema/beans            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd            http://www.springframework.org/schema/context  \n            http://www.springframework.org/schema/context/spring-context.xsd            http://www.springframework.org/schema/tx            http://www.springframework.org/schema/tx/spring-tx-2.5.xsd            http://www.springframework.org/schema/aop            http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">    \x3c!-- \u52a0\u8f7dproperties\u6587\u4ef6 --\x3e    <context:property-placeholder location="classpath:c3p0-db.properties" />    \x3c!-- \u914d\u7f6e\u6570\u636e\u6e90\uff0c\u8bfb\u53d6properties\u6587\u4ef6\u4fe1\u606f --\x3e    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">        <property name="driverClass" value="${jdbc.driverClass}" />        <property name="jdbcUrl" value="${jdbc.jdbcUrl}" />        <property name="user" value="${jdbc.user}" />        <property name="password" value="${jdbc.password}" />    </bean>    \x3c!-- \u914d\u7f6ejdbc\u6a21\u677f --\x3e    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">        <property name="dataSource" ref="dataSource" />    </bean>    \x3c!-- \u914d\u7f6edao --\x3e  \n    <bean id="accountDao" class="com.mengma.dao.impl.AccountDaoImpl">        <property name="jdbcTemplate" ref="jdbcTemplate" />    </bean>    \x3c!-- \u914d\u7f6eservice --\x3e  \n    <bean id="accountService" class="com.mengma.service.impl.AccountServiceImpl">        <property name="accountDao" ref="accountDao" />    </bean>    \x3c!-- \u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u4f9d\u8d56\u4e8e\u6570\u636e\u6e90 --\x3e    <bean id="txManager"        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">        <property name="dataSource" ref="dataSource" />    </bean>    \x3c!-- \u7f16\u5199\u901a\u77e5\uff1a\u5bf9\u4e8b\u52a1\u8fdb\u884c\u589e\u5f3a\uff08\u901a\u77e5\uff09\uff0c\u9700\u8981\u7f16\u5199\u5207\u5165\u70b9\u548c\u5177\u4f53\u6267\u884c\u4e8b\u52a1\u7684\u7ec6\u8282 --\x3e    <tx:advice id="txAdvice" transaction-manager="txManager">        <tx:attributes>            \x3c!-- \u7ed9\u5207\u5165\u70b9\u65b9\u6cd5\u6dfb\u52a0\u4e8b\u52a1\u8be6\u60c5\uff0cname\u8868\u793a\u65b9\u6cd5\u540d\u79f0\uff0c*\u8868\u793a\u4efb\u610f\u65b9\u6cd5\u540d\u79f0\uff0cpropagation\u7528\u4e8e\u8bbe\u7f6e\u4f20\u64ad\u884c\u4e3a\uff0cread-only\u8868\u793a\u9694\u79bb\u7ea7\u522b\uff0c\u662f\u5426\u53ea\u8bfb --\x3e            <tx:method name="find*" propagation="SUPPORTS"                rollback-for="Exception" />            <tx:method name="*" propagation="REQUIRED" isolation="DEFAULT"                read-only="false" />        </tx:attributes>    </tx:advice>    \x3c!-- aop\u7f16\u5199\uff0c\u8ba9Spring\u81ea\u52a8\u5bf9\u76ee\u6807\u751f\u6210\u4ee3\u7406\uff0c\u9700\u8981\u4f7f\u7528AspectJ\u7684\u8868\u8fbe\u5f0f --\x3e    <aop:config>        \x3c!-- \u5207\u5165\u70b9 --\x3e        <aop:pointcut expression="execution(* com.mengma.service.*.*(..))"            id="txPointCut" />        \x3c!-- \u5207\u9762\uff1a\u5c06\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u6574\u5408 --\x3e        <aop:advisor pointcut-ref="txPointCut" advice-ref="txAdvice" />    </aop:config></beans> \n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u9996\u5148\u5728 ",(0,i.jsx)(e.code,{children:"<beans> "}),"\u6807\u8bb0\u7684\u7b2c 6\u300113 \u548c 14 \u884c\u4ee3\u7801\u5206\u522b\u6dfb\u52a0\u4e86 AOP \u6240\u9700\u7684\u547d\u540d\u7a7a\u95f4\u58f0\u660e\u3002\u7b2c 42\uff5e50 \u884c\u4ee3\u7801\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"<tx:advice>"})," \u6807\u8bb0\u914d\u7f6e\u4e8b\u52a1\u901a\u77e5\u5185\u5bb9\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c 52\uff5e58 \u884c\u4ee3\u7801\u4f7f\u7528  \u6807\u8bb0\u5b9a\u4e49\u5207\u9762\uff0c\u5176\u4e2d\u7b2c 54 \u884c\u4ee3\u7801\u5e94\u7528\u4e86 AspectJ \u8868\u8fbe\u5f0f\uff0c\u4ee3\u8868 com.mengma.service \u5305\u4e0b\u6240\u6709\u7c7b\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u5e94\u7528\u4e8b\u52a1\u89c4\u5219\uff0c\u7b2c 57 \u884c\u4ee3\u7801\u4f7f\u7528  \u6807\u8bb0\u5c06\u5207\u5165\u70b9\u4e0e\u4e8b\u52a1\u901a\u77e5\u6574\u5408\uff0c\u57fa\u4e8e AOP \u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u914d\u7f6e\u5b8c\u6210\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"7-\u521b\u5efa\u6d4b\u8bd5\u7c7b",children:"7. \u521b\u5efa\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u9879\u76ee\u7684 src \u76ee\u5f55\u4e0b\u521b\u5efa com.mengma.test \u7684\u5305\uff0c\u5728\u8be5\u5305\u4e0b\u521b\u5efa\u6d4b\u8bd5\u7c7b AccountTest\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'package com.mengma.test;  \nimport org.junit.Test;  \nimport org.springframework.context.ApplicationContext;  \nimport org.springframework.context.support.ClassPathXmlApplicationContext;  \nimport com.mengma.service.AccountService;  \npublic class AccountTest {  \n@Test    public void test() {        // \u83b7\u5f97Spring\u5bb9\u5668\uff0c\u5e76\u64cd\u4f5c  \nString xmlPath = "applicationContext.xml";        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(                xmlPath);        AccountService accountService = (AccountService) applicationContext                .getBean("accountService");        accountService.transfer("zhangsan", "lisi", 100);    }} \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u6a21\u62df\u4e86\u94f6\u884c\u8f6c\u8d26\u4e1a\u52a1\uff0c\u4ece zhangsan \u7684\u8d26\u6237\u5411 lisi \u7684\u8d26\u6237\u4e2d\u8f6c\u5165 100 \u5143\u3002\u4f7f\u7528 JUnit \u6d4b\u8bd5\u8fd0\u884c test() \u65b9\u6cd5\uff0c\u8fd0\u884c\u6210\u529f\u540e\uff0c\u67e5\u8be2 account \u8868\uff0c\u5982\u56fe 3 \u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u56fe 3 \u7684\u67e5\u8be2\u7ed3\u679c\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0czhangsan \u6210\u529f\u5411 lisi \u8f6c\u8d26 100 \u5143\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/763_9ae_de5.PNG",alt:"\u67e5\u8be2\u7ed3\u679c"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 3  \u67e5\u8be2\u7ed3\u679c"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u9762\u901a\u8fc7\u4fee\u6539\u6848\u4f8b\u6a21\u62df\u8f6c\u8d26\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u5728\u7684 transfer() \u65b9\u6cd5\u4e2d\u6dfb\u52a0\u4e00\u884c\u4ee3\u7801\u201cint i=1/0\uff1b\u201d\u6a21\u62df\u7cfb\u7edf\u65ad\u7535\u7684\u60c5\u51b5\uff0c\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" public void transfer(String outUser, String inUser, int money) {    this.accountDao.out(outUser, money);    //\u6a21\u62df\u65ad\u7535  \n    int i = 1/0;    this.accountDao.in(inUser, money);\n } \n"})}),"\n",(0,i.jsx)(e.p,{children:"\u91cd\u65b0\u6d4b\u8bd5\u8fd0\u884c test() \u65b9\u6cd5\uff0cJUnit \u63a7\u5236\u53f0\u8f93\u51fa\u7684\u4fe1\u606f\u5982\u56fe 4 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/764_7a3_f52.png",alt:"\u63a7\u5236\u53f0\u8f93\u51fa\u7ed3\u679c"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 4  \u63a7\u5236\u53f0\u8f93\u51fa\u7ed3\u679c"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u56fe 4 \u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u5728\u6267\u884c\u6d4b\u8bd5\u65b9\u6cd5\u65f6\uff0c\u51fa\u73b0\u4e86\u9664\u4ee5 0 \u7684\u5f02\u5e38\u4fe1\u606f\u3002\u6b64\u65f6\u518d\u6b21\u67e5\u8be2 account \u8868\uff0c\u5176\u67e5\u8be2\u7ed3\u679c\u5982\u56fe 5 \u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4ece\u56fe 5 \u7684\u67e5\u8be2\u7ed3\u679c\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8868\u4e2d\u7684\u6570\u636e\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002\u7531\u4e8e\u7a0b\u5e8f\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u4e8b\u52a1\u4e0d\u80fd\u6b63\u5e38\u88ab\u63d0\u4ea4\uff0c\u6240\u4ee5\u8f6c\u8d26\u5931\u8d25\u3002\u7531\u6b64\u53ef\u77e5\uff0cSpring \u7684\u4e8b\u52a1\u7ba1\u7406\u751f\u6548\u4e86\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/763_9ae_de5.PNG",alt:"\u67e5\u8be2\u7ed3\u679c"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 5  \u67e5\u8be2\u7ed3\u679c"]}),"\n",(0,i.jsx)(e.h1,{id:"spring\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u57fa\u4e8eannotation\u6ce8\u89e3\u65b9\u5f0f\u5b9e\u73b0",children:"Spring\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\uff08\u57fa\u4e8eAnnotation\u6ce8\u89e3\u65b9\u5f0f\u5b9e\u73b0\uff09"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728 ",(0,i.jsx)(e.a,{href:"http://www.voidme.com/spring",children:"Spring"})," \u4e2d\uff0c\u9664\u4e86\u4f7f\u7528\u57fa\u4e8e XML \u7684\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 Annotation \u6ce8\u89e3\u7684\u65b9\u5f0f\u5b9e\u73b0\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 Annotation \u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5728\u9879\u76ee\u4e2d\u505a\u4e24\u4ef6\u4e8b\uff0c\u5177\u4f53\u5982\u4e0b\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"1\u5728-spring-\u5bb9\u5668\u4e2d\u6ce8\u518c\u9a71\u52a8\u4ee3\u7801\u5982\u4e0b\u6240\u793a",children:"1\uff09\u5728 Spring \u5bb9\u5668\u4e2d\u6ce8\u518c\u9a71\u52a8\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'<tx:annotation-driven transaction-manager="txManager"/>\n'})}),"\n",(0,i.jsx)(e.h4,{id:"2\u5728\u9700\u8981\u4f7f\u7528\u4e8b\u52a1\u7684\u4e1a\u52a1\u7c7b\u6216\u8005\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u6ce8\u89e3-transactional\u5e76\u914d\u7f6e-transactional-\u7684\u53c2\u6570\u5173\u4e8e-transactional-\u7684\u53c2\u6570\u5982\u56fe-1-\u6240\u793a",children:"2\uff09\u5728\u9700\u8981\u4f7f\u7528\u4e8b\u52a1\u7684\u4e1a\u52a1\u7c7b\u6216\u8005\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u6ce8\u89e3 @Transactional\uff0c\u5e76\u914d\u7f6e @Transactional \u7684\u53c2\u6570\u3002\u5173\u4e8e @Transactional \u7684\u53c2\u6570\u5982\u56fe 1 \u6240\u793a\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/765_7af_ff7.png",alt:"@Transactional\u53c2\u6570\u5217\u8868"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 1  @Transactional\u53c2\u6570\u5217\u8868"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u9762\u901a\u8fc7\u4fee\u6539\u300a ",(0,i.jsx)(e.a,{href:"http://www.voidme.com/spring/spring-transaction-management-by-xml",children:"Spring\u57fa\u4e8eXML\u5b9e\u73b0\u4e8b\u52a1\u7ba1\u7406"}),"\u300b\u6559\u7a0b\u4e2d\u94f6\u884c\u8f6c\u8d26\u7684\u6848\u4f8b\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528 Annotation \u6ce8\u89e3\u7684\u65b9\u5f0f\u5b9e\u73b0 Spring \u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u3002"]}),"\n",(0,i.jsx)(e.h4,{id:"1-\u6ce8\u518c\u9a71\u52a8",children:"1. \u6ce8\u518c\u9a71\u52a8"}),"\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 Spring \u914d\u7f6e\u6587\u4ef6 applicationContext.xml\uff0c\u4fee\u6539\u540e\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'<?xml version="1.0" encoding="UTF-8"?>  \n<beans xmlns="http://www.springframework.org/schema/beans"  \nxmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns:context="http://www.springframework.org/schema/context"    xmlns:tx="http://www.springframework.org/schema/tx"    xmlns:aop="http://www.springframework.org/schema/aop"    xsi:schemaLocation="http://www.springframework.org/schema/beans            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd            http://www.springframework.org/schema/context  \nhttp://www.springframework.org/schema/context/spring-context.xsd            http://www.springframework.org/schema/tx            http://www.springframework.org/schema/tx/spring-tx-2.5.xsd            http://www.springframework.org/schema/aop            http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">    \x3c!-- \u52a0\u8f7dproperties\u6587\u4ef6 --\x3e    <context:property-placeholder location="classpath:c3p0-db.properties" />    \x3c!-- \u914d\u7f6e\u6570\u636e\u6e90\uff0c\u8bfb\u53d6properties\u6587\u4ef6\u4fe1\u606f --\x3e    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">        <property name="driverClass" value="${jdbc.driverClass}" />        <property name="jdbcUrl" value="${jdbc.jdbcUrl}" />        <property name="user" value="${jdbc.user}" />        <property name="password" value="${jdbc.password}" />    </bean>    \x3c!-- \u914d\u7f6ejdbc\u6a21\u677f --\x3e    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">        <property name="dataSource" ref="dataSource" />    </bean>    \x3c!-- \u914d\u7f6edao --\x3e  \n<bean id="accountDao" class="com.mengma.dao.impl.AccountDaoImpl">        <property name="jdbcTemplate" ref="jdbcTemplate" />    </bean>    \x3c!-- \u914d\u7f6eservice --\x3e  \n<bean id="accountService" class="com.mengma.service.impl.AccountServiceImpl">        <property name="accountDao" ref="accountDao" />    </bean>    \x3c!-- \u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u4f9d\u8d56\u4e8e\u6570\u636e\u6e90 --\x3e    <bean id="txManager"        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">        <property name="dataSource" ref="dataSource" />    </bean>    \x3c!-- \u6ce8\u518c\u4e8b\u52a1\u7ba1\u7406\u9a71\u52a8 --\x3e    <tx:annotation-driven transaction-manager="txManager"/></beans> \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u4e0e\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\u76f8\u6bd4\uff0c\u8fd9\u91cc\u53ea\u4fee\u6539\u4e86\u4e8b\u52a1\u7ba1\u7406\u5668\u90e8\u5206\uff0c\u65b0\u6dfb\u52a0\u5e76\u6ce8\u518c\u4e86\u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u9a71\u52a8\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u5b66\u4e60 AOP \u6ce8\u89e3\u65b9\u5f0f\u5f00\u53d1\u65f6\uff0c\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u6ce8\u89e3\u5904\u7406\u5668\uff0c\u6307\u5b9a\u626b\u63cf\u54ea\u4e9b\u5305\u4e0b\u7684\u6ce8\u89e3\uff0c\u8fd9\u91cc\u6ca1\u6709\u5f00\u542f\u6ce8\u89e3\u5904\u7406\u5668\u662f\u56e0\u4e3a\u5728\u7b2c 33\uff5e35 \u884c\u624b\u52a8\u914d\u7f6e\u4e86 AccountServiceImpl\uff0c\u800c @Transactional \u6ce8\u89e3\u5c31\u914d\u7f6e\u5728\u8be5\u7c7b\u4e2d\uff0c\u6240\u4ee5\u4f1a\u76f4\u63a5\u751f\u6548\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"2-\u6dfb\u52a0-transactional-\u6ce8\u89e3",children:"2. \u6dfb\u52a0 @Transactional \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 AccountServiceImpl\uff0c\u5728\u6587\u4ef6\u4e2d\u6dfb\u52a0 @Transactional \u6ce8\u89e3\u53ca\u53c2\u6570\uff0c\u6dfb\u52a0\u540e\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"package com.mengma.service.impl;  \n  \nimport org.springframework.transaction.annotation.Isolation;  \nimport org.springframework.transaction.annotation.Propagation;  \nimport org.springframework.transaction.annotation.Transactional;  \n  \nimport com.mengma.dao.AccountDao;  \n  \n@Transactional(propagation = Propagation.REQUIRED, isolation = Isolation.DEFAULT, readOnly = false)  \npublic class AccountServiceImpl {  \n    private AccountDao accountDao;  \n    public void setAccountDao(AccountDao accountDao) {        this.accountDao = accountDao;    }  \n    public void transfer(String outUser, String inUser, int money) {        this.accountDao.out(outUser, money);        // \u6a21\u62df\u65ad\u7535  \n        int i = 1 / 0;        this.accountDao.in(inUser, money);    \n}}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u4f7f\u7528 @Transactional \u6ce8\u89e3\u65f6\uff0c\u53c2\u6570\u4e4b\u95f4\u7528\u201c\uff0c\u201d\u8fdb\u884c\u5206\u9694\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 JUnit \u6d4b\u8bd5\u518d\u6b21\u8fd0\u884c test() \u65b9\u6cd5\u65f6\uff0c\u63a7\u5236\u53f0\u540c\u6837\u4f1a\u8f93\u51fa\u5982\u56fe 2 \u6240\u793a\u7684\u5f02\u5e38\u4fe1\u606f\uff0c\u8fd9\u8bf4\u660e\u4f7f\u7528\u57fa\u4e8e Annotation \u6ce8\u89e3\u7684\u65b9\u5f0f\u540c\u6837\u5b9e\u73b0\u4e86 Spring \u7684\u58f0\u660e\u5f0f\u4e8b\u52a1\u7ba1\u7406\u3002\u5982\u679c\u6ce8\u91ca\u6389\u6a21\u62df\u65ad\u7535\u7684\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5219\u8f6c\u8d26\u64cd\u4f5c\u53ef\u4ee5\u6b63\u5e38\u5b8c\u6210\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{src:"https://java-tutorial.oss-cn-shanghai.aliyuncs.com/764_7a3_f52.png",alt:"\u8fd0\u884c\u7ed3\u679c"}),(0,i.jsx)(e.br,{}),"\n","\u56fe 2  \u8fd0\u884c\u7ed3\u679c"]}),"\n",(0,i.jsx)(e.h1,{id:"\u53c2\u8003\u6587\u7ae0",children:"\u53c2\u8003\u6587\u7ae0"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://www.w3cschool.cn/wkspring",children:"https://www.w3cschool.cn/wkspring"}),(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.a,{href:"https://www.runoob.com/w3cnote/basic-knowledge-summary-of-spring.html",children:"https://www.runoob.com/w3cnote/basic-knowledge-summary-of-spring.html"}),(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.a,{href:"http://codepub.cn/2015/06/21/Basic-knowledge-summary-of-Spring",children:"http://codepub.cn/2015/06/21/Basic-knowledge-summary-of-Spring"}),(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.a,{href:"https://dunwu.github.io/spring-tutorial",children:"https://dunwu.github.io/spring-tutorial"}),(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.a,{href:"https://mszlu.com/java/spring",children:"https://mszlu.com/java/spring"}),(0,i.jsx)(e.br,{}),"\n",(0,i.jsx)(e.a,{href:"http://c.biancheng.net/spring/aop-module.html",children:"http://c.biancheng.net/spring/aop-module.html"})]})]})}function d(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}},88672:(n,e,r)=>{r.d(e,{Z:()=>s,a:()=>c});var i=r(50959);const t={},a=i.createContext(t);function c(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:c(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);