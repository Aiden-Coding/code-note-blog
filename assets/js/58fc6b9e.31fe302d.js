"use strict";(self.webpackChunkcode_note_blog=self.webpackChunkcode_note_blog||[]).push([[2917],{56255:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>a,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var i=r(11527),t=r(88672);const s={},c="Spring MVC \u4f7f\u7528HandlerInterceptor\u62e6\u622a\u8bf7\u6c42",o={id:"Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u62e6\u622a\u5668",title:"Spring MVC \u4f7f\u7528HandlerInterceptor\u62e6\u622a\u8bf7\u6c42",description:"2018-07-26 14:07 \u66f4\u65b0",source:"@site/docs/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u62e6\u622a\u5668.md",sourceDirName:"Spring\u5168\u5bb6\u6876/SpringMVC",slug:"/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u62e6\u622a\u5668",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u62e6\u622a\u5668",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u62e6\u622a\u5668.md",tags:[],version:"current",frontMatter:{},sidebar:"spring",previous:{title:"SpringMVC\u4e2d\u7684\u8fc7\u6ee4\u5668Filter",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u8fc7\u6ee4\u5668Filter"},next:{title:"Spring MVC \u4f7f\u7528ViewResolver\u63a5\u53e3\u89e3\u6790\u89c6\u56fe",permalink:"/code-note-blog/docs/Spring\u5168\u5bb6\u6876/SpringMVC/SpringMVC\u4e2d\u7684\u89c6\u56fe\u89e3\u6790\u5668"}},d={},p=[];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"spring-mvc-\u4f7f\u7528handlerinterceptor\u62e6\u622a\u8bf7\u6c42",children:"Spring MVC \u4f7f\u7528HandlerInterceptor\u62e6\u622a\u8bf7\u6c42"}),"\n",(0,i.jsx)(n.p,{children:"2018-07-26 14:07 \u66f4\u65b0"}),"\n",(0,i.jsx)(n.p,{children:"Spring\u7684\u5904\u7406\u5668\u6620\u5c04\u673a\u5236\u5305\u542b\u4e86\u5904\u7406\u5668\u62e6\u622a\u5668\u3002\u62e6\u622a\u5668\u5728\u4f60\u9700\u8981\u4e3a\u7279\u5b9a\u7c7b\u578b\u7684\u8bf7\u6c42\u5e94\u7528\u4e00\u4e9b\u529f\u80fd\u65f6\u53ef\u80fd\u5f88\u6709\u7528\uff0c\u6bd4\u5982\uff0c\u68c0\u67e5\u7528\u6237\u8eab\u4efd\u7b49\u3002"}),"\n",(0,i.jsxs)("section",{children:[(0,i.jsxs)(n.p,{children:["\u5904\u7406\u5668\u6620\u5c04\u5904\u7406\u8fc7\u7a0b\u914d\u7f6e\u7684\u62e6\u622a\u5668\uff0c\u5fc5\u987b\u5b9e\u73b0 ",(0,i.jsx)(n.code,{children:"org.springframework.web.servlet"}),"\u5305\u4e0b\u7684 ",(0,i.jsx)(n.code,{children:"HandlerInterceptor"}),"\u63a5\u53e3\u3002\u8fd9\u4e2a\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e09\u4e2a\u65b9\u6cd5\uff1a ",(0,i.jsx)(n.code,{children:"preHandle(..)"}),"\uff0c\u5b83\u5728\u5904\u7406\u5668\u5b9e\u9645\u6267\u884c ",(0,i.jsx)(n.em,{children:"\u4e4b\u524d"})," \u4f1a\u88ab\u6267\u884c\uff1b ",(0,i.jsx)(n.code,{children:"postHandle(..)"}),"\uff0c\u5b83\u5728\u5904\u7406\u5668\u6267\u884c ",(0,i.jsx)(n.em,{children:"\u5b8c\u6bd5"})," \u4ee5\u540e\u88ab\u6267\u884c\uff1b ",(0,i.jsx)(n.code,{children:"afterCompletion(..)"}),"\uff0c\u5b83\u5728 ",(0,i.jsx)(n.em,{children:"\u6574\u4e2a\u8bf7\u6c42\u5904\u7406\u5b8c\u6210"})," \u4e4b\u540e\u88ab\u6267\u884c\u3002\u8fd9\u4e09\u4e2a\u65b9\u6cd5\u4e3a\u5404\u79cd\u7c7b\u578b\u7684\u524d\u5904\u7406\u548c\u540e\u5904\u7406\u9700\u6c42\u63d0\u4f9b\u4e86\u8db3\u591f\u7684\u7075\u6d3b\u6027\u3002"]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"preHandle(..)"}),"\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2aboolean\u503c\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u6765\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\u6267\u884c\u5904\u7406\u94fe\u4e2d\u7684\u90e8\u4ef6\u3002\u5f53\u65b9\u6cd5\u8fd4\u56de ",(0,i.jsx)(n.code,{children:"true"}),"\u65f6\uff0c\u5904\u7406\u5668\u94fe\u4f1a\u7ee7\u7eed\u6267\u884c\uff1b\u82e5\u65b9\u6cd5\u8fd4\u56de ",(0,i.jsx)(n.code,{children:"false"}),"\uff0c ",(0,i.jsx)(n.code,{children:"DispatcherServlet"}),"\u5373\u8ba4\u4e3a\u62e6\u622a\u5668\u81ea\u8eab\u5df2\u7ecf\u5b8c\u6210\u4e86\u5bf9\u8bf7\u6c42\u7684\u5904\u7406\uff08\u6bd4\u5982\u8bf4\uff0c\u5df2\u7ecf\u6e32\u67d3\u4e86\u4e00\u4e2a\u5408\u9002\u7684\u89c6\u56fe\uff09\uff0c\u90a3\u4e48\u5176\u4f59\u7684\u62e6\u622a\u5668\u4ee5\u53ca\u6267\u884c\u94fe\u4e2d\u7684\u5176\u4ed6\u5904\u7406\u5668\u5c31\u4e0d\u4f1a\u518d\u88ab\u6267\u884c\u4e86\u3002"]}),(0,i.jsxs)(n.p,{children:["\u62e6\u622a\u5668\u53ef\u4ee5\u901a\u8fc7",(0,i.jsx)(n.code,{children:"interceptors"}),"\u5c5e\u6027\u6765\u914d\u7f6e\uff0c\u8be5\u9009\u9879\u5728\u6240\u6709\u7ee7\u627f\u4e86",(0,i.jsx)(n.code,{children:"AbstractHandlerMapping"}),"\u7684\u5904\u7406\u5668\u6620\u5c04\u7c7b",(0,i.jsx)(n.code,{children:"HandlerMapping"}),"\u90fd\u63d0\u4f9b\u4e86\u914d\u7f6e\u7684\u63a5\u53e3\u3002\u5982\u4e0b\u9762\u4ee3\u7801\u6837\u4f8b\u6240\u793a\uff1a"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<beans>\n    <bean id="handlerMapping" class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">\n        <property name="interceptors">\n            <list>\n                <ref bean="officeHoursInterceptor"/>\n            </list>\n        </property>\n    </bean>\n\n    <bean id="officeHoursInterceptor" class="samples.TimeBasedAccessInterceptor">\n        <property name="openingTime" value="9"/>\n        <property name="closingTime" value="18"/>\n    </bean>\n<beans>\n\n'})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'package samples;\n\npublic class TimeBasedAccessInterceptor extends HandlerInterceptorAdapter {\n\n    private int openingTime;\n    private int closingTime;\n\n    public void setOpeningTime(int openingTime) {\n        this.openingTime = openingTime;\n    }\n\n    public void setClosingTime(int closingTime) {\n        this.closingTime = closingTime;\n    }\n\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response,\n            Object handler) throws Exception {\n        Calendar cal = Calendar.getInstance();\n        int hour = cal.get(HOUR_OF_DAY);\n        if (openingTime <= hour && hour < closingTime) {\n            return true;\n        }\n        response.sendRedirect("http://host.com/outsideOfficeHours.html");\n        return false;\n    }\n}\n\n'})}),(0,i.jsxs)(n.p,{children:["\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u88ab\u6b64\u5904\u7406\u5668\u5904\u7406\u7684\u8bf7\u6c42\u90fd\u4f1a\u88ab",(0,i.jsx)(n.code,{children:"TimeBasedAccessInterceptor"}),"\u62e6\u622a\u5668\u62e6\u622a\u3002\u5982\u679c\u5f53\u524d\u65f6\u95f4\u5728\u5de5\u4f5c\u65f6\u95f4\u4ee5\u5916\uff0c\u90a3\u4e48\u7528\u6237\u5c31\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u4e00\u4e2aHTML\u6587\u4ef6\u63d0\u793a\u7528\u6237\uff0c\u6bd4\u5982\u663e\u793a\u201c\u4f60\u53ea\u6709\u5728\u5de5\u4f5c\u65f6\u95f4\u624d\u53ef\u4ee5\u8bbf\u95ee\u672c\u7f51\u7ad9\u201d\u4e4b\u7c7b\u7684\u4fe1\u606f\u3002"]}),(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"RequestMappingHandlerMapping"}),"\u65f6\uff0c\u5b9e\u9645\u7684\u5904\u7406\u5668\u662f\u4e00\u4e2a\u5904\u7406\u5668\u65b9\u6cd5",(0,i.jsx)(n.code,{children:"HandlerMethod"}),"\u7684\u5b9e\u4f8b\uff0c\u5b83\u6807\u8bc6\u4e86\u4e00\u4e2a\u5c06\u88ab\u7528\u4e8e\u5904\u7406\u8be5\u8bf7\u6c42\u7684\u63a7\u5236\u5668\u65b9\u6cd5\u3002"]}),"\n"]}),(0,i.jsxs)(n.p,{children:["\u5982\u4f60\u6240\u89c1\uff0cSpring\u7684\u62e6\u622a\u5668\u9002\u914d\u5668",(0,i.jsx)(n.code,{children:"HandlerInterceptorAdapter"}),"\u8ba9\u7ee7\u627f",(0,i.jsx)(n.code,{children:"HandlerInterceptor"}),"\u63a5\u53e3\u53d8\u5f97\u66f4\u7b80\u5355\u4e86\u3002"]}),(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u63a7\u5236\u5668\u65b9\u6cd5\u5904\u7406\u7684\u8bf7\u6c42\u90fd\u4f1a\u88ab\u914d\u7f6e\u7684\u62e6\u622a\u5668\u5148\u62e6\u622a\u5230\u3002\u5982\u679c\u4f60\u60f3\u8fdb\u4e00\u6b65\u7f29\u5c0f\u62e6\u622a\u7684URL\u8303\u56f4\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7MVC\u547d\u540d\u7a7a\u95f4\u6216MVC Java\u7f16\u7a0b\u7684\u65b9\u5f0f\u6765\u914d\u7f6e\uff0c\u6216\u8005\uff0c\u58f0\u660e\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"MappedInterceptor"}),"\u7c7b\u578b\u7684bean\u5b9e\u4f8b\u6765\u5904\u7406\u3002\u5177\u4f53\u8bf7\u89c1 ",(0,i.jsx)(n.a,{href:"https://www.w3cschool.cn/spring_mvc_documentation_linesh_translation/spring_mvc_documentation_linesh_translation-ouxg27ss.html",children:"21.16.1 \u542f\u7528MVC Java\u7f16\u7a0b\u914d\u7f6e\u6216MVC\u547d\u540d\u7a7a\u95f4\u914d\u7f6e"}),"\u4e00\u5c0f\u8282\u3002"]}),"\n"]}),(0,i.jsxs)(n.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c",(0,i.jsx)(n.code,{children:"HandlerInterceptor"}),"\u7684\u540e\u62e6\u622a",(0,i.jsx)(n.code,{children:"postHandle"}),"\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u603b\u662f\u9002\u7528\u4e8e\u6ce8\u89e3\u4e86",(0,i.jsx)(n.code,{children:"@ResponseBody"}),"\u6216",(0,i.jsx)(n.code,{children:"ResponseEntity"}),"\u7684\u65b9\u6cd5\u3002\u8fd9\u4e9b\u573a\u666f\u4e2d\uff0c",(0,i.jsx)(n.code,{children:"HttpMessageConverter"}),"\u4f1a\u5728\u62e6\u622a\u5668\u7684",(0,i.jsx)(n.code,{children:"postHandle"}),"\u65b9\u6cd5\u88ab\u8c03\u4e4b\u524d\u5c31\u628a\u4fe1\u606f\u5199\u56de\u54cd\u5e94\u4e2d\u3002\u8fd9\u6837\u62e6\u622a\u5668\u5c31\u65e0\u6cd5\u518d\u6539\u53d8\u54cd\u5e94\u4e86\uff0c\u6bd4\u5982\u8981\u589e\u52a0\u4e00\u4e2a\u54cd\u5e94\u5934\u4e4b\u7c7b\u7684\u3002\u5982\u679c\u6709\u8fd9\u79cd\u9700\u6c42\uff0c\u8bf7\u8ba9\u4f60\u7684\u5e94\u7528\u5b9e\u73b0",(0,i.jsx)(n.code,{children:"ResponseBodyAdvice"}),"\u63a5\u53e3\uff0c\u5e76\u5c06\u5176\u5b9a\u4e49\u4e3a\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"@ControllerAdvice"}),"bean\u6216\u76f4\u63a5\u5728",(0,i.jsx)(n.code,{children:"RequestMappingHandlerMapping"}),"\u4e2d\u914d\u7f6e\u3002"]})]})]})}function a(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},88672:(e,n,r)=>{r.d(n,{Z:()=>o,a:()=>c});var i=r(50959);const t={},s=i.createContext(t);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);